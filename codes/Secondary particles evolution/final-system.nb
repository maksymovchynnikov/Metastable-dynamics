(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    120835,       2784]
NotebookOptionsPosition[    118332,       2737]
NotebookOutlinePosition[    118817,       2755]
CellTagsIndexPosition[    118774,       2752]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Modified injection into neutrinos", "Subsection",
 CellChangeTimes->{{3.932397143679738*^9, 3.932397151664727*^9}, {
  3.932397634002102*^9, 
  3.9323976404770403`*^9}},ExpressionUUID->"a9e6e547-f953-4b15-9ec4-\
4d899d4c06fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ruleToZero", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"nKminus", "[", "x_", "]"}], ":>", "0"}], ",", 
     RowBox[{
      RowBox[{"nKplus", "[", "x_", "]"}], ":>", "0"}], ",", 
     RowBox[{
      RowBox[{"nKL", "[", "x_", "]"}], ":>", "0"}], ",", 
     RowBox[{
      RowBox[{"n\[Pi]plus", "[", "t_", "]"}], ":>", "0"}], ",", 
     RowBox[{
      RowBox[{"n\[Pi]minus", "[", "t_", "]"}], ":>", "0"}], ",", 
     RowBox[{
      RowBox[{"n\[Mu]plus", "[", "t_", "]"}], ":>", "0"}], ",", 
     RowBox[{
      RowBox[{"n\[Mu]minus", "[", "t_", "]"}], ":>", "0"}]}], "}"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Total", " ", "energy", " ", "injected", " ", "by", " ", "decaying", " ", 
    "LLPs", " ", "into", " ", "neutrinos", " ", "assuming", " ", "that", " ", 
    "all", " ", "secondaries", " ", "may", " ", "only", " ", 
    RowBox[{"decay", ".", " ", "The"}], " ", "maximal", " ", "value", " ", 
    "of", " ", 
    SubscriptBox["r", "2"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"calcBaseInjectedEnergy", "[", 
     RowBox[{"LLP_", ",", "mX_"}], "]"}], ":=", "\n", 
    RowBox[{
     RowBox[{
      FractionBox["1", "mX"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"energyToNeutrinoTotal", "[", "Y", "]"}], "*", 
            RowBox[{"NtoY", "[", 
             RowBox[{"LLP", ",", "Y", ",", "mX"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Y", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
               "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
               "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\""}], "}"}]}], 
            "}"}]}], "]"}]}], "+", "\n", 
        RowBox[{
         RowBox[{"NtoY", "[", 
          RowBox[{
          "LLP", ",", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
           "mX"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "energyToNeutrinoTotal", "[", 
            "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", "]"}], "+", 
           RowBox[{
            RowBox[{"EKLkin", "[", 
             RowBox[{"LLP", ",", "mX"}], "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{"energyToNeutrino", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                 "\"\<e\>\""}], "]"}], 
               RowBox[{
               "mass", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", 
                "]"}]], "+", 
              FractionBox[
               RowBox[{"energyToNeutrino", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                 "\"\<\[Mu]\>\""}], "]"}], 
               RowBox[{
               "mass", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", 
                "]"}]]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"Total", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
          "mX"}], "]"}], ",", 
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", 
          ",", "mX"}], "]"}], ",", 
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", 
          ",", "mX"}], "]"}]}], "}"}], "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{"time", "-", 
    RowBox[{
    "dependent", " ", "energy", " ", "injection", " ", "probabilities"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generateInjections", "[", 
   RowBox[{
   "LLP_", ",", "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "tIni_", ",", 
    "solY_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Epsilon]direct", ",", "\[Epsilon]sec"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"calcBaseInjectedEnergy", "[", 
        RowBox[{"LLP", ",", "mX"}], "]"}], ">", "0."}], ",", "\n", 
      RowBox[{
       RowBox[{"Do", "[", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]sec", "[", 
            RowBox[{"flav", ",", "t_"}], "]"}], "=", "\n", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"nSymbol", "[", "pt", "]"}], "[", "t", "]"}], 
               RowBox[{"lifetime", "[", "pt", "]"}]], " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                "pt", "!=", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\""}], 
                ",", 
                RowBox[{"energyToNeutrino", "[", 
                 RowBox[{"pt", ",", "flav"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"energyToNeutrino", "[", 
                  RowBox[{"pt", ",", "flav"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"EKLkin", "[", 
                   RowBox[{"LLP", ",", "mX"}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"energyToNeutrino", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                    "\"\<e\>\""}], "]"}], 
                    RowBox[{
                    "mass", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"",
                     "]"}]], "+", 
                    FractionBox[
                    RowBox[{"energyToNeutrino", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                    "\"\<\[Mu]\>\""}], "]"}], 
                    RowBox[{
                    "mass", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"",
                     "]"}]]}], ")"}]}]}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"pt", ",", "Yparticleslist"}], "}"}]}], "]"}]}], ";"}], 
         "\n", ",", 
         RowBox[{"{", 
          RowBox[{"flav", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<e\>\"", ",", "\"\<\[Mu]\>\""}], "}"}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Epsilon]sec", "[", 
         RowBox[{"\"\<\[Tau]\>\"", ",", "t_"}], "]"}], "=", "0."}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Epsilon]direct", "[", "\"\<e\>\"", "]"}], ",", 
          RowBox[{"\[Epsilon]direct", "[", "\"\<\[Mu]\>\"", "]"}], ",", 
          RowBox[{"\[Epsilon]direct", "[", "\"\<\[Tau]\>\"", "]"}]}], "}"}], 
        "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Xi]to\[Nu]", "[", 
           RowBox[{
           "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
            "mX"}], "]"}], ",", 
          RowBox[{"\[Xi]to\[Nu]", "[", 
           RowBox[{
           "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", 
            ",", "mX"}], "]"}], ",", 
          RowBox[{"\[Xi]to\[Nu]", "[", 
           RowBox[{
           "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", 
            ",", "mX"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "<", 
            RowBox[{"10", "\[Tau]X"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Epsilon]direct", "[", "flav", "]"}], "+", 
               FractionBox[
                RowBox[{"\[Epsilon]sec", "[", 
                 RowBox[{"flav", ",", "t"}], "]"}], 
                FractionBox[
                 RowBox[{"\[Rho]LLPscaling", "[", 
                  RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
                   RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}],
                   "]"}], "\[Tau]X"]]}], "/.", "solY"}], "/.", "ruleToZero"}],
             "]"}], ",", "0."}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"flav", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<e\>\"", ",", "\"\<\[Mu]\>\"", ",", "\"\<\[Tau]\>\""}], 
            "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
          "mX"}], "]"}], ",", 
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", 
          ",", "mX"}], "]"}], ",", 
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", 
          ",", "mX"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "\n",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solveEvolutionCorrectedFull", "[", 
   RowBox[{
   "LLP_", ",", "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "tIni_", ",", 
    "tfinSim_", ",", "solY_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"GeVToMeV", "=", 
      RowBox[{"10", "^", "3"}]}], 
     RowBox[{"(*", 
      RowBox[{
      ",", "EqsEq", ",", "\[Xi]TotalElec", ",", "\[Xi]Total\[Mu]", ",", 
       "\[Xi]Total\[Tau]", ",", "solUniverse", ",", "system\[Rho]\[Nu]Inj", 
       ",", "system\[Rho]Inj", ",", "source\[Rho]\[Nu]Inj", ",", 
       "source\[Rho]Inj", ",", "\[Rho]\[Nu]inj10\[Tau]X", ",", 
       "\[Rho]inj10\[Tau]X", ",", "arat"}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Xi]TotalElec", ",", "\[Xi]Total\[Mu]", ",", "\[Xi]Total\[Tau]"}], 
       "}"}], "=", 
      RowBox[{"generateInjections", "[", 
       RowBox[{
       "LLP", ",", "mX", ",", "\[Tau]X", ",", "nXini", ",", "tIni", ",", 
        "solY"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EqsEq", "=", 
      RowBox[{"EqsEqTemp", "[", 
       RowBox[{"mX", ",", "\[Tau]X", ",", "nXini", ",", 
        RowBox[{
        "1", "-", "\[Xi]TotalElec", "-", "\[Xi]Total\[Mu]", "-", 
         "\[Xi]Total\[Tau]"}], ",", "\[Xi]TotalElec", ",", "\[Xi]Total\[Mu]", 
        ",", "\[Xi]Total\[Tau]", ",", 
        RowBox[{"1.001", "*", "tIni"}], ",", "TiniEM"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solUniverse", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"EqsEq", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
           "T\[Nu]\[Tau]", ",", "aRatio"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"1.001", "*", "tIni"}], ",", "tfinSim"}], "}"}], ",", 
         RowBox[{"MaxSteps", "->", "100000"}], ",", 
         RowBox[{"Method", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<BDF\>\"", ",", 
            RowBox[{"\"\<MaxDifferenceOrder\>\"", "->", "2"}]}], "}"}]}]}], 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"WorkingPrecision", "->", "18"}]}], "*)"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"system\[Rho]\[Nu]Inj", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]\[Nu]Inj", "'"}], "[", "t", "]"}], "+", 
             RowBox[{"4", " ", 
              FractionBox[
               RowBox[{
                RowBox[{"aRatio", "'"}], "[", "t", "]"}], 
               RowBox[{"aRatio", "[", "t", "]"}]], 
              RowBox[{"\[Rho]\[Nu]Inj", "[", "t", "]"}]}]}], "==", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
              "\[Xi]TotalElec", "+", "\[Xi]Total\[Mu]", "+", 
               "\[Xi]Total\[Tau]"}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Rho]LLPscaling", "[", 
               RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
                RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
               "]"}], "\[Tau]X"], "*", 
             RowBox[{"GeVToMeV", "^", "4"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]\[Nu]Inj", "[", 
             RowBox[{"tIni", "*", "1.001"}], "]"}], "==", "0"}]}], "}"}], "/.",
          " ", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"system\[Rho]Inj", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]Inj", "'"}], "[", "t", "]"}], "+", 
             RowBox[{"4", " ", 
              FractionBox[
               RowBox[{
                RowBox[{"aRatio", "'"}], "[", "t", "]"}], 
               RowBox[{"aRatio", "[", "t", "]"}]], 
              RowBox[{"\[Rho]Inj", "[", "t", "]"}]}]}], "==", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Rho]LLPscaling", "[", 
               RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
                RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
               "]"}], "\[Tau]X"], "*", 
             RowBox[{"GeVToMeV", "^", "4"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]Inj", "[", 
             RowBox[{"tIni", "*", "1.001"}], "]"}], "==", "0"}]}], "}"}], "/.",
          " ", "solUniverse"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"source\[Rho]\[Nu]Inj", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"aRatio", "[", "t", "]"}], "4"], 
        RowBox[{"(", 
         RowBox[{
         "\[Xi]TotalElec", "+", "\[Xi]Total\[Mu]", "+", "\[Xi]Total\[Tau]"}], 
         ")"}], "*", 
        FractionBox[
         RowBox[{"\[Rho]LLPscaling", "[", 
          RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
           RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], "]"}], 
         "\[Tau]X"]}], "/.", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"source\[Rho]Inj", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"aRatio", "[", "t", "]"}], "4"], 
        FractionBox[
         RowBox[{"\[Rho]LLPscaling", "[", 
          RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
           RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], "]"}], 
         "\[Tau]X"]}], "/.", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Rho]\[Nu]inj10\[Tau]X", ",", "\[Rho]inj10\[Tau]X"}], "}"}], 
      "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"#", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"tIni", "*", "1.001"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"10", "\[Tau]X"}], ",", "tfinSim"}], "]"}]}], "}"}], 
           ",", 
           RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}]}], "]"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"source\[Rho]\[Nu]Inj", ",", "source\[Rho]Inj"}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{"solUniverse", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Rho]\[Nu]Injsol", "[", 
           RowBox[{"20", "*", "\[Tau]X"}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"arat", "[", 
              RowBox[{"20", "*", "\[Tau]X"}], "]"}], "/", 
             RowBox[{"arat", "[", "1000", "]"}]}], ")"}], "^", "4"}]}], 
         "*)"}], 
        RowBox[{"\[Rho]\[Nu]Inj", "/.", " ", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{"system\[Rho]\[Nu]Inj", ",", "0"}], "]"}], ",", 
            "\[Rho]\[Nu]Inj", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"1.001", "*", "tIni"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"10", "*", "\[Tau]X"}], ",", "1000"}], "]"}]}], "}"}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"WorkingPrecision", "->", "20"}]}], "*)"}], ",", 
            RowBox[{"MaxSteps", "->", "50000"}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<BDF\>\"", ",", 
               RowBox[{"\"\<MaxDifferenceOrder\>\"", "->", "2"}]}], "}"}]}], 
            ",", 
            RowBox[{"WorkingPrecision", "->", "20"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Rho]Injsol", "[", 
           RowBox[{"20", "*", "\[Tau]X"}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"arat", "[", 
              RowBox[{"20", "*", "\[Tau]X"}], "]"}], "/", 
             RowBox[{"arat", "[", "1000", "]"}]}], ")"}], "^", "4"}]}], 
         "*)"}], 
        RowBox[{"\[Rho]Inj", "/.", " ", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{"system\[Rho]Inj", ",", "0"}], "]"}], ",", "\[Rho]Inj", 
            ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"1.001", "*", "tIni"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"10", "*", "\[Tau]X"}], ",", "1000"}], "]"}]}], "}"}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"WorkingPrecision", "->", "20"}]}], "*)"}], ",", 
            RowBox[{"MaxSteps", "->", "50000"}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<BDF\>\"", ",", 
               RowBox[{"\"\<MaxDifferenceOrder\>\"", "->", "2"}]}], "}"}]}], 
            ",", 
            RowBox[{"WorkingPrecision", "->", "20"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"arat", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"aRatio", "[", "t", "]"}], "/.", "solUniverse"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"solUniverse", ",", 
       RowBox[{"\[Rho]\[Nu]inj10\[Tau]X", "*", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"arat", "[", "tfinSim", "]"}], "4"]]}], ",", 
       RowBox[{"\[Rho]inj10\[Tau]X", "*", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"arat", "[", "tfinSim", "]"}], "4"]]}]}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9323971705649214`*^9, 3.932397171698533*^9}, {
   3.932397204416543*^9, 3.932397512788663*^9}, {3.9323986699824963`*^9, 
   3.932398673470414*^9}, {3.9323988689516287`*^9, 3.932398871926998*^9}, {
   3.9324001535331817`*^9, 3.9324001711543436`*^9}, {3.9324010312454233`*^9, 
   3.932401043148141*^9}, {3.932401116063609*^9, 3.9324011184706235`*^9}, {
   3.932401326684408*^9, 3.9324013438633947`*^9}, 3.9324017188530846`*^9, {
   3.932401754820103*^9, 3.932401770844194*^9}, {3.9324018458606052`*^9, 
   3.93240188512302*^9}, 3.932401957557784*^9, {3.932402011468832*^9, 
   3.9324020243180747`*^9}, {3.932402060924589*^9, 3.9324021641761694`*^9}, {
   3.9324022017931137`*^9, 3.9324022613464575`*^9}, {3.9324026679099483`*^9, 
   3.9324026756560497`*^9}, {3.9324029614245973`*^9, 
   3.9324030887929025`*^9}, {3.9324031704350348`*^9, 3.932403202594796*^9}, {
   3.932403322545859*^9, 3.9324033303659444`*^9}, {3.9324033931791377`*^9, 
   3.9324033954884048`*^9}, {3.9324034397143984`*^9, 3.932403443094442*^9}, {
   3.9324036459318743`*^9, 3.9324036569900255`*^9}, {3.932403829241389*^9, 
   3.9324039021392684`*^9}, {3.93240397874565*^9, 3.932404051720318*^9}, {
   3.9324043098901887`*^9, 3.932404330375208*^9}, {3.933393149737504*^9, 
   3.9333931611948442`*^9}, 3.9333966017776747`*^9, {3.9333981550297437`*^9, 
   3.9333981561302934`*^9}, {3.9333983954924755`*^9, 
   3.9333984049760876`*^9}, {3.9334019486323786`*^9, 
   3.9334019732395597`*^9}, {3.933402281217128*^9, 3.9334023574338055`*^9}, {
   3.9334050837701735`*^9, 3.933405088995536*^9}, {3.9334093305757427`*^9, 
   3.933409539888506*^9}, {3.9334096009129844`*^9, 3.9334096319879875`*^9}, {
   3.933410699195668*^9, 3.9334107430165257`*^9}, {3.9334107915816326`*^9, 
   3.933410794232041*^9}, {3.933410835760722*^9, 3.933410845737883*^9}, {
   3.9334109458175154`*^9, 3.9334109535820637`*^9}, {3.933411016136338*^9, 
   3.9334110295317693`*^9}, {3.9334111360062675`*^9, 3.933411151284567*^9}, {
   3.933413046878913*^9, 3.9334130527469893`*^9}, {3.933440906384901*^9, 
   3.9334409297317295`*^9}, {3.933441042510662*^9, 3.9334410426562986`*^9}, {
   3.933491143232093*^9, 3.9334911458943005`*^9}, {3.9334924188483915`*^9, 
   3.9334924726304417`*^9}, {3.9334931224016256`*^9, 
   3.9334931247646866`*^9}, {3.93349315940312*^9, 3.9334931637721004`*^9}, {
   3.9334932041468124`*^9, 3.9334933159469166`*^9}, 3.933493388667195*^9, {
   3.9334935911604757`*^9, 3.9334936103013916`*^9}, {3.933493652323265*^9, 
   3.9334936566546855`*^9}, {3.9334936940855756`*^9, 
   3.9334936979530697`*^9}, {3.9334938964517007`*^9, 
   3.9334939999076476`*^9}, {3.9334940738841977`*^9, 
   3.9334940773072248`*^9}, {3.9334943302072725`*^9, 
   3.9334944166852922`*^9}, {3.9334944555420656`*^9, 3.933494457433571*^9}, {
   3.9334946013390627`*^9, 3.9334946304194574`*^9}, {3.9334946639999127`*^9, 
   3.9334946712576504`*^9}, {3.9334948329138436`*^9, 
   3.9334948334150553`*^9}, {3.9334949596309776`*^9, 3.933494972008047*^9}, {
   3.9334951187212963`*^9, 3.9334951255569515`*^9}, {3.9334952069186325`*^9, 
   3.933495209501238*^9}, {3.933495357601427*^9, 3.9334953598080177`*^9}, {
   3.933495421252449*^9, 3.933495425463255*^9}, {3.9334955160583177`*^9, 
   3.933495518572671*^9}, {3.933495772943088*^9, 3.9334957795141277`*^9}, {
   3.9334961877538967`*^9, 3.9334961910110035`*^9}, {3.933496459169062*^9, 
   3.9334964616827335`*^9}, {3.933496687925378*^9, 3.9334966915366135`*^9}, 
   3.9334967764886446`*^9, {3.9334970499516244`*^9, 3.9334970523743315`*^9}, {
   3.9334971768667765`*^9, 3.933497183291815*^9}, {3.933520819072706*^9, 
   3.9335208232550583`*^9}, {3.9335213193756433`*^9, 3.93352132236236*^9}, {
   3.933522141970278*^9, 3.9335221521686535`*^9}, {3.9335222740357127`*^9, 
   3.9335222741152453`*^9}, {3.9335223713857465`*^9, 
   3.9335223821542287`*^9}, {3.933522534364275*^9, 3.933522607036255*^9}, {
   3.9335227547517242`*^9, 3.9335227562242804`*^9}, {3.9335228433390646`*^9, 
   3.933522846853388*^9}, {3.933522885248123*^9, 3.933522911754551*^9}, {
   3.9335232703400564`*^9, 3.933523277849794*^9}, {3.933523335106475*^9, 
   3.933523355992345*^9}, {3.933523425438649*^9, 3.9335234638060565`*^9}, {
   3.9335235745662947`*^9, 3.9335235928618717`*^9}, {3.9335237453658166`*^9, 
   3.9335238215470233`*^9}, {3.933523858801598*^9, 3.93352391118953*^9}, {
   3.9335239630493984`*^9, 3.933523972823078*^9}, {3.9335240424346395`*^9, 
   3.9335240537956476`*^9}, {3.933524527281947*^9, 3.9335245338617873`*^9}, {
   3.933524664368587*^9, 3.933524736237775*^9}, {3.9335247939526715`*^9, 
   3.9335248070256877`*^9}, {3.933524895320916*^9, 3.9335248967262807`*^9}, {
   3.9335249806392803`*^9, 3.933525006703373*^9}, {3.933525049211776*^9, 
   3.933525089769014*^9}, {3.93352549706491*^9, 3.933525509481338*^9}, {
   3.933525541621473*^9, 3.933525544712328*^9}, {3.9335256559624166`*^9, 
   3.9335256646090164`*^9}, {3.933526166851949*^9, 3.9335261685962677`*^9}, {
   3.9335263905813417`*^9, 3.933526393046626*^9}, {3.9335750987599545`*^9, 
   3.933575098973573*^9}, {3.933575178818302*^9, 3.933575179120417*^9}, {
   3.933575472649089*^9, 3.9335754749150953`*^9}, {3.9335791546425543`*^9, 
   3.933579174337764*^9}, {3.9335822104407043`*^9, 3.9335822265903273`*^9}, {
   3.9335838585175624`*^9, 3.933583862108574*^9}, {3.9335839114568596`*^9, 
   3.9335839141229453`*^9}, {3.9335847914358206`*^9, 3.933584796364362*^9}, 
   3.933584849153515*^9, {3.933585008318888*^9, 3.9335850124755545`*^9}, {
   3.933585051941353*^9, 3.9335850650782337`*^9}, {3.9336110216608458`*^9, 
   3.93361102454924*^9}, {3.9336112763142953`*^9, 3.933611280495189*^9}, {
   3.9336113114437923`*^9, 3.933611313513953*^9}, {3.93365239672536*^9, 
   3.933652490175949*^9}, {3.9336526266278906`*^9, 3.9336526406466923`*^9}, {
   3.9336532093362875`*^9, 3.9336532215393515`*^9}, {3.936341642575135*^9, 
   3.936341647908641*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"020dfa1f-688e-4c46-95fc-b7e1a6de2f05"],

Cell[CellGroupData[{

Cell["Temp", "Subsubsection",
 CellChangeTimes->{{3.936408826986915*^9, 
  3.9364088274189987`*^9}},ExpressionUUID->"bce501e5-40df-48bc-843a-\
8ba42c64210a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"generateInjections1", "[", 
   RowBox[{
   "LLP_", ",", "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "tIni_", ",", 
    "solY_", ",", "solUniverseApprox_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{"\[Epsilon]direct", ",", "\[Epsilon]sec"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"aratiolocal", ",", "T\[Gamma]local", ",", "nBn\[Gamma]local"}],
       "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"calcBaseInjectedEnergy", "[", 
        RowBox[{"LLP", ",", "mX"}], "]"}], ">", "0."}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"aratiolocal", "[", "t_", "]"}], ",", 
          RowBox[{"T\[Gamma]local", "[", "t_", "]"}]}], "}"}], "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"aRatio", "[", "t", "]"}], ",", 
           RowBox[{"T\[Gamma]", "[", "t", "]"}]}], "}"}], "/.", 
         "solUniverseApprox"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nBn\[Gamma]local", "[", "t_", "]"}], "=", 
        RowBox[{
         RowBox[{"n\[Gamma]", "[", 
          RowBox[{"T\[Gamma]local", "[", "t", "]"}], "]"}], "*", 
         "\[Eta]BPlanck", "*", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"aratiolocal", "[", "t", "]"}], "*", 
              RowBox[{"T\[Gamma]local", "[", "t", "]"}]}], ")"}], 
            RowBox[{
             RowBox[{"aratiolocal", "[", "tmaxsol", "]"}], "*", 
             RowBox[{"T\[Gamma]local", "[", "tmaxsol", "]"}]}]], ")"}], 
          RowBox[{"-", "3"}]]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ProdProbChecker", "[", 
            RowBox[{"LLP", ",", "mX", ",", "particle"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"decayProbTemp", "[", 
              RowBox[{"particle", ",", "t_"}], "]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"channels", "[", "particle", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", 
                   RowBox[{"Plus", "@@", 
                    RowBox[{"channels", "[", "particle", "]"}]}]}], ")"}], "/.",
                  " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"IfConversion", "->", "True"}], ",", 
                   RowBox[{"IfPionConversion", "->", "True"}], ",", 
                   RowBox[{"nB", "->", 
                    RowBox[{"nBn\[Gamma]local", "[", 
                    RowBox[{"t", ",", "tmaxsol"}], "]"}]}]}], "}"}]}], "/.", 
                "solY"}], "/.", " ", 
               RowBox[{"{", 
                RowBox[{"T", "->", 
                 RowBox[{"(", 
                  RowBox[{"T\[Gamma]", "[", "t", "]"}], ")"}]}], "}"}]}], "/.",
               "solUniverseApprox"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"decayProbTemp", "[", 
              RowBox[{"particle", ",", "t_"}], "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"t", "<", 
                RowBox[{"10.", "*", "\[Tau]X"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"decayProbTemp", "[", 
                 RowBox[{"particle", ",", "t"}], "]"}], "]"}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"decayProbTemp", "[", 
                 RowBox[{"particle", ",", 
                  RowBox[{"10", "*", "\[Tau]X"}]}], "]"}], "]"}]}], "]"}]}], 
            ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"decayProbTemp", "[", 
             RowBox[{"particle", ",", "t_"}], "]"}], "=", "0."}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"particle", ",", "Yparticleslist"}], "}"}]}], "]"}], ";", 
       "\n", 
       RowBox[{"Do", "[", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]sec", "[", 
            RowBox[{"flav", ",", "t_"}], "]"}], "=", "\n", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"\[Rho]LLPscaling", "[", 
                RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
                 RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
                "]"}], 
               RowBox[{"\[Tau]X", "*", "mX"}]], 
              RowBox[{"NtoY", "[", 
               RowBox[{"LLP", ",", "pt", ",", "mX"}], "]"}], "*", 
              RowBox[{"decayProbTemp", "[", 
               RowBox[{"pt", ",", "t"}], "]"}], "*", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                "pt", "!=", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\""}], 
                ",", 
                RowBox[{"energyToNeutrino", "[", 
                 RowBox[{"pt", ",", "flav"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"energyToNeutrino", "[", 
                  RowBox[{"pt", ",", "flav"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"EKLkin", "[", 
                   RowBox[{"LLP", ",", "mX"}], "]"}], "*", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"energyToNeutrino", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                    "\"\<e\>\""}], "]"}], 
                    RowBox[{
                    "mass", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"",
                     "]"}]], "+", 
                    FractionBox[
                    RowBox[{"energyToNeutrino", "[", 
                    RowBox[{
                    "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                    "\"\<\[Mu]\>\""}], "]"}], 
                    RowBox[{
                    "mass", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"",
                     "]"}]]}], ")"}]}]}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"pt", ",", "Yparticleslist"}], "}"}]}], "]"}]}], ";"}], 
         "\n", ",", 
         RowBox[{"{", 
          RowBox[{"flav", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<e\>\"", ",", "\"\<\[Mu]\>\""}], "}"}]}], "}"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Epsilon]sec", "[", 
         RowBox[{"\"\<\[Tau]\>\"", ",", "t_"}], "]"}], "=", "0."}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Epsilon]direct", "[", "\"\<e\>\"", "]"}], ",", 
          RowBox[{"\[Epsilon]direct", "[", "\"\<\[Mu]\>\"", "]"}], ",", 
          RowBox[{"\[Epsilon]direct", "[", "\"\<\[Tau]\>\"", "]"}]}], "}"}], 
        "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Xi]to\[Nu]", "[", 
           RowBox[{
           "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
            "mX"}], "]"}], ",", 
          RowBox[{"\[Xi]to\[Nu]", "[", 
           RowBox[{
           "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", 
            ",", "mX"}], "]"}], ",", 
          RowBox[{"\[Xi]to\[Nu]", "[", 
           RowBox[{
           "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", 
            ",", "mX"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"t", "<", 
            RowBox[{"10", "\[Tau]X"}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Epsilon]direct", "[", "flav", "]"}], "+", 
               FractionBox[
                RowBox[{"\[Epsilon]sec", "[", 
                 RowBox[{"flav", ",", "t"}], "]"}], 
                FractionBox[
                 RowBox[{"\[Rho]LLPscaling", "[", 
                  RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
                   RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}],
                   "]"}], "\[Tau]X"]]}], "/.", "solY"}], "/.", "ruleToZero"}],
             "]"}], ",", "0."}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"flav", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<e\>\"", ",", "\"\<\[Mu]\>\"", ",", "\"\<\[Tau]\>\""}], 
            "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(e\)]\)\>\"", ",", 
          "mX"}], "]"}], ",", 
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Mu]\)]\)\>\"", 
          ",", "mX"}], "]"}], ",", 
        RowBox[{"\[Xi]to\[Nu]", "[", 
         RowBox[{
         "LLP", ",", "\"\<\!\(\*SubscriptBox[\(\[Nu]\), \(\[Tau]\)]\)\>\"", 
          ",", "mX"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], "\n",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solveEvolutionCorrectedFull1", "[", 
   RowBox[{
   "LLP_", ",", "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "tIni_", ",", 
    "tfinSim_", ",", "solY_", ",", "solUniverseApprox_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"GeVToMeV", "=", 
      RowBox[{"10", "^", "3"}]}], 
     RowBox[{"(*", 
      RowBox[{
      ",", "EqsEq", ",", "\[Xi]TotalElec", ",", "\[Xi]Total\[Mu]", ",", 
       "\[Xi]Total\[Tau]", ",", "solUniverse", ",", "system\[Rho]\[Nu]Inj", 
       ",", "system\[Rho]Inj", ",", "source\[Rho]\[Nu]Inj", ",", 
       "source\[Rho]Inj", ",", "\[Rho]\[Nu]inj10\[Tau]X", ",", 
       "\[Rho]inj10\[Tau]X", ",", "arat"}], "*)"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Xi]TotalElec", ",", "\[Xi]Total\[Mu]", ",", "\[Xi]Total\[Tau]"}], 
       "}"}], "=", 
      RowBox[{"generateInjections1", "[", 
       RowBox[{
       "LLP", ",", "mX", ",", "\[Tau]X", ",", "nXini", ",", "tIni", ",", 
        "solY", ",", "solUniverseApprox"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EqsEq", "=", 
      RowBox[{"EqsEqTemp", "[", 
       RowBox[{"mX", ",", "\[Tau]X", ",", "nXini", ",", 
        RowBox[{
        "1", "-", "\[Xi]TotalElec", "-", "\[Xi]Total\[Mu]", "-", 
         "\[Xi]Total\[Tau]"}], ",", "\[Xi]TotalElec", ",", "\[Xi]Total\[Mu]", 
        ",", "\[Xi]Total\[Tau]", ",", 
        RowBox[{"1.001", "*", "tIni"}], ",", "TiniEM"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solUniverse", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"EqsEq", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
           "T\[Nu]\[Tau]", ",", "aRatio"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", 
           RowBox[{"1.001", "*", "tIni"}], ",", "tfinSim"}], "}"}], ",", 
         RowBox[{"MaxSteps", "->", "100000"}], ",", 
         RowBox[{"Method", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<BDF\>\"", ",", 
            RowBox[{"\"\<MaxDifferenceOrder\>\"", "->", "2"}]}], "}"}]}]}], 
        RowBox[{"(*", 
         RowBox[{",", 
          RowBox[{"WorkingPrecision", "->", "18"}]}], "*)"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"system\[Rho]\[Nu]Inj", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]\[Nu]Inj", "'"}], "[", "t", "]"}], "+", 
             RowBox[{"4", " ", 
              FractionBox[
               RowBox[{
                RowBox[{"aRatio", "'"}], "[", "t", "]"}], 
               RowBox[{"aRatio", "[", "t", "]"}]], 
              RowBox[{"\[Rho]\[Nu]Inj", "[", "t", "]"}]}]}], "==", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
              "\[Xi]TotalElec", "+", "\[Xi]Total\[Mu]", "+", 
               "\[Xi]Total\[Tau]"}], ")"}], "*", 
             FractionBox[
              RowBox[{"\[Rho]LLPscaling", "[", 
               RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
                RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
               "]"}], "\[Tau]X"], "*", 
             RowBox[{"GeVToMeV", "^", "4"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]\[Nu]Inj", "[", 
             RowBox[{"tIni", "*", "1.001"}], "]"}], "==", "0"}]}], "}"}], "/.",
          " ", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"system\[Rho]Inj", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"\[Rho]Inj", "'"}], "[", "t", "]"}], "+", 
             RowBox[{"4", " ", 
              FractionBox[
               RowBox[{
                RowBox[{"aRatio", "'"}], "[", "t", "]"}], 
               RowBox[{"aRatio", "[", "t", "]"}]], 
              RowBox[{"\[Rho]Inj", "[", "t", "]"}]}]}], "==", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Rho]LLPscaling", "[", 
               RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
                RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
               "]"}], "\[Tau]X"], "*", 
             RowBox[{"GeVToMeV", "^", "4"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Rho]Inj", "[", 
             RowBox[{"tIni", "*", "1.001"}], "]"}], "==", "0"}]}], "}"}], "/.",
          " ", "solUniverse"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"source\[Rho]\[Nu]Inj", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"aRatio", "[", "t", "]"}], "4"], 
        RowBox[{"(", 
         RowBox[{
         "\[Xi]TotalElec", "+", "\[Xi]Total\[Mu]", "+", "\[Xi]Total\[Tau]"}], 
         ")"}], "*", 
        FractionBox[
         RowBox[{"\[Rho]LLPscaling", "[", 
          RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
           RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], "]"}], 
         "\[Tau]X"]}], "/.", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"source\[Rho]Inj", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"aRatio", "[", "t", "]"}], "4"], 
        FractionBox[
         RowBox[{"\[Rho]LLPscaling", "[", 
          RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
           RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], "]"}], 
         "\[Tau]X"]}], "/.", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Rho]\[Nu]inj10\[Tau]X", ",", "\[Rho]inj10\[Tau]X"}], "}"}], 
      "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Quiet", "[", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"#", "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"tIni", "*", "1.001"}], ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"10", "\[Tau]X"}], ",", "tfinSim"}], "]"}]}], "}"}], 
           ",", 
           RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}]}], "]"}], "]"}], 
        "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"source\[Rho]\[Nu]Inj", ",", "source\[Rho]Inj"}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{"solUniverse", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Rho]\[Nu]Injsol", "[", 
           RowBox[{"20", "*", "\[Tau]X"}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"arat", "[", 
              RowBox[{"20", "*", "\[Tau]X"}], "]"}], "/", 
             RowBox[{"arat", "[", "1000", "]"}]}], ")"}], "^", "4"}]}], 
         "*)"}], 
        RowBox[{"\[Rho]\[Nu]Inj", "/.", " ", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{"system\[Rho]\[Nu]Inj", ",", "0"}], "]"}], ",", 
            "\[Rho]\[Nu]Inj", ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"1.001", "*", "tIni"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"10", "*", "\[Tau]X"}], ",", "1000"}], "]"}]}], "}"}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"WorkingPrecision", "->", "20"}]}], "*)"}], ",", 
            RowBox[{"MaxSteps", "->", "50000"}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<BDF\>\"", ",", 
               RowBox[{"\"\<MaxDifferenceOrder\>\"", "->", "2"}]}], "}"}]}], 
            ",", 
            RowBox[{"WorkingPrecision", "->", "20"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Rho]Injsol", "[", 
           RowBox[{"20", "*", "\[Tau]X"}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"arat", "[", 
              RowBox[{"20", "*", "\[Tau]X"}], "]"}], "/", 
             RowBox[{"arat", "[", "1000", "]"}]}], ")"}], "^", "4"}]}], 
         "*)"}], 
        RowBox[{"\[Rho]Inj", "/.", " ", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"Rationalize", "[", 
             RowBox[{"system\[Rho]Inj", ",", "0"}], "]"}], ",", "\[Rho]Inj", 
            ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"1.001", "*", "tIni"}], ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"10", "*", "\[Tau]X"}], ",", "1000"}], "]"}]}], "}"}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{"WorkingPrecision", "->", "20"}]}], "*)"}], ",", 
            RowBox[{"MaxSteps", "->", "50000"}], ",", 
            RowBox[{"Method", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<BDF\>\"", ",", 
               RowBox[{"\"\<MaxDifferenceOrder\>\"", "->", "2"}]}], "}"}]}], 
            ",", 
            RowBox[{"WorkingPrecision", "->", "20"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"arat", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"aRatio", "[", "t", "]"}], "/.", "solUniverse"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"solUniverse", ",", 
       RowBox[{"\[Rho]\[Nu]inj10\[Tau]X", "*", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"arat", "[", "tfinSim", "]"}], "4"]]}], ",", 
       RowBox[{"\[Rho]inj10\[Tau]X", "*", 
        FractionBox["1", 
         SuperscriptBox[
          RowBox[{"arat", "[", "tfinSim", "]"}], "4"]]}]}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9364571744111176`*^9, 3.936457185884843*^9}, {
   3.9364572369790163`*^9, 3.936457239724968*^9}, {3.936457471023249*^9, 
   3.9364574767831492`*^9}, {3.936457532833815*^9, 3.936457594943575*^9}, {
   3.9364577274331274`*^9, 3.9364577744344044`*^9}, {3.9364582466042614`*^9, 
   3.936458254305554*^9}, {3.936458343504483*^9, 3.936458343681978*^9}, {
   3.936458374768906*^9, 3.9364583793040905`*^9}, {3.936458420636367*^9, 
   3.936458429977748*^9}, {3.9364584888648167`*^9, 3.9364585275505276`*^9}, {
   3.936458843879424*^9, 3.9364588490194197`*^9}, {3.936459021386363*^9, 
   3.9364590538625193`*^9}, {3.9364592215810924`*^9, 3.936459228837094*^9}, 
   3.9364594369788523`*^9, 3.9364605382286043`*^9, {3.936460901861929*^9, 
   3.9364609593846188`*^9}, {3.9364611406171904`*^9, 
   3.9364611438871155`*^9}, {3.9364612038086863`*^9, 3.936461211250471*^9}, {
   3.9364612488294735`*^9, 3.9364612636496167`*^9}, {3.936461679358889*^9, 
   3.936461747840767*^9}, 3.9364626167698784`*^9, {3.936462697498728*^9, 
   3.936462705701445*^9}, {3.9364650935155687`*^9, 3.936465106072221*^9}, {
   3.9393567579163837`*^9, 
   3.9393567706875687`*^9}},ExpressionUUID->"0e23c780-74dc-4da4-8d5b-\
f0bee7d70793"],

Cell[CellGroupData[{

Cell["Full", "Item",
 CellChangeTimes->{{3.9364576932887735`*^9, 
  3.9364576941364326`*^9}},ExpressionUUID->"4acf1eeb-8c80-4fb7-9838-\
5e8ab22ea2d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mergedFunction1", "[", 
   RowBox[{"LLPsel_", ",", "mllp_", ",", "\[Tau]llp_", ",", "particles_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tempStart", "=", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]], "*", "5.1101533"}]}], ",", 
      RowBox[{"lifetimeFactor", "=", "10"}], ",", 
      RowBox[{"npoints", "=", "500"}], ",", 
      RowBox[{"tfinSim", "=", 
       RowBox[{"N", "[", "tmaxsol", "]"}]}], ",", "solY", ",", 
      "solUniverseApprox"}], 
     RowBox[{"(*", 
      RowBox[{
      ",", "injE", ",", "injE\[Nu]", ",", "Neff", ",", "r1val", ",", "r2val", 
       ",", "r3val", ",", "solY", ",", "solUniverse", ",", "pars", ",", 
       "numberDens", ",", "basicElecInj", ",", "basicMuInj", ",", 
       "basicNeffSol", ",", "NeffBase", ",", "Ttdyn", ",", "nBttest", ",", 
       "nLLPiniVal", ",", "t0", ",", "tEnd", ",", "\[Xi]DirectElec", ",", 
       "\[Xi]Direct\[Mu]", ",", "\[Xi]Direct\[Tau]", ",", "T\[Gamma]sol", ",",
        "T\[Gamma]fin", ",", "nLLPinput", ",", "aratiosol", ",", "ntoKp", ",",
        "ntoKL", ",", "nto\[Mu]", ",", "nto\[Pi]", ",", "tIniEM", ",", 
       "solutionsThermodynamics", ",", "solUniverseApprox", ",", "decayProb", 
       ",", "\[Rho]\[Nu]InjSol", ",", "\[Rho]InjSol", ",", "placeholder", ",",
        "tpoints"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Initial", " ", "value", " ", "of", " ", "the", " ", "number", " ", 
        "density", " ", "in", " ", "GeV"}], " ", "-", " ", 
       RowBox[{
       "at", " ", "the", " ", "starting", " ", "temperature", " ", "T"}]}], 
      " ", "=", " ", 
      RowBox[{"20", " ", "MeV"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nLLPiniVal", "=", 
      RowBox[{"nLLPini", "[", 
       RowBox[{"LLPsel", ",", "mllp", ",", "\[Tau]llp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Numbers", " ", "of", " ", "Ys", " ", "of", " ", "the", " ", "given", 
       " ", "charge", " ", "per", " ", 
       RowBox[{"X", "'"}], "s", " ", "decay"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ntoKp", ",", "ntoKL", ",", "nto\[Pi]", ",", "nto\[Mu]"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
          "mllp"}], "]"}], ",", 
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
          "mllp"}], "]"}], ",", 
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", 
          ",", "mllp"}], "]"}], ",", 
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", 
          ",", "mllp"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"calcBaseInjectedEnergy", "[", 
         RowBox[{"LLPsel", ",", "mllp"}], "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Computing", " ", "the", " ", "evolution", " ", "of", " ", 
          "secondary", " ", "particles"}], " ", "-", " ", "solY"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"solutionsThermodynamics", ","}], "*)"}], 
          RowBox[{"solUniverseApprox", ",", "tIniEM", ",", "solY"}], "}"}], 
         "=", 
         RowBox[{"BlockFullSystemNumberDens", "[", 
          RowBox[{
          "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", "1", ",", "ntoKp",
            ",", "ntoKL", ",", "nto\[Pi]", ",", "nto\[Mu]", ",", "True", ",", 
           "True", ",", "True", ",", "True"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nKpsol", "[", "t_", "]"}], ",", 
            RowBox[{"nKmsol", "[", "t_", "]"}], ",", 
            RowBox[{"nKLsol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Pi]psol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Pi]msol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Mu]psol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Mu]msol", "[", "t_", "]"}], ",", 
            RowBox[{"Xnsol", "[", "t_", "]"}]}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", "t", "]"}], "/.", "sol"}], ")"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "nKplus", ",", "nKminus", ",", "nKL", ",", "n\[Pi]plus", ",", 
             "n\[Pi]minus", ",", "n\[Mu]plus", ",", "n\[Mu]minus", ",", 
             "Xn"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Xnsol", "[", "t_", "]"}], "=", 
          RowBox[{"sc", "*", 
           RowBox[{"Xnsol", "[", "t", "]"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"placeholder", ",", "tIniEM"}], "}"}], "=", 
         RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
          RowBox[{
          "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", "1", ",", 
           "tfinSim"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ProdProbChecker", "[", 
          RowBox[{"LLPsel", ",", "mllp", ",", "particle"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"decayProb", "[", 
            RowBox[{"particle", ",", "t_"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"channels", "[", "particle", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", 
                 RowBox[{"Plus", "@@", 
                  RowBox[{"channels", "[", "particle", "]"}]}]}], ")"}], "/.",
                " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"IfConversion", "->", "True"}], ",", 
                 RowBox[{"IfPionConversion", "->", "True"}], ",", 
                 RowBox[{"nB", "->", 
                  RowBox[{"nBn\[Gamma]", "[", 
                   RowBox[{"t", ",", "tfinSim"}], "]"}]}]}], "}"}]}], "/.", 
              " ", "solY"}], "/.", " ", 
             RowBox[{"T", "->", 
              RowBox[{"(", 
               RowBox[{"T\[Gamma]sol", "[", "t", "]"}], ")"}]}]}], "/.", " ", 
            "solUniverseApprox"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"decayProb", "[", 
            RowBox[{"particle", ",", "t_"}], "]"}], "=", 
           RowBox[{
            RowBox[{"decayProb", "[", 
             RowBox[{"particle", ",", "t"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"T\[Gamma]", "[", "tfinSim", "]"}], "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"T\[Gamma]", "[", "t", "]"}], "/.", 
                  "solUniverseApprox"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"t", "->", "tfinSim"}], "}"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"aRatio", "[", "tfinSim", "]"}], "->", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"aRatio", "[", "t", "]"}], "/.", 
                  "solUniverseApprox"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"t", "->", "tfinSim"}], "}"}]}], ")"}]}]}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"decayProb", "[", 
            RowBox[{"particle", ",", "t_"}], "]"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"t", "<", 
              RowBox[{"10.", "*", "\[Tau]llp"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"decayProb", "[", 
               RowBox[{"particle", ",", "t"}], "]"}], "]"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"decayProb", "[", 
               RowBox[{"particle", ",", 
                RowBox[{"10", "*", "\[Tau]llp"}]}], "]"}], "]"}]}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"decayProb", "[", 
           RowBox[{"particle", ",", "t_"}], "]"}], "=", "0."}]}], 
        "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"particle", ",", "particles"}], "}"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Computing", " ", "the", " ", "evolution", " ", "of", " ", "neutrinos", 
       " ", "and", " ", "EM", " ", "plasma", " ", "as", " ", "a", " ", 
       "result", " ", "of", " ", "the", " ", "decays", " ", "of", " ", 
       "scalars", " ", "and", " ", "dynamics", " ", "of", " ", 
       "secondaries"}], " ", "-", "  ", 
      RowBox[{"mesons", " ", "and", " ", "muons"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"solUniverse", ",", "\[Rho]\[Nu]InjSol", ",", "\[Rho]InjSol"}],
        "}"}], "=", 
      RowBox[{"solveEvolutionCorrectedFull1", "[", 
       RowBox[{
       "LLPsel", ",", "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", 
        "tIniEM", ",", "tfinSim", ",", "solY", ",", "solUniverseApprox"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T\[Gamma]sol", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"T\[Gamma]", "[", "t", "]"}], "/.", "solUniverse"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T\[Gamma]fin", "=", 
      RowBox[{"T\[Gamma]sol", "[", "tfinSim", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aratiosol", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"aRatio", "[", "t", "]"}], "/.", "solUniverse"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["N", "eff"], " ", "using", " ", "integrated", " ", 
       "Boltzmann", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Neff", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NeffT", "[", 
         RowBox[{
          RowBox[{"T\[Gamma]sol", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}], "/.", " ", 
        "solUniverse"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{"t", "->", "tfinSim"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      SubscriptBox["r", 
       RowBox[{"1", "-", "3"}]], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1val", ",", "r2val", ",", "r3val"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["\[Rho]InjSol", 
           RowBox[{
            RowBox[{"\[Rho]\[Nu]Total", "[", 
             RowBox[{
              RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
              RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
              RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}], "+", 
            RowBox[{"\[Rho]\[Gamma]", "[", "T\[Gamma]fin", "]"}], "+", 
            RowBox[{"\[Rho]e", "[", "T\[Gamma]fin", "]"}]}]], ",", 
          FractionBox["\[Rho]\[Nu]InjSol", "\[Rho]InjSol"], ",", 
          FractionBox["\[Rho]\[Nu]InjSol", 
           RowBox[{"\[Rho]\[Nu]Total", "[", 
            RowBox[{
             RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
             RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
             RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}]]}], "}"}], "/.",
         " ", "solUniverse"}], "/.", " ", 
       RowBox[{"t", "->", "tfinSim"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Starting", " ", "time", " ", 
        SubscriptBox["t", "0"], " ", "of", " ", 
        RowBox[{"Kensuke", "'"}], "s", " ", 
        RowBox[{"code", ".", " ", "Corresponds"}], " ", "to", " ", "starting",
         " ", "temperature", " ", "T"}], " ", "=", " ", 
       RowBox[{"5.1101533", " ", "MeV"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"t0", "=", 
      RowBox[{
       RowBox[{"InverseFunction", "[", 
        RowBox[{"T\[Gamma]", "/.", " ", "solUniverse"}], "]"}], "[", 
       "tempStart", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t0", "<", "tIniEM"}], ",", 
       RowBox[{"t0", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"InverseFunction", "[", 
             RowBox[{"T\[Gamma]", "/.", " ", "solUniverse"}], "]"}], "[", 
            RowBox[{"1.003", "tempStart"}], "]"}], "+", 
           RowBox[{
            RowBox[{"InverseFunction", "[", 
             RowBox[{"T\[Gamma]", "/.", " ", "solUniverse"}], "]"}], "[", 
            RowBox[{"0.997", "tempStart"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"The", " ", "value", " ", "of", " ", 
        SubscriptBox["n", "LLP"], " ", "at", " ", "t"}], " ", "=", " ", 
       SubscriptBox["t", "0"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nLLPinput", "=", 
      FractionBox[
       RowBox[{"\[Rho]LLPscaling", "[", 
        RowBox[{"mllp", ",", "nLLPiniVal", ",", "\[Tau]llp", ",", 
         RowBox[{"aratiosol", "[", "t0", "]"}], ",", "t0", ",", "tIniEM"}], 
        "]"}], "mllp"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Compute", " ", "decay", " ", "probabilities"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tEnd", "=", 
      RowBox[{"t0", "+", 
       RowBox[{"\[Tau]llp", "*", "lifetimeFactor"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ProdProbChecker", "[", 
          RowBox[{"LLPsel", ",", "mllp", ",", "particle"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"decayProb", "[", 
            RowBox[{"particle", ",", "t_"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"channels", "[", "particle", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "/", 
                 RowBox[{"Plus", "@@", 
                  RowBox[{"channels", "[", "particle", "]"}]}]}], ")"}], "/.",
                " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"IfConversion", "->", "True"}], ",", 
                 RowBox[{"IfPionConversion", "->", "True"}], ",", 
                 RowBox[{"nB", "->", 
                  RowBox[{"nBn\[Gamma]", "[", 
                   RowBox[{"t", ",", "tfinSim"}], "]"}]}]}], "}"}]}], "/.", 
              " ", "solY"}], "/.", " ", 
             RowBox[{"T", "->", 
              RowBox[{"(", 
               RowBox[{"T\[Gamma]sol", "[", "t", "]"}], ")"}]}]}], "/.", " ", 
            "solUniverse"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"decayProb", "[", 
            RowBox[{"particle", ",", "t_"}], "]"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"t", "<", 
              RowBox[{"10.", "*", "\[Tau]llp"}]}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"decayProb", "[", 
               RowBox[{"particle", ",", "t"}], "]"}], "]"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"decayProb", "[", 
               RowBox[{"particle", ",", 
                RowBox[{"10", "*", "\[Tau]llp"}]}], "]"}], "]"}]}], "]"}]}], 
          ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"decayProb", "[", 
           RowBox[{"particle", ",", "t_"}], "]"}], "=", "0."}]}], 
        "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"particle", ",", "particles"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tpoints", "=", 
      RowBox[{"tpointsBlock", "[", 
       RowBox[{"npoints", ",", "t0", ",", "tEnd", ",", "T\[Gamma]sol"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Return", " ", "basic", " ", "info", " ", "about", " ", "the", " ", 
       "Universe", " ", "plus", " ", "tabulated", " ", "decay", " ", 
       "probabilities", " ", "of", " ", "the", " ", "selected", " ", 
       "particles", " ", "for", " ", "temperature", " ", "in", " ", "MeV"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mllp", ",", "\[Tau]llp", ",", "nLLPinput", ",", "Neff", ",", 
          "r1val", ",", "r2val", ",", "r3val", ",", "nto\[Mu]", ",", 
          "nto\[Pi]", ",", "ntoKp", ",", "ntoKL", ",", 
          RowBox[{"calcBaseInjectedEnergy", "[", 
           RowBox[{"LLPsel", ",", "mllp"}], "]"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SuperscriptBox["10", "3"], 
              RowBox[{"T\[Gamma]sol", "[", "t", "]"}]}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"decayProb", "[", 
                RowBox[{"particle", ",", "t"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"particle", ",", "particles"}], "}"}]}], "]"}]}], 
            "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tpoints"}], "}"}]}], "]"}]}], "}"}], "//", 
      "N"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.936457841972482*^9, 3.9364578425394597`*^9}, {
   3.9364578929692345`*^9, 3.9364578968995066`*^9}, {3.936457955284446*^9, 
   3.9364579572473297`*^9}, {3.936459084783595*^9, 3.9364590852382565`*^9}, 
   3.9364592678173885`*^9, {3.936459472209839*^9, 3.9364595103205805`*^9}, {
   3.9364596208528385`*^9, 3.9364596234231305`*^9}, {3.9364596561836786`*^9, 
   3.9364596594537816`*^9}, {3.9364597339745893`*^9, 
   3.9364597347719717`*^9}, {3.9364605532240167`*^9, 3.93646055696414*^9}, {
   3.936460600711708*^9, 3.936460606937249*^9}, {3.936461281156003*^9, 
   3.9364612843315*^9}, {3.936461924269865*^9, 3.936461931634655*^9}, {
   3.9364626206003914`*^9, 3.936462624120263*^9}, {3.9364650727753305`*^9, 
   3.9364650794554634`*^9}, {3.9364654178917675`*^9, 
   3.9364654438150587`*^9}, {3.936465530336696*^9, 3.936465629902351*^9}, {
   3.936465662604607*^9, 3.93646566983315*^9}, {3.936465702453152*^9, 
   3.9364657072102633`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"30687c51-a89c-48d7-8422-290c81947f61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"masstest", "=", "0.31"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mergedFunction", "[", 
         RowBox[{"\"\<Scalar\>\"", ",", "masstest", ",", "0.1", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "}"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"decayProb", "[", 
        RowBox[{
        "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", "0.2"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]TotalElec", "/.", "solUniverseApprox"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"t", "->", "0.2"}], "}"}]}]}], "//", 
      RowBox[{
       RowBox[{"Expand", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mergedFunction1", "[", 
          RowBox[{"\"\<Scalar\>\"", ",", "masstest", ",", "0.1", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "}"}]}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"decayProbTemp", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", "0.2"}], 
         "]"}]}], "/.", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"t", "->", "0.2"}], "}"}], "\[IndentingNewLine]", 
        RowBox[{"\[Xi]TotalElec", "/.", 
         RowBox[{"{", 
          RowBox[{"t", "->", "0.2"}], "}"}]}]}]}]}], "//", "Expand"}]}], 
   "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQfabxRr9RyFtH9rnxE0F06QrR6SDa4qzKHBDd4K6/
DESvmFq7FkS7XC18BqIdQ9aA6R7Zvh8gWtO38ydYf1wArzGQrrgYIwqiFQ72
S4JoHctvUiDa0pXNBER/8DlmCqLZdnXZguh/Rs/B9I1j4UEgeprzTjBdc1Ul
HkSX/DYE00JZjEUg2vmrFZju4IwsA9H1J/vBdIX42WoQfYQlqAZEJz7f2Aai
fSsfgukZX2Wegeh722LBtJHd77cg2u+09juw/O0L9SZAOuydRgOIdi9e2w6i
lzJeBtMLN+zoBdH7F30B0wXTJGaCaBMfPzDN5qYpagYKt28lYFrL8akHiDaR
tvYE0Q8mCSWC6LxoNTCdMHVLq3foW0cnUc02EA0Aw5e1wg==
  "],
 CellLabel->"In[8]:=",ExpressionUUID->"e487b458-66d9-47a3-9de9-f35307c2c9aa"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
   "0.31`", ",", "0.1`", ",", "2.793634922067541`*^-10", ",", 
    "2.966963003665329`", ",", "0.06192159077800743`", ",", 
    "0.12367533944959012`", ",", "0.019027792803353927`", ",", 
    "0.19579641505607123`", ",", "0.5361279288193275`", ",", "0.`", ",", 
    "0.`", ",", "0.4255020616385478`"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9364598382702165`*^9, 3.9364605668984537`*^9, 
  3.936460665847343*^9, 3.9364609786186705`*^9, 3.9364612950294714`*^9, 
  3.936461895143935*^9, 3.9364620349783907`*^9, 3.9364654901919403`*^9, 
  3.9364656406777897`*^9, 3.9364656820930367`*^9, 3.936465718449496*^9},
 CellLabel->
  "Out[385]=",ExpressionUUID->"9364cfd2-7c13-4aff-8146-2b49c3d61caa"],

Cell[BoxData[
 FormBox["0.31255016050719375`", TraditionalForm]], "Output",
 CellChangeTimes->{3.9364598382702165`*^9, 3.9364605668984537`*^9, 
  3.936460665847343*^9, 3.9364609786186705`*^9, 3.9364612950294714`*^9, 
  3.936461895143935*^9, 3.9364620349783907`*^9, 3.9364654901919403`*^9, 
  3.9364656406777897`*^9, 3.9364656820930367`*^9, 3.936465718455*^9},
 CellLabel->
  "Out[386]=",ExpressionUUID->"7a903104-c386-4e4e-a9ff-75db152267b6"],

Cell[BoxData[
 FormBox["0.03921463315570748`", TraditionalForm]], "Output",
 CellChangeTimes->{3.9364598382702165`*^9, 3.9364605668984537`*^9, 
  3.936460665847343*^9, 3.9364609786186705`*^9, 3.9364612950294714`*^9, 
  3.936461895143935*^9, 3.9364620349783907`*^9, 3.9364654901919403`*^9, 
  3.9364656406777897`*^9, 3.9364656820930367`*^9, 3.936465718512394*^9},
 CellLabel->
  "Out[387]=",ExpressionUUID->"89176fc1-fc70-4219-8a66-ebb2a15796ae"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Part", "partd", 
    "\"Part specification \\!\\(\\*FormBox[RowBox[{\\\"Null\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}], \
TraditionalForm]\\) is longer than depth of object.\"", 2, 388, 17, 
    25763031995704948306, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{3.9364598413652835`*^9, 3.936460572834219*^9, 
  3.9364606692902412`*^9, 3.936460981903372*^9, 3.9364613018358583`*^9, 
  3.9364619016892414`*^9, 3.9364620383371153`*^9, 3.936465493774276*^9, 
  3.9364656443776226`*^9, 3.9364656859199376`*^9, 3.936465722194681*^9},
 CellLabel->
  "During evaluation of \
In[384]:=",ExpressionUUID->"bb665822-3e46-417e-984a-bbe896788aef"],

Cell[BoxData[
 FormBox[
  RowBox[{"Null", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9364598382702165`*^9, 3.9364605668984537`*^9, 
  3.936460665847343*^9, 3.9364609786186705`*^9, 3.9364612950294714`*^9, 
  3.936461895143935*^9, 3.9364620349783907`*^9, 3.9364654901919403`*^9, 
  3.9364656406777897`*^9, 3.9364656820930367`*^9, 3.9364657222114925`*^9},
 CellLabel->
  "Out[388]=",ExpressionUUID->"e4f1bdcb-3902-497a-bfae-324ac08c729e"],

Cell[BoxData[
 FormBox["1", TraditionalForm]], "Output",
 CellChangeTimes->{3.9364598382702165`*^9, 3.9364605668984537`*^9, 
  3.936460665847343*^9, 3.9364609786186705`*^9, 3.9364612950294714`*^9, 
  3.936461895143935*^9, 3.9364620349783907`*^9, 3.9364654901919403`*^9, 
  3.9364656406777897`*^9, 3.9364656820930367`*^9, 3.9364657222114925`*^9},
 CellLabel->
  "Out[389]=",ExpressionUUID->"84208737-9f43-492a-a9d9-300c4122976d"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"0.00003318226775837226`", " ", 
    SuperscriptBox[
     RowBox[{"aRatio", "(", "0.2`", ")"}], "3"]}], "+", "0.`"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.9364598382702165`*^9, 3.9364605668984537`*^9, 
  3.936460665847343*^9, 3.9364609786186705`*^9, 3.9364612950294714`*^9, 
  3.936461895143935*^9, 3.9364620349783907`*^9, 3.9364654901919403`*^9, 
  3.9364656406777897`*^9, 3.9364656820930367`*^9, 3.936465722229792*^9},
 CellLabel->
  "Out[390]=",ExpressionUUID->"b6dc588e-6afd-49e6-8c35-50bac5827b89"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Block returning r-ratios and tabulated decay probabilities", \
"Subsection",
 CellChangeTimes->{{3.932397095702202*^9, 
  3.932397120974826*^9}},ExpressionUUID->"4c5c758c-b209-4ee3-bfcb-\
a3dce11aa931"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tpointsBlock", "[", 
   RowBox[{"npoints_", ",", "t0_", ",", "tEnd_", ",", "T\[Gamma]sol_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tpoints", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tpoints", "=", 
      RowBox[{"Subdivide", "[", 
       RowBox[{"t0", ",", "tEnd", ",", 
        RowBox[{"npoints", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"T\[Gamma]sol", "[", "t0", "]"}], "-", 
          RowBox[{"T\[Gamma]sol", "[", 
           RowBox[{"tpoints", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], 
         RowBox[{"T\[Gamma]sol", "[", "t0", "]"}]], ">", "0.1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tpoints", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"tpoints", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Exp", "[", "x", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"Log", "[", "t0", "]"}], ",", 
                 RowBox[{"Log", "[", 
                  RowBox[{"tpoints", "[", 
                   RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"tpoints", "[", 
                    RowBox[{"[", "5", "]"}], "]"}], "]"}], "-", 
                   RowBox[{"Log", "[", "t0", "]"}]}], "30"]}], "}"}]}], 
              "]"}]}], "]"}], "//", "Sort"}], "//", "DeleteDuplicates"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "tpoints"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProdProbChecker", "[", 
   RowBox[{"LLP_", ",", "mLLP_", ",", "particle_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cond", "=", "False"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
           "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\""}], "}"}], ",", 
         "particle"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"cond", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"NtoY", "[", 
               RowBox[{"LLP", ",", "Y", ",", "mLLP"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Y", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\""}], "}"}]}], 
               "}"}]}], "]"}], "]"}], ">", "0"}], ",", "True", ",", "False"}],
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
           "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\""}], "}"}], ",", 
         "particle"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"cond", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"NtoY", "[", 
               RowBox[{"LLP", ",", "Y", ",", "mLLP"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Y", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
                  "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\""}], "}"}]}], 
               "}"}]}], "]"}], "]"}], ">", "0"}], ",", "True", ",", "False"}],
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", "}"}], 
         ",", "particle"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"cond", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"NtoY", "[", 
               RowBox[{"LLP", ",", "Y", ",", "mLLP"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Y", ",", 
                RowBox[{
                "{", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", "}"}]}], 
               "}"}]}], "]"}], "]"}], ">", "0"}], ",", "True", ",", "False"}],
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
           "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\""}], "}"}], ",", 
         "particle"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"cond", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"NtoY", "[", 
               RowBox[{"LLP", ",", "Y", ",", "mLLP"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Y", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
                  "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\""}], "}"}]}], 
               "}"}]}], "]"}], "]"}], ">", "0"}], ",", "True", ",", "False"}],
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
      "cond"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mergedFunction", "[", 
   RowBox[{
   "LLPsel_", ",", "mllp_", ",", "\[Tau]llp_", ",", "particles_", ",", 
    "DecayOnly_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tempStart", "=", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "3."}]], "*", "5.1101533"}]}], ",", 
      RowBox[{"lifetimeFactor", "=", "10"}], ",", 
      RowBox[{"npoints", "=", "500"}], ",", 
      RowBox[{"tfinSim", "=", 
       RowBox[{"N", "[", "tmaxsol", "]"}]}], ",", "injE", ",", "injE\[Nu]", 
      ",", "Neff", ",", "r1val", ",", "r2val", ",", "r3val", ",", "solY", ",",
       "solUniverse", ",", "pars", ",", "numberDens", ",", "basicElecInj", 
      ",", "basicMuInj", ",", "basicNeffSol", ",", "NeffBase", ",", "Ttdyn", 
      ",", "nBttest", ",", "nLLPiniVal", ",", "t0", ",", "tEnd", ",", 
      "\[Xi]DirectElec", ",", "\[Xi]Direct\[Mu]", ",", "\[Xi]Direct\[Tau]", 
      ",", "T\[Gamma]sol", ",", "T\[Gamma]fin", ",", "nLLPinput", ",", 
      "aratiosol", ",", "ntoKp", ",", "ntoKL", ",", "nto\[Mu]", ",", 
      "nto\[Pi]", ",", "tIniEM", ",", "solutionsThermodynamics", ",", 
      "solUniverseApprox", ",", "decayProb", ",", "\[Rho]\[Nu]InjSol", ",", 
      "\[Rho]InjSol", ",", "placeholder", ",", "tpoints"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Initial", " ", "value", " ", "of", " ", "the", " ", "number", " ", 
        "density", " ", "in", " ", "GeV"}], " ", "-", " ", 
       RowBox[{
       "at", " ", "the", " ", "starting", " ", "temperature", " ", "T"}]}], 
      " ", "=", " ", 
      RowBox[{"20", " ", "MeV"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nLLPiniVal", "=", 
      RowBox[{"nLLPini", "[", 
       RowBox[{"LLPsel", ",", "mllp", ",", "\[Tau]llp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Numbers", " ", "of", " ", "Ys", " ", "of", " ", "the", " ", "given", 
       " ", "charge", " ", "per", " ", 
       RowBox[{"X", "'"}], "s", " ", "decay"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ntoKp", ",", "ntoKL", ",", "nto\[Pi]", ",", "nto\[Mu]"}], 
       "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
          "mllp"}], "]"}], ",", 
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
          "mllp"}], "]"}], ",", 
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", 
          ",", "mllp"}], "]"}], ",", 
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", 
          ",", "mllp"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"calcBaseInjectedEnergy", "[", 
         RowBox[{"LLPsel", ",", "mllp"}], "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Computing", " ", "the", " ", "evolution", " ", "of", " ", 
          "secondary", " ", "particles"}], " ", "-", " ", "solY"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"solutionsThermodynamics", ","}], "*)"}], 
          RowBox[{"solUniverseApprox", ",", "tIniEM", ",", "solY"}], "}"}], 
         "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "DecayOnly"}], ",", "\[IndentingNewLine]", 
           RowBox[{"BlockFullSystemNumberDens", "[", 
            RowBox[{
            "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", "1", ",", 
             "ntoKp", ",", "ntoKL", ",", "nto\[Pi]", ",", "nto\[Mu]", ",", 
             "True", ",", "True", ",", "True", ",", "True"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"BlockFullSystemNumberDens", "[", 
            RowBox[{
            "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", "1", ",", 
             "ntoKp", ",", "ntoKL", ",", "nto\[Pi]", ",", "nto\[Mu]", ",", 
             "True", ",", "False", ",", "False", ",", "False"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nKpsol", "[", "t_", "]"}], ",", 
            RowBox[{"nKmsol", "[", "t_", "]"}], ",", 
            RowBox[{"nKLsol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Pi]psol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Pi]msol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Mu]psol", "[", "t_", "]"}], ",", 
            RowBox[{"n\[Mu]msol", "[", "t_", "]"}], ",", 
            RowBox[{"Xnsol", "[", "t_", "]"}]}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", "t", "]"}], "/.", "sol"}], ")"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
            "nKplus", ",", "nKminus", ",", "nKL", ",", "n\[Pi]plus", ",", 
             "n\[Pi]minus", ",", "n\[Mu]plus", ",", "n\[Mu]minus", ",", 
             "Xn"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Xnsol", "[", "t_", "]"}], "=", 
          RowBox[{"sc", "*", 
           RowBox[{"Xnsol", "[", "t", "]"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"placeholder", ",", "tIniEM"}], "}"}], "=", 
         RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
          RowBox[{
          "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", "1", ",", 
           "tfinSim"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Computing", " ", "the", " ", "evolution", " ", "of", " ", "neutrinos",
         " ", "and", " ", "EM", " ", "plasma", " ", "as", " ", "a", " ", 
        "result", " ", "of", " ", "the", " ", "decays", " ", "of", " ", 
        "scalars", " ", "and", " ", "dynamics", " ", "of", " ", 
        "secondaries"}], " ", "-", "  ", 
       RowBox[{"mesons", " ", "and", " ", "muons"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"solUniverse", ",", "\[Rho]\[Nu]InjSol", ",", "\[Rho]InjSol"}],
        "}"}], "=", 
      RowBox[{"solveEvolutionCorrectedFull", "[", 
       RowBox[{
       "LLPsel", ",", "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", 
        "tIniEM", ",", "tfinSim", ",", "solY"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T\[Gamma]sol", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"T\[Gamma]", "[", "t", "]"}], "/.", "solUniverse"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"T\[Gamma]fin", "=", 
      RowBox[{"T\[Gamma]sol", "[", "tfinSim", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aratiosol", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"aRatio", "[", "t", "]"}], "/.", "solUniverse"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       SubscriptBox["N", "eff"], " ", "using", " ", "integrated", " ", 
       "Boltzmann", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Neff", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"NeffT", "[", 
         RowBox[{
          RowBox[{"T\[Gamma]sol", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}], "/.", " ", 
        "solUniverse"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{"t", "->", "tfinSim"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      SubscriptBox["r", 
       RowBox[{"1", "-", "3"}]], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1val", ",", "r2val", ",", "r3val"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["\[Rho]InjSol", 
           RowBox[{
            RowBox[{"\[Rho]\[Nu]Total", "[", 
             RowBox[{
              RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
              RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
              RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}], "+", 
            RowBox[{"\[Rho]\[Gamma]", "[", "T\[Gamma]fin", "]"}], "+", 
            RowBox[{"\[Rho]e", "[", "T\[Gamma]fin", "]"}]}]], ",", 
          FractionBox["\[Rho]\[Nu]InjSol", "\[Rho]InjSol"], ",", 
          FractionBox["\[Rho]\[Nu]InjSol", 
           RowBox[{"\[Rho]\[Nu]Total", "[", 
            RowBox[{
             RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
             RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
             RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}]]}], "}"}], "/.",
         " ", "solUniverse"}], "/.", " ", 
       RowBox[{"t", "->", "tfinSim"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Starting", " ", "time", " ", 
        SubscriptBox["t", "0"], " ", "of", " ", 
        RowBox[{"Kensuke", "'"}], "s", " ", 
        RowBox[{"code", ".", " ", "Corresponds"}], " ", "to", " ", "starting",
         " ", "temperature", " ", "T"}], " ", "=", " ", 
       RowBox[{"5.1101533", " ", "MeV"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"t0", "=", 
      RowBox[{
       RowBox[{"InverseFunction", "[", 
        RowBox[{"T\[Gamma]", "/.", " ", "solUniverse"}], "]"}], "[", 
       "tempStart", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t0", "<", "tIniEM"}], ",", 
       RowBox[{"t0", "=", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"InverseFunction", "[", 
             RowBox[{"T\[Gamma]", "/.", " ", "solUniverse"}], "]"}], "[", 
            RowBox[{"1.003", "tempStart"}], "]"}], "+", 
           RowBox[{
            RowBox[{"InverseFunction", "[", 
             RowBox[{"T\[Gamma]", "/.", " ", "solUniverse"}], "]"}], "[", 
            RowBox[{"0.997", "tempStart"}], "]"}]}], ")"}], "2"]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"The", " ", "value", " ", "of", " ", 
        SubscriptBox["n", "LLP"], " ", "at", " ", "t"}], " ", "=", " ", 
       SubscriptBox["t", "0"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nLLPinput", "=", 
      FractionBox[
       RowBox[{"\[Rho]LLPscaling", "[", 
        RowBox[{"mllp", ",", "nLLPiniVal", ",", "\[Tau]llp", ",", 
         RowBox[{"aratiosol", "[", "t0", "]"}], ",", "t0", ",", "tIniEM"}], 
        "]"}], "mllp"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Compute", " ", "decay", " ", "probabilities"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "___", "___", "___", "___", "___", "___", "___", "___", "___", "__"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tEnd", "=", 
      RowBox[{"t0", "+", 
       RowBox[{"\[Tau]llp", "*", "lifetimeFactor"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"DecayOnly", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"decayProb", "[", 
            RowBox[{"particle", ",", "t_"}], "]"}], "=", "1."}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ProdProbChecker", "[", 
            RowBox[{"LLPsel", ",", "mllp", ",", "particle"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"decayProb", "[", 
              RowBox[{"particle", ",", "t_"}], "]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"channels", "[", "particle", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/", 
                   RowBox[{"Plus", "@@", 
                    RowBox[{"channels", "[", "particle", "]"}]}]}], ")"}], "/.",
                  " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"IfConversion", "->", "True"}], ",", 
                   RowBox[{"IfPionConversion", "->", "True"}], ",", 
                   RowBox[{"nB", "->", 
                    RowBox[{"nBn\[Gamma]", "[", 
                    RowBox[{"t", ",", "tfinSim"}], "]"}]}]}], "}"}]}], "/.", 
                " ", "solY"}], "/.", " ", 
               RowBox[{"T", "->", 
                RowBox[{"(", 
                 RowBox[{"T\[Gamma]sol", "[", "t", "]"}], ")"}]}]}], "/.", 
              " ", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"decayProb", "[", 
              RowBox[{"particle", ",", "t_"}], "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"t", "<", 
                RowBox[{"10.", "*", "\[Tau]llp"}]}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"decayProb", "[", 
                 RowBox[{"particle", ",", "t"}], "]"}], "]"}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"decayProb", "[", 
                 RowBox[{"particle", ",", 
                  RowBox[{"10", "*", "\[Tau]llp"}]}], "]"}], "]"}]}], "]"}]}],
             ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"decayProb", "[", 
             RowBox[{"particle", ",", "t_"}], "]"}], "=", "0."}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"particle", ",", "particles"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tpoints", "=", 
      RowBox[{"tpointsBlock", "[", 
       RowBox[{"npoints", ",", "t0", ",", "tEnd", ",", "T\[Gamma]sol"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Return", " ", "basic", " ", "info", " ", "about", " ", "the", " ", 
       "Universe", " ", "plus", " ", "tabulated", " ", "decay", " ", 
       "probabilities", " ", "of", " ", "the", " ", "selected", " ", 
       "particles", " ", "for", " ", "temperature", " ", "in", " ", "MeV"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mllp", ",", "\[Tau]llp", ",", "nLLPinput", ",", "Neff", ",", 
          "r1val", ",", "r2val", ",", "r3val", ",", "nto\[Mu]", ",", 
          "nto\[Pi]", ",", "ntoKp", ",", "ntoKL", ",", 
          RowBox[{"calcBaseInjectedEnergy", "[", 
           RowBox[{"LLPsel", ",", "mllp"}], "]"}]}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              SuperscriptBox["10", "3"], 
              RowBox[{"T\[Gamma]sol", "[", "t", "]"}]}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"decayProb", "[", 
                RowBox[{"particle", ",", "t"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"particle", ",", "particles"}], "}"}]}], "]"}]}], 
            "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tpoints"}], "}"}]}], "]"}]}], "}"}], "//", 
      "N"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mllp", ",", "\[Tau]llp", ",", "nLLPinput", ",", "Neff", ",", "r1val", 
        ",", "r2val", ",", "r3val", ",", "nto\[Mu]", ",", "nto\[Pi]", ",", 
        "ntoKp", ",", "ntoKL", ",", 
        RowBox[{"calcBaseInjectedEnergy", "[", 
         RowBox[{"LLPsel", ",", "mllp"}], "]"}]}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{
               SuperscriptBox["10", "3"], 
               RowBox[{"T\[Gamma]sol", "[", "t", "]"}]}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"decayProb", "[", 
                 RowBox[{"particle", ",", "t"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"particle", ",", "particles"}], "}"}]}], "]"}]}], 
             "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tpoints"}], "}"}]}], "]"}], "//", "N"}], ",", 
        "solY"}], "*)"}], 
      RowBox[{
       RowBox[{"\[Rho]\[Nu]Total", "[", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}], "/.", " ", 
       "solUniverse"}], ",", 
      RowBox[{"aratiosol", "[", "t", "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"particle", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"nSymbol", "[", "particle", "]"}], "[", "t", "]"}], 
           RowBox[{"(*", 
            RowBox[{"*", 
             RowBox[{"decayProb", "[", 
              RowBox[{"particle", ",", "t"}], "]"}]}], "*)"}], "/.", "solY"}],
           ",", 
          RowBox[{
           RowBox[{"decayProb", "[", 
            RowBox[{"particle", ",", "t"}], "]"}], "/.", "solY"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"particle", ",", "Yparticleslist"}], "}"}]}], "]"}], ",", 
      FractionBox[
       RowBox[{"nLLPiniVal", "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "t"}], "/", "\[Tau]llp"}], "]"}], "*", 
        RowBox[{"NtoY", "[", 
         RowBox[{
         "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
          "mllp"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"aratiosol", "[", "t", "]"}], "3"]]}], "}"}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.932399049921728*^9, 3.932399065536069*^9}, {
   3.932400544724181*^9, 3.932400547772519*^9}, {3.9324026891077294`*^9, 
   3.932402700909767*^9}, 3.932403339530456*^9, {3.932403667517183*^9, 
   3.9324036689374533`*^9}, {3.9324037055653667`*^9, 3.932403707955322*^9}, {
   3.9324039565071707`*^9, 3.9324039615015564`*^9}, 3.932404074174857*^9, {
   3.9324041142039533`*^9, 3.9324041151231527`*^9}, {3.932440163295169*^9, 
   3.932440163428543*^9}, {3.932440239344311*^9, 3.932440242621587*^9}, {
   3.932440515315896*^9, 3.9324405184487696`*^9}, {3.9324406536096306`*^9, 
   3.9324406867835655`*^9}, {3.9324435278345194`*^9, 3.932443529013465*^9}, {
   3.932701492556243*^9, 3.9327015212001653`*^9}, {3.9327018908633013`*^9, 
   3.932702050313018*^9}, {3.932702096701173*^9, 3.9327021176310267`*^9}, {
   3.9327022575076528`*^9, 3.932702284364539*^9}, {3.932702349499633*^9, 
   3.9327023520644817`*^9}, {3.9327024257687855`*^9, 3.932702450964466*^9}, {
   3.9327025343960533`*^9, 3.9327025918146906`*^9}, {3.9327027057592487`*^9, 
   3.9327027256233487`*^9}, {3.93270294318798*^9, 3.9327029503606415`*^9}, {
   3.9333931874368563`*^9, 3.93339320032166*^9}, {3.93339325354813*^9, 
   3.9333932537645836`*^9}, {3.9333994769509783`*^9, 3.933399484777135*^9}, {
   3.9334002599898767`*^9, 3.9334002617554665`*^9}, {3.9334022540452747`*^9, 
   3.933402255058715*^9}, {3.933402364036771*^9, 3.93340241537343*^9}, {
   3.9334025503348274`*^9, 3.9334025512737155`*^9}, {3.933404130197198*^9, 
   3.933404133630021*^9}, {3.9334042253030195`*^9, 3.9334042756613007`*^9}, {
   3.933404880875657*^9, 3.9334048836918173`*^9}, {3.9334050769442496`*^9, 
   3.933405079081748*^9}, {3.9334087189132223`*^9, 3.933408733469548*^9}, {
   3.933408878967409*^9, 3.933408913013657*^9}, {3.9334092338668933`*^9, 
   3.9334092340441537`*^9}, {3.933409571491311*^9, 3.9334095788601494`*^9}, {
   3.933409620425255*^9, 3.933409724058774*^9}, {3.933409966508602*^9, 
   3.9334099997247972`*^9}, {3.933410755402362*^9, 3.9334107565596466`*^9}, {
   3.9334118078564367`*^9, 3.9334118396451235`*^9}, {3.9334119029226093`*^9, 
   3.9334119344799223`*^9}, {3.9334120365468445`*^9, 
   3.9334120394442544`*^9}, {3.933412092547403*^9, 3.933412098797513*^9}, {
   3.933412378328266*^9, 3.9334123950645514`*^9}, {3.93341263357017*^9, 
   3.9334126358330245`*^9}, 3.933412671997513*^9, {3.933412716086337*^9, 
   3.933412743033447*^9}, {3.933413195944324*^9, 3.9334132003014765`*^9}, {
   3.9334159320044656`*^9, 3.933415978318062*^9}, {3.933416037687928*^9, 
   3.9334161867894754`*^9}, {3.933416362075487*^9, 3.9334164454841146`*^9}, {
   3.93343775638159*^9, 3.9334377786173053`*^9}, {3.9334379500355587`*^9, 
   3.9334380094172945`*^9}, {3.933438212236868*^9, 3.9334382257863836`*^9}, {
   3.933438304455264*^9, 3.9334383097063804`*^9}, {3.933440693539879*^9, 
   3.9334407077378836`*^9}, {3.933440758268195*^9, 3.933440761299272*^9}, {
   3.9334409425816746`*^9, 3.933440944960362*^9}, {3.933492158288764*^9, 
   3.9334921604648542`*^9}, {3.933492484534646*^9, 3.933492520776487*^9}, {
   3.9334928695237827`*^9, 3.933492877901033*^9}, {3.933495688756353*^9, 
   3.933495762736827*^9}, {3.933495829205348*^9, 3.933495830713957*^9}, {
   3.9334959745029287`*^9, 3.9334959785424523`*^9}, {3.933496170455338*^9, 
   3.933496178611306*^9}, {3.9334967027918363`*^9, 3.9334967225717144`*^9}, {
   3.933520909193248*^9, 3.933520913226881*^9}, {3.9335226274182825`*^9, 
   3.933522658815159*^9}, {3.933524820349973*^9, 3.9335248334715347`*^9}, {
   3.9335754678284335`*^9, 3.933575469734397*^9}, {3.9335822395537295`*^9, 
   3.933582245271036*^9}, {3.9335824056177835`*^9, 3.9335824327579703`*^9}, {
   3.9335834912657557`*^9, 3.933583493636445*^9}, {3.933583735745635*^9, 
   3.9335837393437276`*^9}, {3.9335842262685695`*^9, 3.933584252139838*^9}, {
   3.933609452187564*^9, 3.9336094538596*^9}, {3.9336098976415353`*^9, 
   3.933609901909788*^9}, {3.9336105525251694`*^9, 3.9336105563487463`*^9}, 
   3.93361059255319*^9, {3.933610692836256*^9, 3.9336106953074617`*^9}, {
   3.933610961847274*^9, 3.933610995752324*^9}, {3.9336113189345493`*^9, 
   3.9336113210843678`*^9}, {3.9336121994640293`*^9, 
   3.9336122047879367`*^9}, {3.9336124350654087`*^9, 
   3.9336124370089455`*^9}, {3.9336161489618063`*^9, 3.933616152222024*^9}, {
   3.933616280997383*^9, 3.9336162832731333`*^9}, {3.933651960456174*^9, 
   3.9336519625504613`*^9}, {3.933652010667381*^9, 3.933652031418085*^9}, {
   3.9336520645482035`*^9, 3.933652074592759*^9}, {3.9336521084823046`*^9, 
   3.9336521087225*^9}, {3.9336526973104863`*^9, 3.9336527374422364`*^9}, {
   3.9336528230364456`*^9, 3.93365288799088*^9}, {3.93365293968477*^9, 
   3.933653047253416*^9}, {3.933863794528204*^9, 3.9338638082796326`*^9}, {
   3.9338644758381023`*^9, 3.933864551841333*^9}, {3.9357294690746975`*^9, 
   3.9357294692196274`*^9}, {3.935729513859495*^9, 3.935729639588846*^9}, {
   3.935729697121769*^9, 3.935729767834181*^9}, {3.935729871585314*^9, 
   3.9357299999478073`*^9}, {3.935734030096805*^9, 3.9357340743376226`*^9}, {
   3.936245526552616*^9, 3.936245566419844*^9}, {3.936246560677432*^9, 
   3.936246598322054*^9}, {3.9362467027884474`*^9, 3.9362467149265747`*^9}, {
   3.9362468458360467`*^9, 3.9362468484273252`*^9}, {3.936246911756573*^9, 
   3.936246913561372*^9}, {3.9362474363290434`*^9, 3.9362474399906616`*^9}, {
   3.9362517009849644`*^9, 3.9362517016369305`*^9}, {3.9363415739763746`*^9, 
   3.936341587522415*^9}, {3.9363416901725073`*^9, 3.9363416923026686`*^9}, {
   3.93645736495257*^9, 3.9364573693552437`*^9}, {3.938664679599161*^9, 
   3.9386647870550632`*^9}, {3.938665694675148*^9, 3.9386656949538746`*^9}, {
   3.938668252698326*^9, 3.938668255593445*^9}, {3.9393551981385117`*^9, 
   3.9393552376290493`*^9}, {3.9393558451854324`*^9, 3.939355894764946*^9}, {
   3.93935608781925*^9, 3.9393560909521084`*^9}, {3.9393568658665047`*^9, 
   3.9393568781944466`*^9}, {3.939357402620947*^9, 3.939357402998024*^9}, {
   3.9393575086200256`*^9, 3.939357511967699*^9}, {3.9393584616510696`*^9, 
   3.9393585461762524`*^9}, {3.93937574027544*^9, 3.9393757455681973`*^9}, 
   3.9411203196371574`*^9},
 CellLabel->
  "In[337]:=",ExpressionUUID->"bf322a42-8908-43c3-b4b6-a9ea6dc0bcd6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"lifetimetest", "=", "40"}], ";", "\[IndentingNewLine]", 
   RowBox[{"masstest", "=", "0.23"}], ";", "\[IndentingNewLine]", 
   RowBox[{"out", "=", 
    RowBox[{"mergedFunction", "[", 
     RowBox[{"\"\<Scalar\>\"", ",", "masstest", ",", "lifetimetest", ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
        "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "}"}]}], 
     "]"}]}], ";", "\[IndentingNewLine]", 
   FractionBox[
    RowBox[{
     RowBox[{"calcBaseInjectedEnergy", "[", 
      RowBox[{"LLPsel", ",", "masstest"}], "]"}], "-", 
     RowBox[{
      RowBox[{"out", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], 
    RowBox[{"calcBaseInjectedEnergy", "[", 
     RowBox[{"LLPsel", ",", "masstest"}], "]"}]]}], "*)"}]], "Input",
 CellChangeTimes->{{3.933412693085471*^9, 3.9334127117631426`*^9}, {
  3.93341275331277*^9, 3.933412776651782*^9}, {3.9334128488201084`*^9, 
  3.933412871637126*^9}, {3.933412918334484*^9, 3.9334129282829676`*^9}, {
  3.9334130616051483`*^9, 3.933413163556127*^9}, {3.9334132998883467`*^9, 
  3.9334133011565714`*^9}, {3.9335265676977615`*^9, 3.9335266040218644`*^9}, {
  3.9336114981599827`*^9, 3.933611501585224*^9}, {3.933614746422615*^9, 
  3.933614748243039*^9}, {3.9336150649430475`*^9, 3.9336150671401806`*^9}, {
  3.9336151150588317`*^9, 3.933615132529916*^9}, {3.93361615706894*^9, 
  3.933616159122074*^9}, {3.9336162464706197`*^9, 3.9336162554067817`*^9}, {
  3.933616297539539*^9, 3.933616299687552*^9}, {3.933864641968734*^9, 
  3.9338646860346403`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"543f11e7-5937-4335-a5b8-68aa08a03ddb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"BlockTempNeff", "[", 
      RowBox[{"LLPsel_", ",", "mllp_", ",", "\[Tau]llp_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nLLPiniVal", "=", 
           RowBox[{"nLLPini", "[", 
            RowBox[{"LLPsel", ",", "mllp", ",", "\[Tau]llp"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Numbers", " ", "of", " ", "Ys", " ", "of", " ", "the", " ", 
            "given", " ", "charge", " ", "per", " ", 
            RowBox[{"X", "'"}], "s", " ", "decay"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ntoKp", ",", "ntoKL", ",", "nto\[Pi]", ",", "nto\[Mu]"}],
             "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"NtoY", "[", 
              RowBox[{
              "LLPsel", ",", "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", 
               ",", "mllp"}], "]"}], ",", 
             RowBox[{"NtoY", "[", 
              RowBox[{
              "LLPsel", ",", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", 
               ",", "mllp"}], "]"}], ",", 
             RowBox[{"NtoY", "[", 
              RowBox[{
              "LLPsel", ",", 
               "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
               "mllp"}], "]"}], ",", 
             RowBox[{"NtoY", "[", 
              RowBox[{
              "LLPsel", ",", 
               "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
               "mllp"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"calcBaseInjectedEnergy", "[", 
              RowBox[{"LLPsel", ",", "mllp"}], "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "Computing", " ", "the", " ", "evolution", " ", "of", " ", 
               "secondary", " ", "particles"}], " ", "-", " ", "solY"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"(*", 
                RowBox[{
                "solutionsThermodynamics", ",", "solUniverseApprox", ","}], 
                "*)"}], 
               RowBox[{"tIniEM", ",", "solY"}], "}"}], "=", 
              RowBox[{"BlockFullSystemNumberDens", "[", 
               RowBox[{
               "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", "1", ",", 
                "ntoKp", ",", "ntoKL", ",", "nto\[Pi]", ",", "nto\[Mu]", ",", 
                "True", ",", "True", ",", "True", ",", "True"}], "]"}]}], 
             ";"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"nKpsol", "[", "t_", "]"}], ",", 
                 RowBox[{"nKmsol", "[", "t_", "]"}], ",", 
                 RowBox[{"nKLsol", "[", "t_", "]"}], ",", 
                 RowBox[{"n\[Pi]psol", "[", "t_", "]"}], ",", 
                 RowBox[{"n\[Pi]msol", "[", "t_", "]"}], ",", 
                 RowBox[{"n\[Mu]psol", "[", "t_", "]"}], ",", 
                 RowBox[{"n\[Mu]msol", "[", "t_", "]"}], ",", 
                 RowBox[{"Xnsol", "[", "t_", "]"}]}], "}"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", "[", "t", "]"}], "/.", "sol"}], ")"}], "&"}], 
                "/@", 
                RowBox[{"{", 
                 RowBox[{
                 "nKplus", ",", "nKminus", ",", "nKL", ",", "n\[Pi]plus", ",",
                   "n\[Pi]minus", ",", "n\[Mu]plus", ",", "n\[Mu]minus", ",", 
                  "Xn"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Xnsol", "[", "t_", "]"}], "=", 
               RowBox[{"sc", "*", 
                RowBox[{"Xnsol", "[", "t", "]"}]}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"placeholder", ",", "tIniEM"}], "}"}], "=", 
              RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
               RowBox[{
               "mllp", ",", "\[Tau]llp", ",", "nLLPiniVal", ",", "1", ",", 
                "1000"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "solUniverse", ",", "\[Rho]\[Nu]InjSol", ",", "\[Rho]InjSol"}], 
            "}"}], "=", 
           RowBox[{"solveEvolutionCorrectedFull", "[", 
            RowBox[{"LLPsel", ",", "mllp", ",", "\[Tau]llp", ",", 
             RowBox[{"nLLPini", "[", 
              RowBox[{"LLPsel", ",", "mllp", ",", "\[Tau]llp"}], "]"}], ",", 
             "tIniEM", ",", 
             SuperscriptBox["10", "3"], ",", "solY"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"T\[Gamma]sol", "[", "t_", "]"}], "=", 
           RowBox[{
            RowBox[{"T\[Gamma]", "[", "t", "]"}], "/.", "solUniverse"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"T\[Gamma]fin", "=", 
           RowBox[{"T\[Gamma]sol", "[", "1000", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"aratiosol", "[", "t_", "]"}], "=", 
           RowBox[{
            RowBox[{"aRatio", "[", "t", "]"}], "/.", "solUniverse"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            SubscriptBox["N", "eff"], " ", "using", " ", "integrated", " ", 
            "Boltzmann", " ", "approach"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Neffv", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"NeffT", "[", 
              RowBox[{
               RowBox[{"T\[Gamma]sol", "[", "t", "]"}], ",", 
               RowBox[{"T\[Nu]e", "[", "t", "]"}], ",", 
               RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], ",", 
               RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}]}], "]"}], "/.", " ", 
             "solUniverse"}], "/.", " ", 
            RowBox[{"{", 
             RowBox[{"t", "->", "1000"}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", "Neffv"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", "datta"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"BlockTempNeff", "[", 
           RowBox[{"\"\<Scalar\>\"", ",", "0.6", ",", "#"}], "]"}]}], "}"}], 
        "&"}], "/@", 
       RowBox[{"Table", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0.5", ",", "1.", ",", "0.05"}], "}"}]}], 
        "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"datta", ",", 
      RowBox[{"Joined", "->", "True"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.936247469010044*^9, 3.9362474769133615`*^9}, {
  3.9362475084347258`*^9, 3.936247523912068*^9}, {3.936247567993565*^9, 
  3.9362477172956676`*^9}, {3.936247764071367*^9, 3.9362477642454405`*^9}, {
  3.936248292734818*^9, 3.936248293401274*^9}, {3.9362483561775465`*^9, 
  3.9362483566140337`*^9}, {3.936251539201292*^9, 3.9362515506015573`*^9}, {
  3.9362517043562346`*^9, 3.936251706510497*^9}, {3.9362522026704473`*^9, 
  3.936252204880947*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"b0e9b820-cce1-4502-9a2a-3d7d584789bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.9335833703389883`*^9, 
  3.933583370940607*^9}},ExpressionUUID->"744d48d7-bf1d-450b-8fd3-\
ba64845f3a93"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"massval", "=", "0.29"}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Tau]vals", "=", 
           RowBox[{"{", 
            RowBox[{
            "0.01", ",", "0.02", ",", "0.05", ",", "0.1", ",", "0.5", ",", 
             "1.", ",", "2.", ",", "3.", ",", "4.", ",", "5.", ",", "6.", ",",
              "7.", ",", "8.", ",", "9.", ",", "10.", ",", "11.", ",", "12.", 
             ",", "13.", ",", "14.", ",", "15.", ",", "20.", ",", "25.", ",", 
             "30.", ",", "35.", ",", "40.", ",", "45.", ",", "49."}], "}"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"attempt2", "=", 
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"mergedFunction", "[", 
              RowBox[{"\"\<Scalar\>\"", ",", "massval", ",", "\[Tau]", ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
                 "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Tau]", ",", "\[Tau]vals"}], "}"}]}], "]"}]}], ";"}], 
         "//", 
         RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "attempt1"}]}], "=", 
        RowBox[{
         RowBox[{"ResourceFunction", "[", "\"\<MonitorProgress\>\"", "]"}], 
         "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"mergedFunction", "[", 
            RowBox[{"\"\<Scalar\>\"", ",", "massval", ",", "\[Tau]", ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
               "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Tau]", ",", "\[Tau]vals"}], "}"}]}], "]"}]}]}], ";"}], 
      "//", 
      RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "attempt3"}]}], "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"mergedFunction", "[", 
        RowBox[{"\"\<Scalar\>\"", ",", "massval", ",", "\[Tau]", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
           "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Tau]", ",", "\[Tau]vals"}], "}"}]}], "]"}]}], ";"}], "//", 
   RowBox[{
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", "attempt1", "]"}]}], "==", 
    RowBox[{"Flatten", "[", "attempt2", "]"}], "==", 
    RowBox[{"Flatten", "[", "attempt3", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9335807888164325`*^9, 3.933580800674781*^9}, {
  3.933583374489254*^9, 3.933583389108755*^9}, {3.9336124277125854`*^9, 
  3.9336124300004897`*^9}, {3.933612840060754*^9, 3.933612841821943*^9}, {
  3.933613873301114*^9, 3.933613875516182*^9}, {3.933615705729065*^9, 
  3.933615707506342*^9}, {3.933616286552313*^9, 3.933616290180176*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"2debe3dc-5ffe-402f-ae7d-fb7f1003eafe"]
}, Open  ]]
},
WindowSize->{1142.1, 647.6999999999999},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.9 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"da6af6de-c7fc-45a0-b6bf-d58872747495"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 232, 4, 47, "Subsection",ExpressionUUID->"a9e6e547-f953-4b15-9ec4-4d899d4c06fd"],
Cell[815, 28, 25273, 573, 911, "Input",ExpressionUUID->"020dfa1f-688e-4c46-95fc-b7e1a6de2f05"],
Cell[CellGroupData[{
Cell[26113, 605, 157, 3, 39, "Subsubsection",ExpressionUUID->"bce501e5-40df-48bc-843a-8ba42c64210a"],
Cell[26273, 610, 20842, 503, 984, "Input",ExpressionUUID->"0e23c780-74dc-4da4-8d5b-f0bee7d70793"],
Cell[CellGroupData[{
Cell[47140, 1117, 150, 3, 27, "Item",ExpressionUUID->"4acf1eeb-8c80-4fb7-9838-5e8ab22ea2d8"],
Cell[47293, 1122, 19833, 464, 1151, "Input",ExpressionUUID->"30687c51-a89c-48d7-8422-290c81947f61"],
Cell[CellGroupData[{
Cell[67151, 1590, 2380, 57, 145, "Input",ExpressionUUID->"e487b458-66d9-47a3-9de9-f35307c2c9aa"],
Cell[69534, 1649, 760, 14, 29, "Output",ExpressionUUID->"9364cfd2-7c13-4aff-8146-2b49c3d61caa"],
Cell[70297, 1665, 442, 7, 28, "Output",ExpressionUUID->"7a903104-c386-4e4e-a9ff-75db152267b6"],
Cell[70742, 1674, 445, 7, 28, "Output",ExpressionUUID->"89176fc1-fc70-4219-8a66-ebb2a15796ae"],
Cell[71190, 1683, 759, 15, 23, "Message",ExpressionUUID->"bb665822-3e46-417e-984a-bbe896788aef"],
Cell[71952, 1700, 501, 9, 28, "Output",ExpressionUUID->"e4f1bdcb-3902-497a-bfae-324ac08c729e"],
Cell[72456, 1711, 428, 7, 28, "Output",ExpressionUUID->"84208737-9f43-492a-a9d9-300c4122976d"],
Cell[72887, 1720, 565, 12, 28, "Output",ExpressionUUID->"b6dc588e-6afd-49e6-8c35-50bac5827b89"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73525, 1740, 208, 4, 47, "Subsection",ExpressionUUID->"4c5c758c-b209-4ee3-bfcb-a3dce11aa931"],
Cell[73736, 1746, 31646, 692, 1610, "Input",ExpressionUUID->"bf322a42-8908-43c3-b4b6-a9ea6dc0bcd6"],
Cell[105385, 2440, 1745, 34, 84, "Input",ExpressionUUID->"543f11e7-5937-4335-a5b8-68aa08a03ddb"],
Cell[107133, 2476, 7744, 177, 424, "Input",ExpressionUUID->"b0e9b820-cce1-4502-9a2a-3d7d584789bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114914, 2658, 154, 3, 47, "Subsection",ExpressionUUID->"744d48d7-bf1d-450b-8fd3-ba64845f3a93"],
Cell[115071, 2663, 3245, 71, 111, "Input",ExpressionUUID->"2debe3dc-5ffe-402f-ae7d-fb7f1003eafe"]
}, Open  ]]
}
]
*)

