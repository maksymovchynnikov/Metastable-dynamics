(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68597,       1635]
NotebookOptionsPosition[     66007,       1581]
NotebookOutlinePosition[     66450,       1598]
CellTagsIndexPosition[     66407,       1595]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Preliminary definitions", "Section",
 CellChangeTimes->{{3.9323940046111393`*^9, 
  3.932394007430573*^9}},ExpressionUUID->"19033bb1-cc71-4ac1-b20f-\
a9886091d9b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sc", "=", 
    RowBox[{"10", "^", "15."}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Associations", " ", "of", " ", "the", " ", "symbolic", " ", "br", " ", 
    "ratio", " ", "of", " ", "X", " ", "decay", " ", "into", " ", "Y", " ", 
    "with", " ", "the", " ", "symbol", " ", "of", " ", "Y"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "BrList", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", "]"}], 
   "=", 
   RowBox[{
    RowBox[{
    "BrList", "[", "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", "]"}], 
    "=", "BrTo\[Pi]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "BrList", "[", "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", "]"}], "=", 
   RowBox[{
    RowBox[{
    "BrList", "[", "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", "]"}], "=",
     "BrToKCharged"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BrList", "[", "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", "]"}],
    "=", "BrToKLong"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "BrList", "[", "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", "]"}], 
   "=", 
   RowBox[{
    RowBox[{
    "BrList", "[", "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", "]"}], 
    "=", "BrTo\[Mu]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932394016156061*^9, 3.932394035911256*^9}, {
  3.933400006031247*^9, 3.9334000263202286`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"79d5ce58-1f73-41d9-8ff7-4bedf05fc0e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Source terms y->Y", "Section",
 CellChangeTimes->{{3.93239399136647*^9, 3.932393992913509*^9}, {
  3.932394892954914*^9, 
  3.9323948957065725`*^9}},ExpressionUUID->"780c528f-59b3-416a-95db-\
1fe3fc696007"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"K", "==", "part"}], "||", 
          RowBox[{
           RowBox[{"ap", "[", "K", "]"}], "==", "part"}]}], ")"}]}], "&&", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"mass", "[", "K", "]"}], "-", 
           RowBox[{"mass", "[", "part", "]"}]}], "<", "0.02"}], ")"}]}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Decay", " ", 
        RowBox[{"terms", ":", " ", 
         RowBox[{
          FractionBox[
           SubscriptBox["n", "y"], 
           SubscriptBox["\[Tau]", "y"]], "*", 
          SubscriptBox["N", 
           RowBox[{"y", "->", "Y"}]]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SourceTerms", "[", 
         RowBox[{"K", ",", "part", ",", "\"\<Decays\>\""}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"BrList", "[", "K", "]"}], "!=", "0."}], "&&", "IfDecays",
            "&&", 
           RowBox[{
            RowBox[{"NperDecay", "[", 
             RowBox[{"K", ",", "part"}], "]"}], "!=", "0."}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"nSymbol", "[", "K", "]"}], "[", "t", "]"}], 
             RowBox[{"lifetime", "[", "K", "]"}]], "*", 
            RowBox[{"NperDecay", "[", 
             RowBox[{"K", ",", "part"}], "]"}]}], "]"}], ",", "0."}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Annihilation", " ", 
         RowBox[{"terms", ":", " ", 
          RowBox[{
           RowBox[{
            SubscriptBox["n", "y"], 
            SubscriptBox["n", 
             OverscriptBox["y", "_"]]}], "<", "\[Sigma]v", 
           SubscriptBox[">", 
            RowBox[{"ann", ",", 
             RowBox[{"y", "->", "Y"}]}]]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SourceTerms", "[", 
         RowBox[{"K", ",", "part", ",", "\"\<Annihilation\>\""}], "]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"BrList", "[", "K", "]"}], "!=", "0."}], "&&", 
           "IfAnnihilation"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nSymbol", "[", "K", "]"}], "[", "t", "]"}], "*", 
            RowBox[{
             RowBox[{"nSymbol", "[", 
              RowBox[{"ap", "[", "K", "]"}], "]"}], "[", "t", "]"}], "*", 
            FractionBox[
             RowBox[{"\[Sigma]vAnn", "[", 
              RowBox[{"K", ",", "part"}], "]"}], "GeVtosm1"]}], "]"}], ",", 
          "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Terms", " ", "from", " ", "interactions", " ", "with", " ", 
         RowBox[{"nucleons", ":", " ", 
          RowBox[{
           RowBox[{
            SubscriptBox["n", "p"], 
            SubscriptBox["n", "y"]}], "<", "\[Sigma]v", 
           SubscriptBox[">", 
            RowBox[{"py", "->", "X"}]], 
           RowBox[{
            SubscriptBox["N", 
             RowBox[{"py", "->", "Y"}]], " ", "+", " ", 
            RowBox[{
             SubscriptBox["n", "n"], 
             SubscriptBox["n", "y"]}]}], "<", "\[Sigma]v", 
           SubscriptBox[">", 
            RowBox[{"ny", "->", "X"}]], 
           SubscriptBox["N", 
            RowBox[{"ny", "->", "Y"}]]}]}]}], "*)"}], "\n", 
       RowBox[{
        RowBox[{"SourceTerms", "[", 
         RowBox[{
         "K", ",", "part", ",", "\"\<Nucleon\>\"", ",", "nB_", ",", "T_"}], 
         "]"}], "=", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"BrList", "[", "K", "]"}], "!=", "0."}], "&&", 
            "IfConversion", "&&", 
            RowBox[{
             RowBox[{"\[Sigma]vNuclTot", "[", 
              RowBox[{"K", ",", "\"\<n\>\"", ",", 
               SuperscriptBox["10", 
                RowBox[{"-", "3."}]]}], "]"}], "!=", "0."}], "&&", 
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
                 "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\""}], "}"}], 
               ",", "part"}], "]"}]}]}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"sc", "*", 
              RowBox[{"Xn", "[", "t", "]"}], "*", "nB", "*", 
              RowBox[{
               RowBox[{"nSymbol", "[", "K", "]"}], "[", "t", "]"}], "*", 
              FractionBox[
               RowBox[{"\[Sigma]vNuclTot", "[", 
                RowBox[{"K", ",", "\"\<n\>\"", ",", "T"}], "]"}], "GeVtosm1"],
               "*", 
              RowBox[{"Fraction\[Pi]fromKnucl", "[", 
               RowBox[{"K", ",", "\"\<n\>\"", ",", "part"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"sc", "*", 
                 RowBox[{"Xn", "[", "t", "]"}]}]}], ")"}], "*", "nB", "*", 
              RowBox[{
               RowBox[{"nSymbol", "[", "K", "]"}], "[", "t", "]"}], "*", 
              FractionBox[
               RowBox[{"\[Sigma]vNuclTot", "[", 
                RowBox[{"K", ",", "\"\<p\>\"", ",", "T"}], "]"}], "GeVtosm1"],
               "*", 
              RowBox[{"Fraction\[Pi]fromKnucl", "[", 
               RowBox[{"K", ",", "\"\<p\>\"", ",", "part"}], "]"}]}]}], "]"}],
            ",", "0."}], "]"}], "//", "Expand"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SourceTerms", "[", 
        RowBox[{"K", ",", "part", ",", "\"\<Decays\>\""}], "]"}], "=", 
       RowBox[{
        RowBox[{"SourceTerms", "[", 
         RowBox[{"K", ",", "part", ",", "\"\<Annihilation\>\""}], "]"}], "=", 
        RowBox[{
         RowBox[{"SourceTerms", "[", 
          RowBox[{
          "K", ",", "part", ",", "\"\<Nucleon\>\"", ",", "nB_", ",", "T_"}], 
          "]"}], "=", "0."}]}]}]}], "\[IndentingNewLine]", "]"}], "\n", ",", 
    RowBox[{"{", 
     RowBox[{"K", ",", "Yparticleslist"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"part", ",", "Yparticleslist"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.9323939988938613`*^9, 3.932394011980742*^9}, {
  3.9323940491275964`*^9, 3.9323940844346995`*^9}, {3.9323944454842663`*^9, 
  3.9323946191841044`*^9}, {3.9323946729885097`*^9, 3.9323947393470564`*^9}, {
  3.9323947810239506`*^9, 3.932394833904948*^9}, {3.9323959933901663`*^9, 
  3.932395994641714*^9}, {3.9323961985584297`*^9, 3.9323962107717113`*^9}, {
  3.932396245818819*^9, 3.9323962656701756`*^9}, {3.9323963059253483`*^9, 
  3.9323963194948673`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f80c785e-bb81-4a32-a382-2b4805fa6210"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full evolution", "Section",
 CellChangeTimes->{{3.932394921022342*^9, 3.9323949247731*^9}, {
  3.9323949940097685`*^9, 
  3.932394994144603*^9}},ExpressionUUID->"ec295286-2e2c-4765-95ae-\
b24abda4c0ef"],

Cell[CellGroupData[{

Cell["dn/dt", "Subsection",
 CellChangeTimes->{{3.93239500089176*^9, 
  3.9323950015565863`*^9}},ExpressionUUID->"5df57b98-17cd-4f6e-af27-\
42df278ffcc3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Evolution", " ", "of", " ", "the", " ", "species", " ", "due", " ", "to", 
    " ", "the", " ", "interactions", " ", "with", " ", "nucleons"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{"Do", "[", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dndt", "[", 
        RowBox[{"part", ",", "\"\<Nucleon\>\""}], "]"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\""}], "}"}], ",", 
           "part"}], "]"}], ",", "0.", ",", 
         RowBox[{"If", "[", 
          RowBox[{"IfConversion", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               RowBox[{"nSymbol", "[", "part", "]"}], "[", "t", "]"}]}], "*", 
             "nB", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"sc", "*", 
                   RowBox[{"Xn", "[", "t", "]"}]}]}], ")"}], "*", 
                RowBox[{
                 RowBox[{"\[Sigma]vNuclTot", "[", 
                  RowBox[{"part", ",", "\"\<p\>\"", ",", "T"}], "]"}], "/", 
                 "GeVtosm1"}]}], "+", 
               RowBox[{"sc", "*", 
                RowBox[{"Xn", "[", "t", "]"}], "*", 
                RowBox[{
                 RowBox[{"\[Sigma]vNuclTot", "[", 
                  RowBox[{"part", ",", "\"\<n\>\"", ",", "T"}], "]"}], "/", 
                 "GeVtosm1"}]}]}], ")"}]}], "]"}], ",", "0."}], "]"}]}], 
        "]"}]}], ";"}], "\n", ",", 
     RowBox[{"{", 
      RowBox[{"part", ",", "Yparticleslist"}], "}"}]}], "\n", "]"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Total", " ", "evolution"}], "*)"}], "\n", 
   RowBox[{"Do", "[", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dndt", "[", 
       RowBox[{"part", ",", "\"\<All\>\""}], "]"}], "=", 
      RowBox[{
       RowBox[{
        FractionBox["nX", "\[Tau]X"], " ", 
        RowBox[{"BrList", "[", "part", "]"}]}], "-", 
       RowBox[{"If", "[", 
        RowBox[{"IfDecays", ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"nSymbol", "[", "part", "]"}], "[", "t", "]"}], "/", 
           RowBox[{"lifetime", "[", "part", "]"}]}], "]"}], ",", "0."}], 
        "]"}], "-", 
       RowBox[{"If", "[", 
        RowBox[{"IfAnnihilation", ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"nSymbol", "[", "part", "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"nSymbol", "[", 
             RowBox[{"ap", "[", "part", "]"}], "]"}], "[", "t", "]"}], "*", 
           RowBox[{
            RowBox[{"\[Sigma]vAnnTot", "[", 
             RowBox[{"part", ",", "T"}], "]"}], "/", "GeVtosm1"}]}], "]"}], 
         ",", "0."}], "]"}], "+", 
       RowBox[{"dndt", "[", 
        RowBox[{"part", ",", "\"\<Nucleon\>\""}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SourceTerms", "[", 
           RowBox[{"pt", ",", "part", ",", "\"\<Decays\>\""}], "]"}], "+", 
          RowBox[{"SourceTerms", "[", 
           RowBox[{
           "pt", ",", "part", ",", "\"\<Nucleon\>\"", ",", "nB", ",", "T"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"pt", ",", "Yparticleslist"}], "}"}]}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"SourceTerms", "[", 
          RowBox[{"ptmother", ",", "part", ",", "\"\<Annihilation\>\""}], 
          "]"}], "\n", ",", 
         RowBox[{"{", 
          RowBox[{"ptmother", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\""}], "}"}]}], 
          "}"}]}], "]"}]}]}], "\n", ",", 
     RowBox[{"{", 
      RowBox[{"part", ",", "Yparticleslist"}], "}"}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{"Checker1", "[", "quantity_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"quantity", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"BrToKCharged", "->", "1"}], ",", 
           RowBox[{"BrTo\[Pi]", "->", "1"}], ",", 
           RowBox[{"BrToKLong", "->", "1"}], ",", 
           RowBox[{"T", "->", "3"}], ",", 
           RowBox[{
            RowBox[{"a_", "[", "t_", "]"}], ":>", "1."}], ",", 
           RowBox[{"IfDecays", "->", "True"}], ",", 
           RowBox[{"IfAnnihilation", "->", "True"}], ",", 
           RowBox[{"IfConversion", "->", "True"}], ",", 
           RowBox[{"nB", "->", "1"}], ",", 
           RowBox[{"nX", "->", "1"}], ",", 
           RowBox[{"\[Tau]X", "->", "1"}]}], "}"}]}], ")"}], "!=", "0."}], 
      ",", "True", ",", "False"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"rowpt", "[", 
     RowBox[{"mother_", ",", "daughter_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Checker1", "[", 
       RowBox[{"SourceTerms", "[", 
        RowBox[{"mother", ",", "daughter", ",", "\"\<Decays\>\""}], "]"}], 
       "]"}], ",", 
      RowBox[{"Checker1", "[", 
       RowBox[{"SourceTerms", "[", 
        RowBox[{
        "mother", ",", "daughter", ",", "\"\<Nucleon\>\"", ",", "nB", ",", 
         "T"}], "]"}], "]"}], ",", 
      RowBox[{"Checker1", "[", 
       RowBox[{"SourceTerms", "[", 
        RowBox[{"mother", ",", "daughter", ",", "\"\<Annihilation\>\""}], 
        "]"}], "]"}]}], "}"}]}], "\n", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Mother particle\>\"", ",", "\"\<Daughter particle\>\"", ",", 
        "\"\<Decays\>\"", ",", "\"\<Nucleon\>\"", ",", 
        "\"\<Annihilations\>\""}], "}"}], "}"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"mother", ",", "daughter"}], "}"}], ",", 
           RowBox[{"rowpt", "[", 
            RowBox[{"mother", ",", "daughter"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"mother", ",", "Yparticleslist"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"daughter", ",", "Yparticleslist"}], "}"}]}], "]"}], ",", 
       "1"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.932394929194868*^9, 3.93239495718983*^9}, {
  3.933403766870751*^9, 3.9334037706162043`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"60e2fd00-93c8-4439-8fb8-c7a34b3b2406"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Mother particle\"\>", "\<\"Daughter particle\"\>", \
"\<\"Decays\"\>", "\<\"Nucleon\"\>", "\<\"Annihilations\"\>"},
     {"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "True", "False", 
      "False"},
     {"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "True", "False", 
      "False"},
     {"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "True", "True", 
      "True"},
     {"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "True", "True", 
      "True"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "True", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "True", "True", 
      "True"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "True", "True", 
      "True"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "False", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "True", "False", 
      "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "True", "False", 
      "True"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", \
"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "True", "False", 
      "True"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "True", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SubscriptBox[\\(K\\), \\(L\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(K\\), \\(+\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Mu]\\), \\(+\\)]\\)\"\>", "True", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(-\\)]\\)\"\>", "False", "False", "False"},
     {"\<\"\\!\\(\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "\<\"\\!\\(\
\\*SuperscriptBox[\\(\[Pi]\\), \\(+\\)]\\)\"\>", "False", "False", "False"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.932394964389574*^9, 3.932396004671378*^9, 
  3.9334135736761293`*^9},
 CellLabel->
  "Out[306]=",ExpressionUUID->"9fd972ea-365d-4872-9275-4f89b3fb4c27"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["System of equations", "Subsection",
 CellChangeTimes->{{3.9323950076600437`*^9, 
  3.9323950122391877`*^9}},ExpressionUUID->"5524ff4d-3417-493f-bbe3-\
61ccfe856a47"],

Cell[CellGroupData[{

Cell["Separate species", "Subsubsection",
 CellChangeTimes->{{3.9323950350399437`*^9, 
  3.9323950372168136`*^9}},ExpressionUUID->"4e1e2fe3-93e4-466f-8205-\
0273a4da3570"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Final", " ", "equations"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EqsK", "[", 
      RowBox[{
      "BrToKCharged_", ",", "BrToKLong_", ",", "H_", ",", "T_", ",", "nX_", 
       ",", "\[Tau]X_", ",", "nB_", ",", "IfDecays_", ",", "IfConversion_", 
       ",", "IfAnnihilation_", ",", "tIni_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrToKCharged", "!=", "0."}], "||", 
        RowBox[{"BrToKLong", "!=", "0."}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nKminus", "'"}], "[", "t", "]"}], "+", 
            RowBox[{"3", "*", "H", "*", 
             RowBox[{"nKminus", "[", "t", "]"}]}]}], "==", 
           RowBox[{"dndt", "[", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
             "\"\<All\>\""}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nKplus", "'"}], "[", "t", "]"}], "+", 
            RowBox[{"3", "*", "H", "*", 
             RowBox[{"nKplus", "[", "t", "]"}]}]}], "==", 
           RowBox[{"dndt", "[", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\)\>\"", ",", 
             "\"\<All\>\""}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nKL", "'"}], "[", "t", "]"}], "+", 
            RowBox[{"3", "*", "H", "*", 
             RowBox[{"nKL", "[", "t", "]"}]}]}], "==", 
           RowBox[{"dndt", "[", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
             "\"\<All\>\""}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"nKminus", "[", "tIni", "]"}], "==", "0."}], ",", 
          RowBox[{
           RowBox[{"nKplus", "[", "tIni", "]"}], "==", "0."}], ",", 
          RowBox[{
           RowBox[{"nKL", "[", "tIni", "]"}], "==", "0."}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Eqs\[Pi]", "[", 
      RowBox[{
      "BrTo\[Pi]_", ",", "BrToKCharged_", ",", "BrToKLong_", ",", "H_", ",", 
       "T_", ",", "nX_", ",", "\[Tau]X_", ",", "nB_", ",", "IfDecays_", ",", 
       "IfConversion_", ",", "IfPionConversion_", ",", "IfAnnihilation_", ",",
        "tIni_"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrTo\[Pi]", "!=", "0."}], "||", 
        RowBox[{"BrToKCharged", "!=", "0."}], "||", 
        RowBox[{"BrToKLong", "!=", "0."}]}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"n\[Pi]minus", "'"}], "[", "t", "]"}], "+", 
            RowBox[{"3", "*", "H", "*", 
             RowBox[{"n\[Pi]minus", "[", "t", "]"}]}]}], "==", 
           RowBox[{"dndt", "[", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
             "\"\<All\>\""}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"n\[Pi]plus", "'"}], "[", "t", "]"}], "+", 
            RowBox[{"3", "*", "H", "*", 
             RowBox[{"n\[Pi]plus", "[", "t", "]"}]}]}], "==", 
           RowBox[{"dndt", "[", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
             "\"\<All\>\""}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"n\[Pi]plus", "[", "tIni", "]"}], "==", "0."}], ",", 
          RowBox[{
           RowBox[{"n\[Pi]minus", "[", "tIni", "]"}], "==", "0."}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Eqs\[Mu]", "[", 
      RowBox[{
      "BrTo\[Pi]_", ",", "BrToKCharged_", ",", "BrToKLong_", ",", 
       "BrTo\[Mu]_", ",", "H_", ",", "T_", ",", "nX_", ",", "\[Tau]X_", ",", 
       "IfDecays_", ",", "IfAnnihilation_", ",", "tIni_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"n\[Mu]minus", "'"}], "[", "t", "]"}], "+", 
         RowBox[{"3", "*", "H", "*", 
          RowBox[{"n\[Mu]minus", "[", "t", "]"}]}]}], "==", 
        RowBox[{"dndt", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\)\>\"", ",", 
          "\"\<All\>\""}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"n\[Mu]plus", "'"}], "[", "t", "]"}], "+", 
         RowBox[{"3", "*", "H", "*", 
          RowBox[{"n\[Mu]plus", "[", "t", "]"}]}]}], "==", 
        RowBox[{"dndt", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
          "\"\<All\>\""}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"n\[Mu]plus", "[", "tIni", "]"}], "==", "0."}], ",", 
       RowBox[{
        RowBox[{"n\[Mu]minus", "[", "tIni", "]"}], "==", "0."}]}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"For", " ", "electrons"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Eqse", "[", 
      RowBox[{
      "BrTo\[Pi]_", ",", "BrToKCharged_", ",", "BrToKLong_", ",", "H_", ",", 
       "T_", ",", "nX_", ",", "\[Tau]X_", ",", "IfDecays_", ",", 
       "IfAnnihilation_", ",", "tIni_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"neplus", "'"}], "[", "t", "]"}], "+", 
         RowBox[{"3", "H", "*", 
          RowBox[{"neplus", "[", "t", "]"}]}]}], "==", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"IfDecays", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"BrList", "[", "pt", "]"}], "!=", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"NperDecay", "[", 
                   RowBox[{
                   "pt", ",", 
                    "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\""}], "]"}], "!=",
                   "0."}]}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"nSymbol", "[", "pt", "]"}], "[", "t", "]"}], 
                   RowBox[{"lifetime", "[", "pt", "]"}]], "*", 
                  RowBox[{"NperDecay", "[", 
                   RowBox[{
                   "pt", ",", 
                    "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\""}], "]"}]}],
                  "]"}], ",", "0."}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"pt", ",", "Yparticleslist"}], "}"}]}], "]"}], "]"}], 
           ",", "0."}], "]"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{"IfAnnihilation", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"n\[Mu]plus", "[", "t", "]"}], "*", 
             RowBox[{"n\[Mu]minus", "[", "t", "]"}], "*", 
             FractionBox[
              RowBox[{"\[Sigma]vAnn", "[", 
               RowBox[{
               "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
                "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\""}], "]"}], 
              "GeVtosm1"]}], "]"}], ",", "0."}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"neminus", "'"}], "[", "t", "]"}], "+", 
         RowBox[{"3", "H", "*", 
          RowBox[{"neminus", "[", "t", "]"}]}]}], "==", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"IfDecays", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"BrList", "[", "pt", "]"}], "!=", "0."}], "&&", 
                 RowBox[{
                  RowBox[{"NperDecay", "[", 
                   RowBox[{
                   "pt", ",", 
                    "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\""}], "]"}], "!=",
                   "0."}]}], ",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"nSymbol", "[", "pt", "]"}], "[", "t", "]"}], 
                   RowBox[{"lifetime", "[", "pt", "]"}]], "*", " ", 
                  RowBox[{"NperDecay", "[", 
                   RowBox[{
                   "pt", ",", 
                    "\"\<\!\(\*SuperscriptBox[\(e\), \(-\)]\)\>\""}], "]"}]}],
                  "]"}], ",", "0."}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"pt", ",", "Yparticleslist"}], "}"}]}], "]"}], "]"}], 
           ",", "0."}], "]"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{"IfAnnihilation", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"n\[Mu]plus", "[", "t", "]"}], "*", 
             RowBox[{"n\[Mu]minus", "[", "t", "]"}], "*", 
             FractionBox[
              RowBox[{"\[Sigma]vAnn", "[", 
               RowBox[{
               "\"\<\!\(\*SuperscriptBox[\(\[Mu]\), \(+\)]\)\>\"", ",", 
                "\"\<\!\(\*SuperscriptBox[\(e\), \(+\)]\)\>\""}], "]"}], 
              "GeVtosm1"]}], "]"}], ",", "0."}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{"neplus", "[", "tIni", "]"}], "==", "0."}], ",", 
       RowBox[{
        RowBox[{"neminus", "[", "tIni", "]"}], "==", "0."}]}], "}"}]}], ";"}],
    "\n", 
   RowBox[{"(*", 
    RowBox[{"For", " ", 
     SubscriptBox["X", "n"]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"field", "=", "\"\<\!\(\*SubscriptBox[\(X\), \(n\)]\)\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"dndt", "[", 
      RowBox[{"field", ",", "\"\<All\>\""}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{"IfConversion", ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"sc", "*", 
             RowBox[{"Xn", "[", "t", "]"}]}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BrToKCharged", "!=", "0."}], "||", 
               RowBox[{"BrToKLong", "!=", "0."}]}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"nKminus", "[", "t", "]"}], "*", 
                 FractionBox[
                  RowBox[{"\[Sigma]vConv", "[", 
                   RowBox[{
                   "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
                    "\"\<p->n\>\"", ",", "T"}], "]"}], "GeVtosm1"]}], "+", 
                RowBox[{
                 RowBox[{"nKL", "[", "t", "]"}], "*", 
                 FractionBox[
                  RowBox[{"\[Sigma]vConv", "[", 
                   RowBox[{
                   "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                    "\"\<p->n\>\"", ",", "T"}], "]"}], "GeVtosm1"]}]}], "]"}],
               ",", "0."}], "]"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"BrToKCharged", "!=", "0."}], "||", 
                 RowBox[{"BrToKLong", "!=", "0."}], "||", 
                 RowBox[{"BrTo\[Pi]", "!=", "0."}]}], ")"}], "&&", 
               "IfPionConversion"}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{
                RowBox[{"n\[Pi]minus", "[", "t", "]"}], "*", 
                FractionBox[
                 RowBox[{"\[Sigma]vConv", "[", 
                  RowBox[{
                  "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(-\)]\)\>\"", ",", 
                   "\"\<p->n\>\"", ",", "T"}], "]"}], "GeVtosm1"]}], "]"}], 
              ",", "0."}], "]"}]}], ")"}]}], "-", 
         RowBox[{"sc", "*", 
          RowBox[{"Xn", "[", "t", "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BrToKCharged", "!=", "0."}], "||", 
               RowBox[{"BrToKLong", "!=", "0."}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"nKminus", "[", "t", "]"}], "*", 
                FractionBox[
                 RowBox[{"\[Sigma]vConv", "[", 
                  RowBox[{
                  "\"\<\!\(\*SuperscriptBox[\(K\), \(-\)]\)\>\"", ",", 
                   "\"\<n->p\>\"", ",", "T"}], "]"}], "GeVtosm1"]}], "+", 
               RowBox[{
                RowBox[{"nKL", "[", "t", "]"}], 
                FractionBox[
                 RowBox[{"\[Sigma]vConv", "[", 
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(K\), \(L\)]\)\>\"", ",", 
                   "\"\<n->p\>\"", ",", "T"}], "]"}], "GeVtosm1"]}]}], ",", 
              "0."}], "]"}], "+", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"BrToKCharged", "!=", "0."}], "||", 
                 RowBox[{"BrToKLong", "!=", "0."}], "||", 
                 RowBox[{"BrTo\[Pi]", "!=", "0."}]}], ")"}], "&&", 
               "IfPionConversion"}], ",", 
              RowBox[{
               RowBox[{"n\[Pi]plus", "[", "t", "]"}], "*", 
               FractionBox[
                RowBox[{"\[Sigma]vConv", "[", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(\[Pi]\), \(+\)]\)\>\"", ",", 
                  "\"\<n->p\>\"", ",", "T"}], "]"}], "GeVtosm1"]}], ",", 
              "0."}], "]"}]}], ")"}]}]}], "]"}], ",", "0."}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"dndt", "[", 
      RowBox[{"\"\<p\>\"", ",", "\"\<All\>\""}], "]"}], "=", 
     RowBox[{
      RowBox[{"-", "nB"}], "*", 
      RowBox[{"dndt", "[", 
       RowBox[{"field", ",", "\"\<All\>\""}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"dndt", "[", 
      RowBox[{"\"\<n\>\"", ",", "\"\<All\>\""}], "]"}], "=", 
     RowBox[{"nB", "*", 
      RowBox[{"dndt", "[", 
       RowBox[{"field", ",", "\"\<All\>\""}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"EqsXn", "[", 
      RowBox[{
      "BrTo\[Pi]_", ",", "BrToKCharged_", ",", "BrToKLong_", ",", "T_", ",", 
       "nX_", ",", "\[Tau]X_", ",", "IfConversion_", ",", "IfPionConversion_",
        ",", "tIni_"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"sc", "*", 
         RowBox[{
          RowBox[{"Xn", "'"}], "[", "t", "]"}]}], "==", 
        RowBox[{"dndt", "[", 
         RowBox[{"field", ",", "\"\<All\>\""}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Xn", "[", "tIni", "]"}], "==", 
        FractionBox["0.5", "sc"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Symbolic", " ", "rates", " ", "to", " ", "decay"}], ",", " ", 
     "annihilate", ",", " ", 
     RowBox[{"or", " ", "interact", " ", "with", " ", "nucleons"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"channels", "[", "particle", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"nSymbol", "[", "particle", "]"}], "[", "t", "]"}], 
          RowBox[{"lifetime", "[", "particle", "]"}]], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"nSymbol", "[", "particle", "]"}], "[", "t", "]"}], "*", 
          RowBox[{
           RowBox[{"nSymbol", "[", 
            RowBox[{"ap", "[", "particle", "]"}], "]"}], "[", "t", "]"}], "*", 
          FractionBox[
           RowBox[{"\[Sigma]vAnnTot", "[", 
            RowBox[{"particle", ",", "T"}], "]"}], "GeVtosm1"]}], ",", 
         RowBox[{"-", 
          RowBox[{"dndt", "[", 
           RowBox[{"particle", ",", "\"\<Nucleon\>\""}], "]"}]}]}], "}"}]}], 
      ";"}], "\n", ",", 
     RowBox[{"{", 
      RowBox[{"particle", ",", 
       RowBox[{"Select", "[", 
        RowBox[{"Yparticleslist", ",", 
         RowBox[{
          RowBox[{"#", "!=", "\"\<\!\(\*SubscriptBox[\(K\), \(S\)]\)\>\""}], 
          "&"}]}], "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.932395041315915*^9, 3.9323952004732246`*^9}, {
  3.9323957550295057`*^9, 3.9323958235819006`*^9}, {3.932400009004982*^9, 
  3.9324000134677944`*^9}, {3.933409038325878*^9, 3.9334090651615534`*^9}, {
  3.9334369728772573`*^9, 3.933437013529627*^9}, {3.933437079678769*^9, 
  3.9334370861176915`*^9}, {3.9335765892134557`*^9, 3.9335765894416924`*^9}, {
  3.933577895510973*^9, 3.9335778974202323`*^9}, {3.933578488070037*^9, 
  3.9335784924545965`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"9eba7412-cca0-4209-9ba6-4a0aafa1f9f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["All species", "Subsubsection",
 CellChangeTimes->{{3.9323952269082975`*^9, 
  3.9323952300270257`*^9}},ExpressionUUID->"e6f85759-7eeb-47ee-9dd4-\
e9af4e042f8d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EqsTotal", "[", 
    RowBox[{
    "H_", ",", "T_", ",", "nX_", ",", "\[Tau]X_", ",", "nB_", ",", 
     "BrToKCharged_", ",", "BrToKLong_", ",", "BrTo\[Pi]_", ",", "BrTo\[Mu]_",
      ",", "IfDecays_", ",", "IfConversion_", ",", "IfPionConversion_", ",", 
     "IfAnnihilation_", ",", "tIni_"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"EqsK", "[", 
      RowBox[{
      "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", ",", "nX", ",", 
       "\[Tau]X", ",", "nB", ",", "IfDecays", ",", "IfConversion", ",", 
       "IfAnnihilation", ",", "tIni"}], "]"}], ",", 
     RowBox[{"Eqs\[Pi]", "[", 
      RowBox[{
      "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", 
       ",", "nX", ",", "\[Tau]X", ",", "nB", ",", "IfDecays", ",", 
       "IfConversion", ",", "IfPionConversion", ",", "IfAnnihilation", ",", 
       "tIni"}], "]"}], ",", 
     RowBox[{"Eqs\[Mu]", "[", 
      RowBox[{
      "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "BrTo\[Mu]", 
       ",", "H", ",", "T", ",", "nX", ",", "\[Tau]X", ",", "IfDecays", ",", 
       "IfAnnihilation", ",", "tIni"}], "]"}], ",", 
     RowBox[{"EqsXn", "[", 
      RowBox[{
      "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "T", ",", "nX",
        ",", "\[Tau]X", ",", "IfConversion", ",", "IfPionConversion", ",", 
       "tIni"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"variables", "[", 
   RowBox[{
   "BrToKCharged_", ",", "BrToKLong_", ",", "BrTo\[Pi]_", ",", "BrTo\[Mu]_"}],
    "]"}], "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrToKCharged", "!=", "0."}], "||", 
       RowBox[{"BrToKLong", "!=", "0."}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nKL", "[", "t", "]"}], ",", 
        RowBox[{"nKplus", "[", "t", "]"}], ",", 
        RowBox[{"nKminus", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrToKCharged", "!=", "0."}], "||", 
       RowBox[{"BrToKLong", "!=", "0."}], "||", 
       RowBox[{"BrTo\[Pi]", "!=", "0."}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n\[Pi]plus", "[", "t", "]"}], ",", 
        RowBox[{"n\[Pi]minus", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n\[Mu]plus", "[", "t", "]"}], ",", 
      RowBox[{"n\[Mu]minus", "[", "t", "]"}], ",", 
      RowBox[{"Xn", "[", "t", "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EqsTotalElectrons", "[", 
    RowBox[{
    "H_", ",", "T_", ",", "nX_", ",", "\[Tau]X_", ",", "nB_", ",", 
     "BrToKCharged_", ",", "BrToKLong_", ",", "BrTo\[Pi]_", ",", "BrTo\[Mu]_",
      ",", "IfDecays_", ",", "IfConversion_", ",", "IfPionConversion_", ",", 
     "IfAnnihilation_", ",", "tIni_"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"EqsK", "[", 
      RowBox[{
      "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", ",", "nX", ",", 
       "\[Tau]X", ",", "nB", ",", "IfDecays", ",", "IfConversion", ",", 
       "IfAnnihilation", ",", "tIni"}], "]"}], ",", 
     RowBox[{"Eqs\[Pi]", "[", 
      RowBox[{
      "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", 
       ",", "nX", ",", "\[Tau]X", ",", "nB", ",", "IfDecays", ",", 
       "IfConversion", ",", "IfPionConversion", ",", "IfAnnihilation", ",", 
       "tIni"}], "]"}], ",", 
     RowBox[{"Eqs\[Mu]", "[", 
      RowBox[{
      "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", 
       ",", "nX", ",", "\[Tau]X", ",", "IfDecays", ",", "IfAnnihilation", ",",
        "tIni"}], "]"}], ",", 
     RowBox[{"EqsXn", "[", 
      RowBox[{
      "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "T", ",", "nX",
        ",", "\[Tau]X", ",", "IfConversion", ",", "IfPionConversion", ",", 
       "tIni"}], "]"}], ",", 
     RowBox[{"Eqse", "[", 
      RowBox[{
      "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", 
       ",", "nX", ",", "\[Tau]X", ",", "IfDecays", ",", "IfAnnihilation", ",",
        "tIni"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"variablesElectrons", "[", 
    RowBox[{
    "BrToKCharged_", ",", "BrToKLong_", ",", "BrTo\[Pi]_", ",", 
     "BrTo\[Mu]_"}], "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrToKCharged", "!=", "0."}], "||", 
        RowBox[{"BrToKLong", "!=", "0."}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nKL", "[", "t", "]"}], ",", 
         RowBox[{"nKplus", "[", "t", "]"}], ",", 
         RowBox[{"nKminus", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BrToKCharged", "!=", "0."}], "||", 
        RowBox[{"BrToKLong", "!=", "0."}], "||", 
        RowBox[{"BrTo\[Pi]", "!=", "0."}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n\[Pi]plus", "[", "t", "]"}], ",", 
         RowBox[{"n\[Pi]minus", "[", "t", "]"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n\[Mu]plus", "[", "t", "]"}], ",", 
       RowBox[{"n\[Mu]minus", "[", "t", "]"}], ",", 
       RowBox[{"neplus", "[", "t", "]"}], ",", 
       RowBox[{"neminus", "[", "t", "]"}], ",", 
       RowBox[{"Xn", "[", "t", "]"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9333991197571697`*^9, 3.933399128416066*^9}, {
  3.9333991852167425`*^9, 3.933399193573511*^9}, {3.9334135369978714`*^9, 
  3.9334135440776577`*^9}, {3.9334138819180293`*^9, 3.93341390159881*^9}, {
  3.9334370388224034`*^9, 3.9334370635552535`*^9}, {3.9335784776746283`*^9, 
  3.933578480003395*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"969d27f6-94d2-4fe6-9511-fe47648029d0"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"If\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"Eqs\[Mu]\\\", TraditionalForm]\\) at positions \
\\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"3\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 94, 26, 17649218553963392569, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{{3.933413882948412*^9, 3.933413901865984*^9}, 
   3.9334352137796965`*^9, 3.9334371071972938`*^9, 3.9334371526032143`*^9, 
   3.9334371973247623`*^9, 3.9334376807888064`*^9, 3.9335767744110765`*^9, {
   3.933578500361743*^9, 3.933578525586031*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"ea99e5b1-0d15-450c-8b7a-00a28876f7f9"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"If\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"List\\\", TraditionalForm]\\) at positions \
\\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"3\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 95, 27, 17649218553963392569, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{{3.933413882948412*^9, 3.933413901865984*^9}, 
   3.9334352137796965`*^9, 3.9334371071972938`*^9, 3.9334371526032143`*^9, 
   3.9334371973247623`*^9, 3.9334376807888064`*^9, 3.9335767744110765`*^9, {
   3.933578500361743*^9, 3.9335785255970297`*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"66741d6b-7d36-4894-9674-aadc819db3af"],

Cell[BoxData[
 FormBox[
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrToKCharged", "\[NotEqual]", "0.`"}], "\[Or]", 
       RowBox[{"BrToKLong", "\[NotEqual]", "0.`"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nKL", "(", "t", ")"}], ",", 
        RowBox[{"nKplus", "(", "t", ")"}], ",", 
        RowBox[{"nKminus", "(", "t", ")"}]}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"BrToKCharged", "\[NotEqual]", "0.`"}], "\[Or]", 
       RowBox[{"BrToKLong", "\[NotEqual]", "0.`"}], "\[Or]", 
       RowBox[{"BrTo\[Pi]", "\[NotEqual]", "0.`"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n\[Pi]plus", "(", "t", ")"}], ",", 
        RowBox[{"n\[Pi]minus", "(", "t", ")"}]}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n\[Mu]plus", "(", "t", ")"}], ",", 
      RowBox[{"n\[Mu]minus", "(", "t", ")"}], ",", 
      RowBox[{"Xn", "(", "t", ")"}]}], "}"}]}], "]"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.933413882966141*^9, 3.9334139018863897`*^9}, 
   3.9334352138040204`*^9, 3.9334371072185893`*^9, 3.933437152628003*^9, 
   3.9334371973466597`*^9, 3.933437680812788*^9, 3.9335767744335775`*^9, {
   3.9335785003847556`*^9, 3.933578525609132*^9}},
 CellLabel->"Out[95]=",ExpressionUUID->"02ca2380-ea12-4f09-b12d-22a4acc92463"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"If\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"List\\\", TraditionalForm]\\) at positions \
\\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"3\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 96, 28, 17649218553963392569, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{{3.933413882948412*^9, 3.933413901865984*^9}, 
   3.9334352137796965`*^9, 3.9334371071972938`*^9, 3.9334371526032143`*^9, 
   3.9334371973247623`*^9, 3.9334376807888064`*^9, 3.9335767744110765`*^9, {
   3.933578500361743*^9, 3.933578525615032*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"43d63c00-e8ef-416d-9aa9-0ffc6ceadc89"],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "Join", "heads", 
    "\"Heads \\!\\(\\*FormBox[\\\"If\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"List\\\", TraditionalForm]\\) at positions \
\\!\\(\\*FormBox[\\\"1\\\", TraditionalForm]\\) and \
\\!\\(\\*FormBox[\\\"3\\\", TraditionalForm]\\) are expected to be the \
same.\"", 2, 97, 29, 17649218553963392569, "Local"},
   "MessageTemplate"], TraditionalForm]], "Message", "MSG",
 CellChangeTimes->{{3.933413882948412*^9, 3.933413901865984*^9}, 
   3.9334352137796965`*^9, 3.9334371071972938`*^9, 3.9334371526032143`*^9, 
   3.9334371973247623`*^9, 3.9334376807888064`*^9, 3.9335767744110765`*^9, {
   3.933578500361743*^9, 3.9335785256230307`*^9}},
 CellLabel->
  "During evaluation of \
In[94]:=",ExpressionUUID->"30746cf7-bb70-44ac-b387-ec6007a67322"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solver", "Subsection",
 CellChangeTimes->{{3.932395237762931*^9, 
  3.9323952384080124`*^9}},ExpressionUUID->"a59b9a9a-c0dc-425e-804a-\
aaa68bdff315"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockFullSystemNumberDens", "[", 
   RowBox[{
   "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "\[Xi]EM_", ",", 
    "BrToKCharged_", ",", "BrToKLong_", ",", "BrTo\[Pi]_", ",", "BrTo\[Mu]_", 
    ",", "IfDecays_", ",", "IfConversion_", ",", "IfPionConversion_", ",", 
    "IfAnnihilation_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eqs", ",", "vars", ",", "tIniEM", ",", "nXt", ",", "tT", ",", "Tt", ",",
       "aRatiot", ",", "aRatioT", ",", "\[Eta]Bt", ",", "\[Eta]BT", ",", "Ht",
       ",", "HT", ",", "T\[Nu]et", ",", "T\[Nu]eT", ",", "T\[Nu]\[Mu]t", ",", 
      "T\[Nu]\[Mu]T", ",", "T\[Nu]\[Tau]t", ",", "T\[Nu]\[Tau]T", ",", 
      "solutionsThermodynamicsApprox", ",", "nBt", ",", "solUniverse", ",", 
      "solYs", ",", "eqslist"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "Defining", " ", "the", " ", "approximate", " ", "dynamics", " ", "of", 
       " ", "the", " ", "Universe"}], " ", "-", " ", 
      RowBox[{"if", " ", "assuming", " ", "some", " ", "random", " ", 
       SubscriptBox["\[Xi]", 
        RowBox[{"inj", ",", "EM"}]]}]}], "*)"}], 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"solutionsThermodynamicsApprox", ",", "tIniEM"}], "}"}], "=", 
      RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
       RowBox[{
       "mX", ",", "\[Tau]X", ",", "nXini", ",", "\[Xi]EM", ",", "tmaxsol"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"nXt", "[", "t_", "]"}], ",", 
        RowBox[{"tT", "[", "T_", "]"}], ",", 
        RowBox[{"Tt", "[", "t_", "]"}], ",", 
        RowBox[{"aRatiot", "[", "t_", "]"}], ",", 
        RowBox[{"aRatioT", "[", "T_", "]"}], ",", 
        RowBox[{"\[Eta]Bt", "[", "t_", "]"}], ",", 
        RowBox[{"\[Eta]BT", "[", "T_", "]"}], ",", 
        RowBox[{"Ht", "[", "t_", "]"}], ",", 
        RowBox[{"HT", "[", "T_", "]"}], ",", 
        RowBox[{"T\[Nu]et", "[", "t_", "]"}], ",", 
        RowBox[{"T\[Nu]eT", "[", "T_", "]"}], ",", 
        RowBox[{"T\[Nu]\[Mu]t", "[", "t_", "]"}], ",", 
        RowBox[{"T\[Nu]\[Mu]T", "[", "T_", "]"}], ",", 
        RowBox[{"T\[Nu]\[Tau]t", "[", "t_", "]"}], ",", 
        RowBox[{"T\[Nu]\[Tau]T", "[", "T_", "]"}]}], "}"}], "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"solutionsThermodynamicsApprox", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "solutionsThermodynamicsApprox", "]"}], ",", 
          "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Subset", " ", "of", " ", "solutions"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"solUniverse", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"aRatio", "[", "t", "]"}], "->", 
         RowBox[{"aRatiot", "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{"T\[Gamma]", "[", "t", "]"}], "->", 
         RowBox[{"Tt", "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "->", 
         RowBox[{"T\[Nu]et", "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "->", 
         RowBox[{"T\[Nu]\[Mu]t", "[", "t", "]"}]}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "->", 
         RowBox[{"T\[Nu]\[Tau]t", "[", "t", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nBt", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"n\[Gamma]", "[", 
        RowBox[{"Tt", "[", "t", "]"}], "]"}], "*", 
       RowBox[{"\[Eta]Bt", "[", "t", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "[", "t_", "]"}], "=", 
      RowBox[{"variables", "[", 
       RowBox[{
       "BrToKCharged", ",", "BrToKLong", ",", "BrTo\[Pi]", ",", "BrTo\[Mu]"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "IfConversion"}], ",", 
       RowBox[{
        RowBox[{"vars", "[", "t_", "]"}], "=", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"vars", "[", "t", "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Defining", " ", "the", " ", "ODEs"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eqslist", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EqsK", "[", 
            RowBox[{
            "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", ",", "nX", 
             ",", "\[Tau]X", ",", "nB", ",", "IfDecays", ",", "IfConversion", 
             ",", "IfAnnihilation", ",", "tIni"}], "]"}], ",", 
           RowBox[{"Eqs\[Pi]", "[", 
            RowBox[{
            "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "H", ",",
              "T", ",", "nX", ",", "\[Tau]X", ",", "nB", ",", "IfDecays", ",",
              "IfConversion", ",", "IfPionConversion", ",", "IfAnnihilation", 
             ",", "tIni"}], "]"}], ",", 
           RowBox[{"Eqs\[Mu]", "[", 
            RowBox[{
            "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", 
             "BrTo\[Mu]", ",", "H", ",", "T", ",", "nX", ",", "\[Tau]X", ",", 
             "IfDecays", ",", "IfAnnihilation", ",", "tIni"}], "]"}], ",", 
           RowBox[{"EqsXn", "[", 
            RowBox[{
            "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "T", ",",
              "nX", ",", "\[Tau]X", ",", "IfConversion", ",", 
             "IfPionConversion", ",", "tIni"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tIni", "->", "tIniEM"}], ",", 
           RowBox[{"H", "->", 
            RowBox[{"Ht", "[", "t", "]"}]}], ",", 
           RowBox[{"T", "->", 
            RowBox[{"Tt", "[", "t", "]"}]}], ",", 
           RowBox[{"nX", "->", 
            RowBox[{"nXt", "[", "t", "]"}]}], ",", 
           RowBox[{"nB", "->", 
            RowBox[{"nBt", "[", "t", "]"}]}]}], "}"}]}]}], ";"}], 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"eqslist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EqsK", "[", 
          RowBox[{
          "BrToKCharged", ",", "BrToKLong", ",", "H", ",", "T", ",", "nX", 
           ",", "\[Tau]X", ",", "nB", ",", "IfDecays", ",", "IfConversion", 
           ",", "IfAnnihilation", ",", "tIni"}], "]"}], ",", 
         RowBox[{"Eqs\[Pi]", "[", 
          RowBox[{
          "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "H", ",", 
           "T", ",", "nX", ",", "\[Tau]X", ",", "nB", ",", "IfDecays", ",", 
           "IfConversion", ",", "IfPionConversion", ",", "IfAnnihilation", 
           ",", "tIni"}], "]"}], ",", 
         RowBox[{"Eqs\[Mu]", "[", 
          RowBox[{
          "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", 
           "BrTo\[Mu]", ",", "H", ",", "T", ",", "nX", ",", "\[Tau]X", ",", 
           "IfDecays", ",", "IfAnnihilation", ",", "tIni"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"IfConversion", ",", 
           RowBox[{"EqsXn", "[", 
            RowBox[{
            "BrTo\[Pi]", ",", "BrToKCharged", ",", "BrToKLong", ",", "T", ",",
              "nX", ",", "\[Tau]X", ",", "IfConversion", ",", 
             "IfPionConversion", ",", "tIni"}], "]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tIni", "->", "tIniEM"}], ",", 
         RowBox[{"H", "->", 
          RowBox[{"Ht", "[", "t", "]"}]}], ",", 
         RowBox[{"T", "->", 
          RowBox[{"Tt", "[", "t", "]"}]}], ",", 
         RowBox[{"nX", "->", 
          RowBox[{"nXt", "[", "t", "]"}]}], ",", 
         RowBox[{"nB", "->", 
          RowBox[{"nBt", "[", "t", "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eqs", "[", "t_", "]"}], "=", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"EqsTotal", "[", 
         RowBox[{
          RowBox[{"Ht", "[", "t", "]"}], ",", 
          RowBox[{"Tt", "[", "t", "]"}], ",", 
          RowBox[{"nXt", "[", "t", "]"}], ",", "\[Tau]X", ",", 
          RowBox[{"nBt", "[", "t", "]"}], ",", "BrToKCharged", ",", 
          "BrToKLong", ",", "BrTo\[Pi]", ",", "BrTo\[Mu]", ",", "IfDecays", 
          ",", "IfConversion", ",", "IfPionConversion", ",", "IfAnnihilation",
           ",", "tIniEM"}], "]"}], ";"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", "##", "]"}], "&"}], "@@", "eqslist"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solYs", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{
           RowBox[{"eqs", "[", "t", "]"}], ",", "0."}], "]"}], ",", 
         RowBox[{"vars", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tIniEM", ",", 
           RowBox[{"10", "*", "\[Tau]X"}]}], "}"}], ",", 
         RowBox[{"MaxSteps", "->", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"!", "IfConversion"}], "&&", 
             RowBox[{"!", "IfPionConversion"}], "&&", 
             RowBox[{"!", "IfAnnihilation"}]}], ",", "100000", ",", "60000"}],
            "]"}]}], ",", 
         RowBox[{"WorkingPrecision", "->", "50"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"solutionsThermodynamicsApprox", ","}], "*)"}], 
      RowBox[{"solUniverse", ",", "tIniEM", ",", "solYs"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9334344771429043`*^9, 3.933434482481264*^9}, {
   3.9334345225293856`*^9, 3.9334345235563354`*^9}, {3.933434792449378*^9, 
   3.9334348048752975`*^9}, {3.9334348607408905`*^9, 3.933434880103924*^9}, {
   3.933434976600037*^9, 3.9334350411711845`*^9}, {3.933435074433759*^9, 
   3.933435161785021*^9}, {3.9334356165497837`*^9, 3.9334356199139533`*^9}, {
   3.933435651458558*^9, 3.933435699957575*^9}, {3.933435762757449*^9, 
   3.933435764769476*^9}, {3.9334364764575877`*^9, 3.9334364854250264`*^9}, 
   3.9334365189360046`*^9, {3.9334366359178324`*^9, 3.9334366362014294`*^9}, {
   3.9334366767771835`*^9, 3.933436744277175*^9}, {3.933437122756384*^9, 
   3.933437124193289*^9}, {3.933437629455145*^9, 3.9334376296022744`*^9}, 
   3.9334379073069663`*^9, {3.9334912487905974`*^9, 3.933491249348156*^9}, {
   3.9335228671536417`*^9, 3.93352286721375*^9}, {3.933525340963069*^9, 
   3.9335253411893053`*^9}, {3.933576414160603*^9, 3.933576417771186*^9}, {
   3.9335764570416517`*^9, 3.9335765062855225`*^9}, {3.933576780289748*^9, 
   3.933576798828576*^9}, {3.933576862067167*^9, 3.9335768636162643`*^9}, {
   3.9335783505511622`*^9, 3.9335784125818768`*^9}, {3.9335785064234014`*^9, 
   3.9335785078418365`*^9}, {3.9335785488588285`*^9, 3.933578556602108*^9}, {
   3.933579016184799*^9, 3.9335790272741194`*^9}, {3.933579061632045*^9, 
   3.9335790731911936`*^9}, {3.9335791134178567`*^9, 3.933579113683391*^9}, {
   3.9336102141887207`*^9, 3.9336102556551113`*^9}, {3.9336102897128134`*^9, 
   3.9336102941189966`*^9}, {3.9336105430026355`*^9, 
   3.9336105456326895`*^9}, {3.933611374031803*^9, 3.933611378537629*^9}, {
   3.9336518991167593`*^9, 3.933651903121003*^9}, {3.9336519703030663`*^9, 
   3.933651972484186*^9}, {3.93645734209382*^9, 3.936457344294252*^9}, {
   3.938666615160055*^9, 3.9386666854533577`*^9}, {3.9386667433116894`*^9, 
   3.9386667436405735`*^9}, 3.9386670654094906`*^9, {3.9386672359700947`*^9, 
   3.9386673110195255`*^9}, {3.9386673762410336`*^9, 
   3.9386673789704475`*^9}, {3.938667461608694*^9, 3.9386674698042545`*^9}, {
   3.93866782008486*^9, 3.9386678242693596`*^9}, {3.938668005025484*^9, 
   3.938668005441412*^9}, {3.9386680967560844`*^9, 3.938668190546276*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"a8377481-9513-4207-94ef-115b99657ac3"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1142.1, 647.6999999999999},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"047a88d5-65c9-4ba2-bab6-4708af3dd062"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 170, 3, 52, "Section",ExpressionUUID->"19033bb1-cc71-4ac1-b20f-a9886091d9b2"],
Cell[753, 27, 1487, 42, 99, "Input",ExpressionUUID->"79d5ce58-1f73-41d9-8ff7-4bedf05fc0e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[2277, 74, 212, 4, 42, "Section",ExpressionUUID->"780c528f-59b3-416a-95db-1fe3fc696007"],
Cell[2492, 80, 7109, 175, 348, "Input",ExpressionUUID->"f80c785e-bb81-4a32-a382-2b4805fa6210"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9638, 260, 208, 4, 52, "Section",ExpressionUUID->"ec295286-2e2c-4765-95ae-b24abda4c0ef"],
Cell[CellGroupData[{
Cell[9871, 268, 154, 3, 42, "Subsection",ExpressionUUID->"5df57b98-17cd-4f6e-af27-42df278ffcc3"],
Cell[CellGroupData[{
Cell[10050, 275, 6963, 178, 326, "Input",ExpressionUUID->"60e2fd00-93c8-4439-8fb8-c7a34b3b2406"],
Cell[17016, 455, 8288, 136, 690, "Output",ExpressionUUID->"9fd972ea-365d-4872-9275-4f89b3fb4c27"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25353, 597, 171, 3, 42, "Subsection",ExpressionUUID->"5524ff4d-3417-493f-bbe3-61ccfe856a47"],
Cell[CellGroupData[{
Cell[25549, 604, 171, 3, 35, "Subsubsection",ExpressionUUID->"4e1e2fe3-93e4-466f-8205-0273a4da3570"],
Cell[25723, 609, 16978, 431, 694, "Input",ExpressionUUID->"9eba7412-cca0-4209-9ba6-4a0aafa1f9f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42738, 1045, 166, 3, 35, "Subsubsection",ExpressionUUID->"e6f85759-7eeb-47ee-9dd4-e9af4e042f8d"],
Cell[CellGroupData[{
Cell[42929, 1052, 5978, 144, 235, "Input",ExpressionUUID->"969d27f6-94d2-4fe6-9511-fe47648029d0"],
Cell[48910, 1198, 811, 16, 20, "Message",ExpressionUUID->"ea99e5b1-0d15-450c-8b7a-00a28876f7f9"],
Cell[49724, 1216, 809, 16, 20, "Message",ExpressionUUID->"66741d6b-7d36-4894-9674-aadc819db3af"],
Cell[50536, 1234, 1470, 36, 25, "Output",ExpressionUUID->"02ca2380-ea12-4f09-b12d-22a4acc92463"],
Cell[52009, 1272, 807, 16, 20, "Message",ExpressionUUID->"43d63c00-e8ef-416d-9aa9-0ffc6ceadc89"],
Cell[52819, 1290, 809, 16, 20, "Message",ExpressionUUID->"30746cf7-bb70-44ac-b387-ec6007a67322"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53689, 1313, 156, 3, 42, "Subsection",ExpressionUUID->"a59b9a9a-c0dc-425e-804a-aaa68bdff315"],
Cell[53848, 1318, 12131, 259, 404, "Input",ExpressionUUID->"a8377481-9513-4207-94ef-115b99657ac3"]
}, Open  ]]
}, Open  ]]
}
]
*)

