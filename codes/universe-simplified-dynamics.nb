(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     82200,       2027]
NotebookOptionsPosition[     80039,       1979]
NotebookOutlinePosition[     80470,       1996]
CellTagsIndexPosition[     80427,       1993]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Universe dynamics", "Chapter",
 CellChangeTimes->{{3.945403201529461*^9, 
  3.945403203463188*^9}},ExpressionUUID->"4099c155-d500-7c44-b155-\
6bc728d0629d"],

Cell[CellGroupData[{

Cell[TextData[{
 "Neutrino, photon temperatures ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", 
    RowBox[{"\[Nu]", ",", "\[Gamma]"}]], TraditionalForm]],ExpressionUUID->
  "743c005a-b255-4ba7-91f6-81289c66de2d"],
 " and scale factor ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "618a150b-c658-489e-a821-6bba13960bd2"],
 " dynamics"
}], "Section",
 CellChangeTimes->{{3.806688281162406*^9, 3.806688305663799*^9}, {
   3.807443863407928*^9, 3.807443883209685*^9}, 
   3.927685141177395*^9},ExpressionUUID->"e4fc562b-fb8e-48f7-9dbd-\
fb20e16b1089"],

Cell[CellGroupData[{

Cell["Importing data", "Subsection",
 CellChangeTimes->{{3.933403223762822*^9, 
  3.933403225449123*^9}},ExpressionUUID->"8ecb60c3-f59b-4781-8d22-\
8dc75bc4227e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Load", " ", "the", " ", "corrections", " ", "to", " ", "the", " ", 
     "rates", " ", "as", " ", "a", " ", "result", " ", "of", " ", "a", " ", 
     "non"}], "-", 
    RowBox[{"negligible", " ", "electron", " ", "mass"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FacMeVtos1", "=", 
     FractionBox["1", 
      RowBox[{"6.58212", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "16"}]], "*", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "6"}]]}]]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "geL", ",", "geR", ",", "g\[Mu]L", ",", "g\[Mu]R", ",", "fann\[Nu]e", 
      ",", "fsca\[Nu]e", ",", "fann\[Nu]\[Mu]", ",", "fsca\[Nu]\[Mu]", ",", 
      "fscan\[Nu]e", ",", "fscan\[Nu]\[Mu]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<SM_Rates/nue_ann.dat\>\"", ",", "\"\<Table\>\"", ",", 
       RowBox[{"HeaderLines", "\[Rule]", " ", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fann\[Nu]e", "=", 
     RowBox[{"Interpolation", "[", "data", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<SM_Rates/nue_scatt.dat\>\"", ",", "\"\<Table\>\"", ",", 
       RowBox[{"HeaderLines", "\[Rule]", " ", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fsca\[Nu]e", "=", 
     RowBox[{"Interpolation", "[", "data", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<SM_Rates/numu_ann.dat\>\"", ",", "\"\<Table\>\"", ",", 
       RowBox[{"HeaderLines", "\[Rule]", " ", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fann\[Nu]\[Mu]", "=", 
     RowBox[{"Interpolation", "[", "data", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<SM_Rates/numu_scatt.dat\>\"", ",", "\"\<Table\>\"", ",", 
       RowBox[{"HeaderLines", "\[Rule]", " ", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fsca\[Nu]\[Mu]", "=", 
     RowBox[{"Interpolation", "[", "data", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<SM_Rates/sigmav_nue.dat\>\"", ",", "\"\<Table\>\"", ",", 
       RowBox[{"HeaderLines", "\[Rule]", " ", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fscan\[Nu]e", "=", 
     RowBox[{"Interpolation", "[", "data", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<SM_Rates/sigmav_numu.dat\>\"", ",", "\"\<Table\>\"", ",", 
       RowBox[{"HeaderLines", "\[Rule]", " ", "1"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fscan\[Nu]\[Mu]", "=", 
     RowBox[{"Interpolation", "[", "data", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Uncomment", " ", "if", " ", "one", " ", "wants", " ", "to", " ", 
      "consider", " ", "me"}], " ", "=", " ", 
     RowBox[{"0", " ", "in", " ", "the", " ", "rates"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{
      "fann\[Nu]e", ",", "fsca\[Nu]e", ",", "fann\[Nu]\[Mu]", ",", 
       "fsca\[Nu]\[Mu]", ",", "fscan\[Nu]e", ",", "fscan\[Nu]\[Mu]"}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fann\[Nu]e", "[", "x_", "]"}], ":=", "1"}], ";", 
      RowBox[{
       RowBox[{"fsca\[Nu]e", "[", "x_", "]"}], ":=", "1"}], ";", 
      RowBox[{
       RowBox[{"fann\[Nu]\[Mu]", "[", "x_", "]"}], ":=", "1"}], ";", 
      RowBox[{
       RowBox[{"fsca\[Nu]\[Mu]", "[", "x_", "]"}], ":=", "1"}], ";", 
      RowBox[{
       RowBox[{"fscan\[Nu]e", "[", "x_", "]"}], ":=", "1"}], ";", 
      RowBox[{
       RowBox[{"fscan\[Nu]\[Mu]", "[", "x_", "]"}], ":=", "1"}], ";"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Spin", "-", 
     RowBox[{
     "Statistics", " ", "Corrections", " ", "to", " ", "the", " ", "MB", " ", 
      "interaction", " ", 
      RowBox[{"rates", ".", " ", "Set"}], " ", "to", " ", "1", " ", "for", 
      " ", "the", " ", "MB", " ", "case"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"faFD", " ", "=", " ", "0.884"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fsFD", " ", "=", " ", "0.829"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fnFD", " ", "=", " ", "0.852"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Low", " ", "energy", " ", "couplings", " ", "desciribin", " ", "NC", " ",
      "and", " ", "CC", " ", "interactions", " ", "of", " ", "neutrinos", " ",
      "and", " ", "electrons"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "See", " ", "Table", " ", "10.3", " ", "of", " ", "the", " ", "EW", " ", 
     "review", " ", "of", " ", "the", " ", "PDG", " ", "and", " ", "Table", 
     " ", "6", " ", "of", " ", "1303.5522"}], "  ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"geL", "=", "0.727"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"geR", "=", "0.233"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g\[Mu]L", "=", 
     RowBox[{"-", "0.273"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g\[Mu]R", "=", "0.233"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Func", "[", 
      RowBox[{"T1_", ",", "T2_", ",", "\[Mu]1_", ",", "\[Mu]2_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"32", " ", "*", "faFD", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"2", " ", 
            FractionBox["\[Mu]1", "T1"]}], "]"}], 
          SuperscriptBox["T1", "9"]}], "-", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"2", " ", 
            FractionBox["\[Mu]2", "T2"]}], "]"}], 
          SuperscriptBox["T2", "9"]}]}], ")"}]}], "+", " ", 
      RowBox[{"56", " ", "*", "fsFD", "*", 
       SuperscriptBox["T1", "4"], " ", 
       SuperscriptBox["T2", "4"], 
       RowBox[{"Exp", "[", 
        FractionBox["\[Mu]1", "T1"], "]"}], 
       RowBox[{"Exp", "[", 
        FractionBox["\[Mu]2", "T2"], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"T1", "-", "T2"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Energy", " ", "Density", " ", "Transfer", " ", 
     RowBox[{"Rates", ":", " ", 
      RowBox[{"\[Delta]\[Rho]", "/", "\[Delta]t"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]e", "[", 
      RowBox[{
      "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
       "T\[Nu]\[Tau]_", ",", "\[Mu]\[Nu]e_", ",", "\[Mu]\[Nu]\[Mu]_"}], "]"}],
      "=", "  ", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{" ", 
         SuperscriptBox["GF", "2"]}], 
        SuperscriptBox["\[Pi]", "5"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["geL", "2"], "+", 
            SuperscriptBox["geR", "2"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"32", "*", "faFD", "*", 
             RowBox[{"fann\[Nu]e", "[", "T\[Gamma]", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["T\[Gamma]", "9"], "-", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", 
                  FractionBox["\[Mu]\[Nu]e", "T\[Nu]e"]}], "]"}], 
                SuperscriptBox["T\[Nu]e", "9"]}]}], ")"}]}], "+", 
            RowBox[{"56", "*", "fsFD", "*", " ", 
             SuperscriptBox["T\[Gamma]", "4"], " ", "*", 
             SuperscriptBox["T\[Nu]e", "4"], "*", 
             RowBox[{"fsca\[Nu]e", "[", "T\[Gamma]", "]"}], "*", 
             RowBox[{"Exp", "[", 
              FractionBox["\[Mu]\[Nu]e", "T\[Nu]e"], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"T\[Gamma]", "-", "T\[Nu]e"}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"Func", "[", 
          RowBox[{
          "T\[Nu]\[Mu]", ",", "T\[Nu]e", ",", "\[Mu]\[Nu]\[Mu]", ",", 
           "\[Mu]\[Nu]e"}], "]"}], "+", 
         RowBox[{"Func", "[", 
          RowBox[{
          "T\[Nu]\[Tau]", ",", "T\[Nu]e", ",", "0", ",", "\[Mu]\[Nu]e"}], 
          "]"}]}], ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"GF", "\[Rule]", " ", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], "GFvalue"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]\[Mu]", "[", 
      RowBox[{
      "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
       "T\[Nu]\[Tau]_", ",", "\[Mu]\[Nu]e_", ",", "\[Mu]\[Nu]\[Mu]_"}], "]"}],
      "=", "  ", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{" ", 
         SuperscriptBox["GF", "2"]}], 
        SuperscriptBox["\[Pi]", "5"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["g\[Mu]L", "2"], "+", 
            SuperscriptBox["g\[Mu]R", "2"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"32", "*", "faFD", "*", 
             RowBox[{"fann\[Nu]\[Mu]", "[", "T\[Gamma]", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["T\[Gamma]", "9"], "-", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", 
                  FractionBox["\[Mu]\[Nu]\[Mu]", "T\[Nu]\[Mu]"]}], "]"}], 
                SuperscriptBox["T\[Nu]\[Mu]", "9"]}]}], ")"}]}], "+", 
            RowBox[{"56", " ", "*", "fsFD", "*", 
             SuperscriptBox["T\[Gamma]", "4"], " ", "*", 
             SuperscriptBox["T\[Nu]\[Mu]", "4"], "*", 
             RowBox[{"fsca\[Nu]\[Mu]", "[", "T\[Gamma]", "]"}], "*", 
             RowBox[{"Exp", "[", 
              FractionBox["\[Mu]\[Nu]\[Mu]", "T\[Nu]\[Mu]"], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"T\[Gamma]", "-", "T\[Nu]\[Mu]"}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"Func", "[", 
          RowBox[{
          "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "\[Mu]\[Nu]e", ",", 
           "\[Mu]\[Nu]\[Mu]"}], "]"}], "+", 
         RowBox[{"Func", "[", 
          RowBox[{
          "T\[Nu]\[Tau]", ",", "T\[Nu]\[Mu]", ",", "0", ",", 
           "\[Mu]\[Nu]\[Mu]"}], "]"}]}], ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"GF", "\[Rule]", " ", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], "GFvalue"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]\[Tau]", "[", 
      RowBox[{
      "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
       "T\[Nu]\[Tau]_", ",", "\[Mu]\[Nu]e_", ",", "\[Mu]\[Nu]\[Mu]_"}], "]"}],
      "=", "  ", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{" ", 
         SuperscriptBox["GF", "2"]}], 
        SuperscriptBox["\[Pi]", "5"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "*", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["g\[Mu]L", "2"], "+", 
            SuperscriptBox["g\[Mu]R", "2"]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"32", "*", "faFD", "*", 
             RowBox[{"fann\[Nu]\[Mu]", "[", "T\[Gamma]", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["T\[Gamma]", "9"], "-", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"2", " ", 
                  FractionBox["\[Mu]\[Nu]\[Mu]", "T\[Nu]\[Tau]"]}], "]"}], 
                SuperscriptBox["T\[Nu]\[Tau]", "9"]}]}], ")"}]}], "+", 
            RowBox[{"56", " ", "*", "fsFD", "*", 
             SuperscriptBox["T\[Gamma]", "4"], " ", "*", 
             SuperscriptBox["T\[Nu]\[Tau]", "4"], "*", 
             RowBox[{"fsca\[Nu]\[Mu]", "[", "T\[Gamma]", "]"}], "*", 
             RowBox[{"Exp", "[", 
              FractionBox["\[Mu]\[Nu]\[Mu]", "T\[Nu]\[Tau]"], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"T\[Gamma]", "-", "T\[Nu]\[Tau]"}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"Func", "[", 
          RowBox[{
          "T\[Nu]e", ",", "T\[Nu]\[Tau]", ",", "\[Mu]\[Nu]e", ",", "0"}], 
          "]"}], "+", 
         RowBox[{"Func", "[", 
          RowBox[{
          "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]", ",", "\[Mu]\[Nu]\[Mu]", ",", 
           "0"}], "]"}]}], ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"GF", "\[Rule]", " ", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "6"}]], "GFvalue"}]}], "}"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.747645331758122*^9, 3.747645637673829*^9}, {
   3.74764684829451*^9, 3.747646851947554*^9}, {3.7622583372134743`*^9, 
   3.762258418677114*^9}, {3.7622585773367853`*^9, 3.762258585278473*^9}, {
   3.762258934267926*^9, 3.76225893582281*^9}, {3.76245046718115*^9, 
   3.762450469996026*^9}, {3.7624505605240583`*^9, 3.762450597612204*^9}, {
   3.762453178795778*^9, 3.762453287613522*^9}, {3.762453320722603*^9, 
   3.762453327813341*^9}, {3.7624537665437813`*^9, 3.762453770695194*^9}, 
   3.762453897553747*^9, 3.762453934006683*^9, {3.762453986243637*^9, 
   3.762453988490807*^9}, {3.76245407323685*^9, 3.762454116268152*^9}, {
   3.7624549988080673`*^9, 3.762455000524171*^9}, {3.7624570358994703`*^9, 
   3.762457036868474*^9}, {3.762457206714116*^9, 3.7624572199130983`*^9}, {
   3.762457280020504*^9, 3.762457339796529*^9}, {3.76245739975943*^9, 
   3.7624574708761673`*^9}, {3.76246332161694*^9, 3.7624633241761503`*^9}, {
   3.762463376535605*^9, 3.762463376710658*^9}, {3.770028512745569*^9, 
   3.770028515049191*^9}, {3.77002854862709*^9, 3.770028549472835*^9}, {
   3.770028662611998*^9, 3.770028667930652*^9}, {3.772523841562302*^9, 
   3.772523846736164*^9}, 3.772524008689547*^9, {3.772914539346044*^9, 
   3.772914549746344*^9}, {3.772914807853146*^9, 3.772914840810469*^9}, {
   3.772914879234075*^9, 3.772914927957402*^9}, {3.7732404863316603`*^9, 
   3.773240504574478*^9}, {3.781617880306743*^9, 3.781617881072309*^9}, 
   3.7866889365783577`*^9, {3.796732801485795*^9, 3.79673294426633*^9}, {
   3.7967329796112757`*^9, 3.796732979977678*^9}, 3.7969780735849667`*^9, {
   3.797309323340695*^9, 3.797309356349664*^9}, {3.797309393750018*^9, 
   3.797309406368554*^9}, {3.930032819755188*^9, 3.930032843126822*^9}, {
   3.930033149610923*^9, 3.930033149823844*^9}, {3.930033311340838*^9, 
   3.930033322962987*^9}, {3.9300333721417313`*^9, 3.930033372948941*^9}, {
   3.930033455375308*^9, 3.930033456059061*^9}, {3.930033781182829*^9, 
   3.930033781340019*^9}, {3.930033812727378*^9, 3.930033828711877*^9}, {
   3.930033864923912*^9, 3.930033907988283*^9}, {3.930034044308742*^9, 
   3.9300341137605*^9}, {3.930034865061481*^9, 3.930034873190922*^9}, {
   3.9300349215139093`*^9, 3.930034924801723*^9}, {3.930034989437705*^9, 
   3.930034992148321*^9}, {3.930035061451786*^9, 3.9300350654355917`*^9}, {
   3.933403204801675*^9, 3.9334032075483503`*^9}, {3.945402486079424*^9, 
   3.945402540501795*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f8009fb0-2861-42ec-a94c-b26344d86a86"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evolution equation for the energy densities", "Subsection",
 CellChangeTimes->{{3.9334032348853245`*^9, 
  3.9334032410760727`*^9}},ExpressionUUID->"5cb03c10-2a0e-48be-bc90-\
d059b716580d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TransferFactor", "[", 
     RowBox[{"T1_", ",", "T2_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"32", "*", "0.884", "*", 
        RowBox[{"Cancel", "[", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["T1", "9"], "-", 
            SuperscriptBox["T2", "9"]}], ")"}], 
          RowBox[{"T1", "-", "T2"}]], "]"}]}], "+", 
       RowBox[{"56", "*", "0.829", "*", 
        SuperscriptBox["T1", "4"], "*", 
        SuperscriptBox["T2", "4"]}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"T1", "-", "T2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "A", " ", "toy", " ", "factor", " ", "that", " ", "effectively", " ", 
      "takes", " ", "into", " ", "account", " ", "the", " ", "effect", " ", 
      "of", " ", "non"}], "-", 
     RowBox[{
     "perfect", " ", "FD", " ", "spectrum", " ", "of", " ", "neutrinos", " ", 
      "on", " ", "the", " ", "EM"}]}], "\[UndirectedEdge]", 
    RowBox[{"\[Nu]", " ", "equilibration", " ", 
     RowBox[{"(", 
      RowBox[{
      "see", " ", "long", " ", "BBN", " ", "draft", " ", "for", " ", 
       "details"}], ")"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rratio", "=", 
    RowBox[{"(*", "0.8", "*)"}], "1"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Rates", " ", "of", " ", "energy", " ", "density", " ", "transfer", " ", 
    "between", " ", "EM", " ", "and", " ", 
    SubscriptBox["\[Nu]", 
     RowBox[{"e", ",", "\[Mu]", ",", "\[Tau]"}]], " ", 
    RowBox[{"sectors", ".", " ", "Neutrino"}], " ", "oscillations", " ", 
    "are", " ", "taken", " ", "into", " ", "account"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]EM\[Nu]EqEM", "[", 
     RowBox[{
     "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
      "T\[Nu]\[Tau]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"-", "15"}]}], "*", 
      RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]e", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"10", "^", "3"}], "*", "T\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"10", "^", "3"}], "*", "T\[Nu]e"}], ",", 
        RowBox[{
         RowBox[{"10", "^", "3"}], "*", "T\[Nu]\[Mu]"}], ",", 
        RowBox[{
         RowBox[{"10", "^", "3"}], "*", "T\[Nu]\[Tau]"}], ",", "0", ",", 
        "0"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]\[Mu]", "[", 
       RowBox[{
        RowBox[{"T\[Gamma]", "*", 
         RowBox[{"10", "^", "3"}]}], ",", 
        RowBox[{"T\[Nu]e", "*", 
         RowBox[{"10", "^", "3"}]}], ",", 
        RowBox[{"T\[Nu]\[Mu]", "*", 
         RowBox[{"10", "^", "3"}]}], ",", 
        RowBox[{"T\[Nu]\[Tau]", "*", 
         RowBox[{"10", "^", "3"}]}], ",", "0", ",", "0"}], "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "15"}]}]}], "+", 
     RowBox[{
      RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]\[Tau]", "[", 
       RowBox[{
        RowBox[{"T\[Gamma]", "*", 
         RowBox[{"10", "^", "3"}]}], ",", 
        RowBox[{"T\[Nu]e", "*", 
         RowBox[{"10", "^", "3"}]}], ",", 
        RowBox[{"T\[Nu]\[Mu]", "*", 
         RowBox[{"10", "^", "3"}]}], ",", 
        RowBox[{"T\[Nu]\[Tau]", "*", 
         RowBox[{"10", "^", "3"}]}], ",", "0", ",", "0"}], "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "15"}]}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Rratio", 
     FractionBox[
      SuperscriptBox["GFvalue", "2"], 
      SuperscriptBox["Pi", "5"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", "*", "sin\[Theta]W2"}], "+", 
          RowBox[{"8", "*", 
           SuperscriptBox["sin\[Theta]W2", "2"]}]}], ")"}], "*", 
        RowBox[{"TransferFactor", "[", 
         RowBox[{"T\[Gamma]", ",", "T\[Nu]e"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", "*", "sin\[Theta]W2"}], "+", 
          RowBox[{"8", "*", 
           SuperscriptBox["sin\[Theta]W2", "2"]}]}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TransferFactor", "[", 
           RowBox[{"T\[Gamma]", ",", "T\[Nu]\[Mu]"}], "]"}], "+", 
          RowBox[{"TransferFactor", "[", 
           RowBox[{"T\[Gamma]", ",", "T\[Nu]\[Tau]"}], "]"}]}], ")"}]}]}], 
      ")"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GeVToMeV", "=", 
   SuperscriptBox["10", "3."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]ePure", "[", 
     RowBox[{
     "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
      "T\[Nu]\[Tau]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]e", "[", 
      RowBox[{
       RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], ",", 
       RowBox[{"GeVToMeV", "*", "T\[Nu]e"}], ",", 
       RowBox[{"GeVToMeV", "*", "T\[Nu]\[Mu]"}], ",", 
       RowBox[{"GeVToMeV", "*", "T\[Nu]\[Tau]"}], ",", "0", ",", "0"}], "]"}],
      "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "15"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     FractionBox[
      SuperscriptBox["GFvalue", "2"], 
      SuperscriptBox["Pi", "5"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rratio", "*", 
        RowBox[{"TransferFactor", "[", 
         RowBox[{"T\[Gamma]", ",", "T\[Nu]e"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"4", "*", "sin\[Theta]W2"}], "+", 
          RowBox[{"8", "*", 
           SuperscriptBox["sin\[Theta]W2", "2"]}]}], ")"}]}], "+", 
       RowBox[{"TransferFactor", "[", 
        RowBox[{"T\[Nu]\[Mu]", ",", "T\[Nu]e"}], "]"}], "+", 
       RowBox[{"TransferFactor", "[", 
        RowBox[{"T\[Nu]\[Tau]", ",", "T\[Nu]e"}], "]"}]}], ")"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Mu]Pure", "[", 
     RowBox[{
     "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
      "T\[Nu]\[Tau]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]\[Mu]", "[", 
      RowBox[{
       RowBox[{"T\[Gamma]", "*", "GeVToMeV"}], ",", 
       RowBox[{"T\[Nu]e", "*", "GeVToMeV"}], ",", 
       RowBox[{"T\[Nu]\[Mu]", "*", "GeVToMeV"}], ",", 
       RowBox[{"T\[Nu]\[Tau]", "*", "GeVToMeV"}], ",", "0", ",", "0"}], "]"}],
      "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "15"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     FractionBox[
      SuperscriptBox["GFvalue", "2"], 
      SuperscriptBox["Pi", "5"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rratio", "*", 
        RowBox[{"TransferFactor", "[", 
         RowBox[{"T\[Gamma]", ",", "T\[Nu]\[Mu]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", "*", "sin\[Theta]W2"}], "+", 
          RowBox[{"8", "*", 
           SuperscriptBox["sin\[Theta]W2", "2"]}]}], ")"}]}], "+", 
       RowBox[{"TransferFactor", "[", 
        RowBox[{"T\[Nu]e", ",", "T\[Nu]\[Mu]"}], "]"}], "+", 
       RowBox[{"TransferFactor", "[", 
        RowBox[{"T\[Nu]\[Tau]", ",", "T\[Nu]\[Mu]"}], "]"}]}], ")"}]}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Tau]Pure", "[", 
     RowBox[{
     "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
      "T\[Nu]\[Tau]_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"\[CapitalDelta]\[Rho]SM\[Nu]\[Tau]", "[", 
      RowBox[{
       RowBox[{"T\[Gamma]", "*", "GeVToMeV"}], ",", 
       RowBox[{"T\[Nu]e", "*", "GeVToMeV"}], ",", 
       RowBox[{"T\[Nu]\[Mu]", "*", "GeVToMeV"}], ",", 
       RowBox[{"T\[Nu]\[Tau]", "*", "GeVToMeV"}], ",", "0", ",", "0"}], "]"}],
      "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "15"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     FractionBox[
      SuperscriptBox["GFvalue", "2"], 
      SuperscriptBox["Pi", "5"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rratio", "*", 
        RowBox[{"TransferFactor", "[", 
         RowBox[{"T\[Gamma]", ",", "T\[Nu]\[Tau]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"4", "*", "sin\[Theta]W2"}], "+", 
          RowBox[{"8", "*", 
           SuperscriptBox["sin\[Theta]W2", "2"]}]}], ")"}]}], "+", 
       RowBox[{"TransferFactor", "[", 
        RowBox[{"T\[Nu]e", ",", "T\[Nu]\[Tau]"}], "]"}], "+", 
       RowBox[{"TransferFactor", "[", 
        RowBox[{"T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}], "]"}]}], ")"}]}], ";"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]e", "[", 
    RowBox[{
    "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
     "T\[Nu]\[Tau]_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"PeeInt", "[", 
       RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
      RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]ePure", "[", 
       RowBox[{
       "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}],
        "]"}]}], "+", 
     RowBox[{
      RowBox[{"Pe\[Mu]Int", "[", 
       RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
      RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Mu]Pure", "[", 
       RowBox[{
       "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}],
        "]"}]}], "+", 
     RowBox[{
      RowBox[{"Pe\[Tau]Int", "[", 
       RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
      RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Tau]Pure", "[", 
       RowBox[{
       "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}],
        "]"}]}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Mu]", "[", 
    RowBox[{
    "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
     "T\[Nu]\[Tau]_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"P\[Mu]eInt", "[", 
       RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
      RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]ePure", "[", 
       RowBox[{
       "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}],
        "]"}]}], "+", 
     RowBox[{
      RowBox[{"P\[Mu]\[Mu]Int", "[", 
       RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
      RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Mu]Pure", "[", 
       RowBox[{
       "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}],
        "]"}]}], "+", 
     RowBox[{
      RowBox[{"P\[Mu]\[Tau]Int", "[", 
       RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
      RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Tau]Pure", "[", 
       RowBox[{
       "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}],
        "]"}]}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Tau]", "[", 
     RowBox[{
     "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
      "T\[Nu]\[Tau]_"}], "]"}], "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"P\[Tau]eInt", "[", 
        RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
       RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]ePure", "[", 
        RowBox[{
        "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
         "T\[Nu]\[Tau]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"P\[Tau]\[Mu]Int", "[", 
        RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
       RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Mu]Pure", "[", 
        RowBox[{
        "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
         "T\[Nu]\[Tau]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"P\[Tau]\[Tau]Int", "[", 
        RowBox[{"GeVToMeV", "*", "T\[Gamma]"}], "]"}], "*", 
       RowBox[{"\[CapitalGamma]EM\[Nu]Eq\[Nu]\[Tau]Pure", "[", 
        RowBox[{
        "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
         "T\[Nu]\[Tau]"}], "]"}]}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Dynamics", " ", "of", " ", "neutrino"}], ",", " ", 
    RowBox[{
    "photon", " ", "temperatures", " ", "and", " ", "scale", " ", "factor", 
     " ", "in", " ", "presence", " ", "of", " ", "decays", " ", "of", " ", 
     RowBox[{"HNLs", ".", " ", "It"}], " ", "is", " ", "assumed", " ", "that",
      " ", "decaying", " ", "HNLs", " ", "store", " ", "exactly", " ", 
     RowBox[{"1", "/", "3"}], " ", "of", " ", "their", " ", "neutrino", " ", 
     "energy", " ", "into", " ", "each", " ", "neutrino", " ", "flavor", " ", 
     "energy"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T\[Gamma]Dynamics", "[", 
    RowBox[{
    "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", "T\[Nu]\[Tau]_", 
     ",", "\[Rho]X_", ",", "\[Xi]injEM_", ",", "\[Tau]X_", ",", "mX_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "sToGeVminusOne"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", "*", 
          RowBox[{"HInGeV\[Rho]", "[", 
           RowBox[{
           "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
            "T\[Nu]\[Tau]", ",", "\[Rho]X"}], "]"}], "*", 
          RowBox[{"\[Rho]\[Gamma]", "[", "T\[Gamma]", "]"}]}], "+", 
         RowBox[{"3", "*", 
          RowBox[{"HInGeV\[Rho]", "[", 
           RowBox[{
           "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
            "T\[Nu]\[Tau]", ",", "\[Rho]X"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Rho]e", "[", "T\[Gamma]", "]"}], "+", 
            RowBox[{"pe", "[", "T\[Gamma]", "]"}]}], ")"}]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D\[Rho]eDT", "[", "T\[Gamma]", "]"}], "+", 
         RowBox[{"D\[Rho]\[Gamma]DT", "[", "T\[Gamma]", "]"}]}], ")"}]}], 
      ")"}]}], "-", 
    RowBox[{"sToGeVminusOne", "*", 
     FractionBox[
      RowBox[{"\[CapitalGamma]EM\[Nu]EqEM", "[", 
       RowBox[{
       "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]"}],
        "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D\[Rho]eDT", "[", "T\[Gamma]", "]"}], "+", 
        RowBox[{"D\[Rho]\[Gamma]DT", "[", "T\[Gamma]", "]"}]}], ")"}]]}], "+", 
    FractionBox[
     RowBox[{"\[Rho]X", "*", "\[Xi]injEM"}], 
     RowBox[{"\[Tau]X", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D\[Rho]eDT", "[", "T\[Gamma]", "]"}], "+", 
        RowBox[{"D\[Rho]\[Gamma]DT", "[", "T\[Gamma]", "]"}]}], ")"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"temper", "=", 
     RowBox[{"Symbol", "[", 
      RowBox[{"\"\<T\[Nu]\>\"", "<>", "\[Alpha]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<T\[Nu]\>\"", "<>", "\[Alpha]", "<>", "\"\<Dynamics\>\""}],
        "]"}], "[", 
      RowBox[{
      "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", 
       "T\[Nu]\[Tau]_", ",", "\[Rho]X_", ",", "\[Xi]inj\[Nu]_", ",", 
       "\[Tau]X_", ",", "mX_"}], "]"}], "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"d\[Rho]\[Nu]\[Alpha]dT", "[", "temper", "]"}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "sToGeVminusOne"}], "*", "4", "*", 
         RowBox[{"HInGeV\[Rho]", "[", 
          RowBox[{
          "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
           "T\[Nu]\[Tau]", ",", "\[Rho]X"}], "]"}], "*", 
         RowBox[{"\[Rho]\[Nu]\[Alpha]", "[", "temper", "]"}]}], "+", 
        RowBox[{"sToGeVminusOne", "*", 
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{
           "\"\<\[CapitalGamma]EM\[Nu]Eq\[Nu]\>\"", "<>", "\[Alpha]"}], "]"}],
           "[", 
          RowBox[{
          "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
           "T\[Nu]\[Tau]"}], "]"}]}], "+", 
        FractionBox[
         RowBox[{"\[Rho]X", "*", "\[Xi]inj\[Nu]"}], "\[Tau]X"]}], ")"}]}]}]}],
    "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<e\>\"", ",", "\"\<\[Mu]\>\"", ",", "\"\<\[Tau]\>\""}], 
      "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]XdynamicsMattDom", "[", 
    RowBox[{
    "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", "T\[Nu]\[Tau]_", 
     ",", "\[Rho]X_", ",", "\[Tau]X_", ",", "mX_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[Rho]X", "\[Tau]X"]}], "-", 
    RowBox[{"3", "*", "sToGeVminusOne", "*", 
     RowBox[{"HInGeV\[Rho]", "[", 
      RowBox[{
      "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]", 
       ",", "\[Rho]X"}], "]"}], "\[Rho]X"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aRatioDynamics", "[", 
    RowBox[{
    "T\[Gamma]_", ",", "T\[Nu]e_", ",", "T\[Nu]\[Mu]_", ",", "T\[Nu]\[Tau]_", 
     ",", "aRatio_", ",", "\[Rho]X_"}], "]"}], "=", 
   RowBox[{"aRatio", "*", "sToGeVminusOne", "*", 
    RowBox[{"HInGeV\[Rho]", "[", 
     RowBox[{
     "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", "T\[Nu]\[Tau]", 
      ",", "\[Rho]X"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.806689512493396*^9, 3.806689522152719*^9}, {
   3.806689594443474*^9, 3.806689687201985*^9}, {3.806690117991883*^9, 
   3.80669014191978*^9}, {3.806690301359826*^9, 3.806690332161157*^9}, {
   3.809713817856306*^9, 3.809713817881238*^9}, {3.826884518055565*^9, 
   3.826884522760582*^9}, {3.826884569174981*^9, 3.826884572161248*^9}, {
   3.826898438302094*^9, 3.8268984409356227`*^9}, {3.82901676744913*^9, 
   3.829016769440958*^9}, {3.927685007705936*^9, 3.9276850095578823`*^9}, {
   3.927685087209731*^9, 3.927685114835334*^9}, {3.927685158917547*^9, 
   3.9276851754551535`*^9}, {3.9276857210757985`*^9, 3.92768572113161*^9}, {
   3.927686250299972*^9, 3.927686251904125*^9}, {3.9276882375979805`*^9, 
   3.927688245238216*^9}, {3.9276882940184536`*^9, 3.927688294575296*^9}, {
   3.928471242776918*^9, 3.9284712968446712`*^9}, {3.9300328925676527`*^9, 
   3.930032912723207*^9}, {3.930033101124434*^9, 3.9300331119607887`*^9}, {
   3.930033336640818*^9, 3.930033359194298*^9}, {3.930033473156337*^9, 
   3.930033659687307*^9}, {3.9300339286702137`*^9, 3.9300339770680227`*^9}, {
   3.930035107028607*^9, 3.930035127580565*^9}, {3.9454032959409275`*^9, 
   3.945403297559376*^9}, {3.9454034122999134`*^9, 3.9454034197985554`*^9}, {
   3.9454036027195206`*^9, 3.945403602841364*^9}, {3.9454039756459045`*^9, 
   3.945404018621073*^9}, {3.9454040896882668`*^9, 3.9454041599617004`*^9}, 
   3.9454042543521633`*^9, {3.9454046218749714`*^9, 3.9454046673255577`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"4f07f68f-9a53-46bc-afe8-1546aaa87c73"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["System of equations", "Section",
 CellChangeTimes->{{3.807443894719813*^9, 3.8074439141897106`*^9}, {
   3.808021192549409*^9, 3.808021193333313*^9}, 
   3.927709356448279*^9},ExpressionUUID->"9ea63664-29d0-4e9d-9bef-\
7ae8a13a563b"],

Cell[CellGroupData[{

Cell["System", "Subsection",
 CellChangeTimes->{{3.806690494560106*^9, 3.806690508720187*^9}, {
   3.807443906039919*^9, 3.807443906071017*^9}, {3.92768864725195*^9, 
   3.927688647682191*^9}, 
   3.933403255678361*^9},ExpressionUUID->"96ba0111-5c8b-4059-853b-\
f143e056ef7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SCALET\[Gamma]", "=", 
   RowBox[{"(*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]], "*)"}], "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EqsEqTemp", "[", 
    RowBox[{
    "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "\[Xi]EM_", ",", 
     "\[Xi]\[Nu]e_", ",", "\[Xi]\[Nu]\[Mu]_", ",", "\[Xi]\[Nu]\[Tau]_", ",", 
     "tIni_", ",", "Tini_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Gamma]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", "t"}],
        "]"}], "\[Equal]", 
      RowBox[{"T\[Gamma]Dynamics", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Gamma]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "<", 
           RowBox[{"20", "\[Tau]X"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Rho]LLPscaling", "[", 
            RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
             RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
            "]"}], "]"}], ",", "0."}], "]"}], ",", "\[Xi]EM", ",", "\[Tau]X", 
        ",", "mX"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", "t"}], 
       "]"}], "\[Equal]", 
      RowBox[{"T\[Nu]eDynamics", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Gamma]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "<", 
           RowBox[{"20", "\[Tau]X"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Rho]LLPscaling", "[", 
            RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
             RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
            "]"}], "]"}], ",", "0."}], "]"}], ",", "\[Xi]\[Nu]e", ",", 
        "\[Tau]X", ",", "mX"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        "t"}], "]"}], "\[Equal]", 
      RowBox[{"T\[Nu]\[Mu]Dynamics", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Gamma]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "<", 
           RowBox[{"20", "\[Tau]X"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Rho]LLPscaling", "[", 
            RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
             RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
            "]"}], "]"}], ",", "0."}], "]"}], ",", "\[Xi]\[Nu]\[Mu]", ",", 
        "\[Tau]X", ",", "mX"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        "t"}], "]"}], "\[Equal]", 
      RowBox[{"T\[Nu]\[Tau]Dynamics", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Gamma]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "<", 
           RowBox[{"20", "\[Tau]X"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Rho]LLPscaling", "[", 
            RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
             RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
            "]"}], "]"}], ",", "0."}], "]"}], ",", "\[Xi]\[Nu]\[Tau]", ",", 
        "\[Tau]X", ",", "mX"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"aRatio", "[", "t", "]"}], ",", "t"}], "]"}], "\[Equal]", 
      RowBox[{"aRatioDynamics", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"T\[Gamma]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "SCALET\[Gamma]"}], ",", 
        RowBox[{"aRatio", "[", "t", "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"t", "<", 
           RowBox[{"20", "\[Tau]X"}]}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"\[Rho]LLPscaling", "[", 
            RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
             RowBox[{"aRatio", "[", "t", "]"}], ",", "t", ",", "tIni"}], 
            "]"}], "]"}], ",", "0."}], "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"T\[Gamma]", "[", "tIni", "]"}], "SCALET\[Gamma]"}], 
      "\[Equal]", "Tini"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"T\[Nu]e", "[", "tIni", "]"}], "SCALET\[Gamma]"}], "\[Equal]", 
      "TiniEM"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"T\[Nu]\[Mu]", "[", "tIni", "]"}], "SCALET\[Gamma]"}], 
      "\[Equal]", "TiniEM"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"T\[Nu]\[Tau]", "[", "tIni", "]"}], "SCALET\[Gamma]"}], 
      "\[Equal]", "TiniEM"}], ",", 
     RowBox[{
      RowBox[{"aRatio", "[", "tIni", "]"}], "\[Equal]", "1"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.928471313866466*^9, 3.928471355066721*^9}, {
  3.933401087077308*^9, 3.933401142859727*^9}, {3.9334013025640507`*^9, 
  3.933401314503558*^9}, {3.9334017774186754`*^9, 3.933401782478365*^9}, {
  3.9334019000572085`*^9, 3.933401901975526*^9}, {3.9334019964732904`*^9, 
  3.933402031693615*^9}, {3.9334021878607826`*^9, 3.9334021918741117`*^9}, {
  3.933610801107238*^9, 3.9336108037741385`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"493a7e1e-ce1a-4b92-a960-64cc829709cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution", "Subsection",
 CellChangeTimes->{{3.9334032596889143`*^9, 
  3.9334032605214767`*^9}},ExpressionUUID->"42f21b45-286d-4885-b6d6-\
0ca34ca9ca24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tmax", "=", 
   RowBox[{"6", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TiniEM", "=", 
   RowBox[{"20.", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TAAE", "[", "mass_", "]"}], "=", 
   RowBox[{"0.05", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmaxsol", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
   RowBox[{
   "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "\[Xi]EM_", ",", 
    "\[Xi]\[Nu]e_", ",", "\[Xi]\[Nu]\[Mu]_", ",", "\[Xi]\[Nu]\[Tau]_", ",", 
    "tmax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mass", "=", "mX"}], ",", 
      RowBox[{"lifetime", "=", "\[Tau]X"}], ",", "tvals", ",", "tablepars", 
      ",", "\[Rho]Xin", ",", "EqsEq", ",", "tIniEM", ",", "nXt", ",", "tT", 
      ",", "Tt", ",", "aRatiot", ",", "aRatioT", ",", "\[Eta]Bt", ",", 
      "\[Eta]BT", ",", "Ht", ",", "HT", ",", "T\[Gamma]t", ",", "\[Rho]Xt", 
      ",", "\[Rho]XT", ",", "solUniverse", ",", "T\[Nu]et", ",", "T\[Nu]eT", 
      ",", "T\[Nu]\[Mu]T", ",", "T\[Nu]\[Mu]t", ",", "T\[Nu]\[Tau]T", ",", 
      "T\[Nu]\[Tau]t"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Rho]Xin", "=", 
      RowBox[{"nXini", "*", "mX"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tIniEM", "=", 
      RowBox[{"tInSinTermsOfTinMeVsimple", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["10", "3"], "TiniEM"}], ",", 
        RowBox[{"10.75", "+", 
         FractionBox["\[Rho]Xin", 
          RowBox[{
           FractionBox[
            SuperscriptBox["Pi", "2"], "30"], "*", 
           SuperscriptBox["TiniEM", "4"]}]]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"EqsEq", "=", 
      RowBox[{"EqsEqTemp", "[", 
       RowBox[{
       "mX", ",", "\[Tau]X", ",", "nXini", ",", "\[Xi]EM", ",", "\[Xi]\[Nu]e",
         ",", "\[Xi]\[Nu]\[Mu]", ",", "\[Xi]\[Nu]\[Tau]", ",", "tIniEM", ",", 
        "TiniEM"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"solUniverse", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Rationalize", "[", 
          RowBox[{"EqsEq", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "T\[Gamma]", ",", "T\[Nu]e", ",", "T\[Nu]\[Mu]", ",", 
           "T\[Nu]\[Tau]", ",", "aRatio"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tIniEM", ",", 
           RowBox[{"1.3", "*", "tmax"}]}], "}"}], ",", 
         RowBox[{"MaxSteps", "\[Rule]", "50000"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<BDF\>\"", ",", 
            RowBox[{"\"\<MaxDifferenceOrder\>\"", "\[Rule]", "2"}]}], 
           "}"}]}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T\[Gamma]t", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{"Tt", "[", "t_", "]"}], "=", 
       RowBox[{"SCALET\[Gamma]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"T\[Gamma]", "[", "t", "]"}], "/.", "solUniverse"}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T\[Nu]et", "[", "t_", "]"}], "=", 
      RowBox[{"SCALET\[Gamma]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"T\[Nu]e", "[", "t", "]"}], "/.", "solUniverse"}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T\[Nu]\[Mu]t", "[", "t_", "]"}], "=", 
      RowBox[{"SCALET\[Gamma]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"T\[Nu]\[Mu]", "[", "t", "]"}], "/.", "solUniverse"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T\[Nu]\[Tau]t", "[", "t_", "]"}], "=", 
      RowBox[{"SCALET\[Gamma]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"T\[Nu]\[Tau]", "[", "t", "]"}], "/.", "solUniverse"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"aRatiot", "=", 
      RowBox[{"aRatio", "/.", "solUniverse"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tvals", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "t"], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"Log10", "[", "tIniEM", "]"}], ",", 
            RowBox[{"Log10", "[", "tmax", "]"}], ",", "0.005"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", "tmax", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tablepars", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", "t"], ",", 
            RowBox[{"aRatiot", "[", 
             SuperscriptBox["10", "t"], "]"}], ",", 
            RowBox[{"T\[Gamma]t", "[", 
             SuperscriptBox["10", "t"], "]"}], ",", 
            RowBox[{"T\[Nu]et", "[", 
             SuperscriptBox["10", "t"], "]"}], ",", 
            RowBox[{"T\[Nu]\[Mu]t", "[", 
             SuperscriptBox["10", "t"], "]"}], ",", 
            RowBox[{"T\[Nu]\[Tau]t", "[", 
             SuperscriptBox["10", "t"], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"Log10", "[", "tIniEM", "]"}], ",", 
            RowBox[{"Log10", "[", "tmax", "]"}], ",", "0.005"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"tmax", ",", 
           RowBox[{"aRatiot", "[", "tmax", "]"}], ",", 
           RowBox[{"T\[Gamma]t", "[", "tmax", "]"}], ",", 
           RowBox[{"T\[Nu]et", "[", "tmax", "]"}], ",", 
           RowBox[{"T\[Nu]\[Mu]t", "[", "tmax", "]"}], ",", 
           RowBox[{"T\[Nu]\[Tau]t", "[", "tmax", "]"}]}], "}"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tT", "[", "T_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"tablepars", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "T", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aRatioT", "[", "T_", "]"}], "=", 
      RowBox[{
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"tablepars", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}], ",", 
         RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "T", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Eta]Bt", "[", "t_", "]"}], "=", 
      RowBox[{"\[Eta]BPlanck", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"aRatiot", "[", "t", "]"}], "*", 
           RowBox[{"Tt", "[", "t", "]"}]}], 
          RowBox[{
           RowBox[{"aRatiot", "[", "tmaxsol", "]"}], "*", 
           RowBox[{"Tt", "[", "tmaxsol", "]"}]}]], ")"}], 
        RowBox[{"-", "3"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Eta]BT", "[", "T_", "]"}], "=", 
      RowBox[{"\[Eta]BPlanck", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{
           RowBox[{"aRatioT", "[", "T", "]"}], "T"}], 
          RowBox[{
           RowBox[{"Tt", "[", "tmaxsol", "]"}], "*", 
           RowBox[{"aRatiot", "[", "tmaxsol", "]"}]}]], ")"}], 
        RowBox[{"-", "3"}]]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]Xt", "[", "t_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "<", 
         RowBox[{"20", "*", "\[Tau]X"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\[Rho]LLPscaling", "[", 
          RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
           RowBox[{"aRatiot", "[", "t", "]"}], ",", "t", ",", "tIniEM"}], 
          "]"}], "]"}], ",", "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]XT", "[", "T_", "]"}], "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tT", "[", "T", "]"}], "<", 
         RowBox[{"20", "*", "\[Tau]X"}]}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\[Rho]LLPscaling", "[", 
          RowBox[{"mX", ",", "nXini", ",", "\[Tau]X", ",", 
           RowBox[{"aRatioT", "[", "T", "]"}], ",", 
           RowBox[{"tT", "[", "T", "]"}], ",", "tIniEM"}], "]"}], "]"}], ",", 
        "0."}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nXt", "[", "t_", "]"}], "=", 
      FractionBox[
       RowBox[{"\[Rho]Xt", "[", "t", "]"}], "mX"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"T\[Nu]eT", "[", "T_", "]"}], ",", 
        RowBox[{"T\[Nu]\[Mu]T", "[", "T_", "]"}], ",", 
        RowBox[{"T\[Nu]\[Tau]T", "[", "T_", "]"}]}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{
           RowBox[{"tablepars", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "#"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "T", 
         "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "3"}], ",", 
         RowBox[{"-", "2"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ht", "[", "t_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"HInGeV\[Rho]", "[", 
               RowBox[{
                RowBox[{"Tt", "[", "t", "]"}], ",", 
                RowBox[{"T\[Nu]et", "[", "t", "]"}], ",", 
                RowBox[{"T\[Nu]\[Mu]t", "[", "t", "]"}], ",", 
                RowBox[{"T\[Nu]\[Tau]t", "[", "t", "]"}], ",", 
                RowBox[{"\[Rho]Xt", "[", "t", "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "tvals"}], "}"}]}], "]"}], ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "t", "]"}],
        "*", "sToGeVminusOne"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HT", "[", "T_", "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{"HInGeV\[Rho]", "[", 
               RowBox[{"T", ",", 
                RowBox[{"T\[Nu]eT", "[", "T", "]"}], ",", 
                RowBox[{"T\[Nu]\[Mu]T", "[", "T", "]"}], ",", 
                RowBox[{"T\[Nu]\[Tau]T", "[", "T", "]"}], ",", 
                RowBox[{"\[Rho]XT", "[", "T", "]"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"T", ",", 
              RowBox[{"tablepars", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"InterpolationOrder", "->", "1"}]}], "]"}], "[", "T", "]"}],
        "*", "sToGeVminusOne"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"tTtemp", "[", "T_", "]"}], ":=", 
        RowBox[{"Quiet", "[", 
         RowBox[{"t", "/.", 
          RowBox[{
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"T\[Gamma]temp", "[", "t", "]"}], "\[Equal]", "T"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", 
               RowBox[{"3", "*", "tIniEM"}], ",", "tIniEM", ",", 
               RowBox[{"1.3", "*", "tmax"}]}], "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nXt", "[", "t", "]"}], ",", 
          RowBox[{"tT", "[", "T", "]"}], ",", 
          RowBox[{"Tt", "[", "t", "]"}], ",", 
          RowBox[{"aRatiot", "[", "t", "]"}], ",", 
          RowBox[{"aRatioT", "[", "T", "]"}], ",", 
          RowBox[{"\[Eta]Bt", "[", "t", "]"}], ",", 
          RowBox[{"\[Eta]BT", "[", "T", "]"}], ",", 
          RowBox[{"Ht", "[", "t", "]"}], ",", 
          RowBox[{"HT", "[", "T", "]"}], ",", 
          RowBox[{"T\[Nu]et", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]eT", "[", "T", "]"}], ",", 
          RowBox[{"T\[Nu]\[Mu]t", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]\[Mu]T", "[", "T", "]"}], ",", 
          RowBox[{"T\[Nu]\[Tau]t", "[", "t", "]"}], ",", 
          RowBox[{"T\[Nu]\[Tau]T", "[", "T", "]"}]}], "}"}], "]"}], ",", 
       "tIniEM"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
   RowBox[{
   "mX_", ",", "\[Tau]X_", ",", "nXini_", ",", "\[Xi]EM_", ",", "tmax_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
     RowBox[{"mX", ",", "\[Tau]X", ",", "nXini", ",", "\[Xi]EM", ",", 
      FractionBox[
       RowBox[{"1", "-", "\[Xi]EM"}], "3"], ",", 
      FractionBox[
       RowBox[{"1", "-", "\[Xi]EM"}], "3"], ",", 
      FractionBox[
       RowBox[{"1", "-", "\[Xi]EM"}], "3"], ",", "tmax"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.928306236158764*^9, 3.928306328671694*^9}, {
   3.9283064831434393`*^9, 3.928306532551888*^9}, 3.928312602817246*^9, {
   3.928471489055247*^9, 3.928471555353188*^9}, {3.928474734608392*^9, 
   3.928474734759365*^9}, {3.928901944812466*^9, 3.928901967828149*^9}, {
   3.928902026456914*^9, 3.928902052642221*^9}, {3.92891748606793*^9, 
   3.928917487472468*^9}, {3.930834456971656*^9, 3.930834471236045*^9}, {
   3.932400579721775*^9, 3.9324005822097793`*^9}, {3.932400673377014*^9, 
   3.9324006754602313`*^9}, {3.933400979746916*^9, 3.9334009821693244`*^9}, {
   3.933401179794649*^9, 3.933401215328807*^9}, {3.9334017168998833`*^9, 
   3.9334017271180005`*^9}, {3.9334020566221037`*^9, 
   3.9334021239104176`*^9}, {3.9334021818622227`*^9, 3.933402243564273*^9}, {
   3.933403273611415*^9, 3.933403293141119*^9}, {3.933405127071556*^9, 
   3.9334051288577423`*^9}, {3.9334060612244463`*^9, 3.933406072622884*^9}, {
   3.933406211575281*^9, 3.9334062492402277`*^9}, {3.9334062849496784`*^9, 
   3.933406329426319*^9}, {3.9334064921074443`*^9, 3.9334065099964857`*^9}, {
   3.933406674833203*^9, 3.9334068313475723`*^9}, {3.933406867241105*^9, 
   3.933406945242386*^9}, {3.9334069796248865`*^9, 3.933406985284367*^9}, {
   3.9334070156185017`*^9, 3.933407043151971*^9}, {3.9334070834064693`*^9, 
   3.9334071612546406`*^9}, {3.933407197086467*^9, 3.9334072497525215`*^9}, {
   3.933407304806006*^9, 3.9334073152369423`*^9}, 3.933610322141858*^9, {
   3.9336103678855896`*^9, 3.933610443897299*^9}, {3.93361081370641*^9, 
   3.933610818144743*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"63011ab2-9163-49ce-be2e-9cf8004dbec3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Critical value of \!\(\*SubscriptBox[\(r\), \(2\)]\) obtained from \
\!\(\*FractionBox[SubscriptBox[\(r\), \(2\)], \(1 - \*SubscriptBox[\(r\), \(2\
\)]\)]\) = \!\(\*FractionBox[SubscriptBox[\(\[Rho]\), \(\[Nu], SM\)], \
SubscriptBox[\(\[Rho]\), \(EM, SM\)]]\) (at T ~ MeV) = \!\(\*FractionBox[\(21\
\), \(22\)]\):\>\"", "]"}], "\[IndentingNewLine]", "r2critical"}], "=", 
    RowBox[{
     RowBox[{"r2", "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           FractionBox["r2", 
            RowBox[{"1", "-", "r2"}]], "==", 
           FractionBox["21", "22"]}], ",", "r2"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
       "\[Xi]EMtest"}]}], "=", 
     RowBox[{"(*", 
      RowBox[{"1", "-", "r2critical"}], "*)"}], "0.6"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BlockTest", "[", 
     RowBox[{
     "nXini_", ",", "mXtest_", ",", "\[Tau]Xtest_", ",", "\[Xi]EMtest_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fff1", "[", "t_", "]"}], "=", 
         RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
          RowBox[{
          "mXtest", ",", "\[Tau]Xtest", ",", "nXini", ",", "\[Xi]EMtest", ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Xi]EMtest"}], ")"}], "3"], ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Xi]EMtest"}], ")"}], "3"], ",", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Xi]EMtest"}], ")"}], "3"], ",", "tmaxsol"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nXtsol", "[", "t_", "]"}], ",", 
             RowBox[{"tTsol", "[", "T_", "]"}], ",", 
             RowBox[{"Ttsol", "[", "t_", "]"}], ",", 
             RowBox[{"aRatiotsol", "[", "t_", "]"}], ",", 
             RowBox[{"aRatioTsol", "[", "T_", "]"}], ",", 
             RowBox[{"\[Eta]Btsol", "[", "t_", "]"}], ",", 
             RowBox[{"\[Eta]BTsol", "[", "T_", "]"}], ",", 
             RowBox[{"Htsol", "[", "t_", "]"}], ",", 
             RowBox[{"HTsol", "[", "T_", "]"}], ",", 
             RowBox[{"T\[Nu]etsol", "[", "t_", "]"}], ",", 
             RowBox[{"T\[Nu]eTsol", "[", "T_", "]"}], ",", 
             RowBox[{"T\[Nu]\[Mu]tsol", "[", "t_", "]"}], ",", 
             RowBox[{"T\[Nu]\[Mu]Tsol", "[", "T_", "]"}], ",", 
             RowBox[{"T\[Nu]\[Tau]tsol", "[", "t_", "]"}], ",", 
             RowBox[{"T\[Nu]\[Tau]Tsol", "[", "T_", "]"}]}], "}"}], ",", 
           "tIniEMsol"}], "}"}], "=", 
         RowBox[{"fff1", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SourceTermX", "[", "t_", "]"}], "=", 
         RowBox[{
          RowBox[{"nXtsol", "[", "t", "]"}], "*", 
          FractionBox["mXtest", "\[Tau]Xtest"]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]InjEMv", "=", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"aRatiotsol", "[", "tmaxsol", "]"}], "4"]], 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"aRatiotsol", "[", "t", "]"}], "4"], 
              RowBox[{"SourceTermX", "[", "t", "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"fff1", "[", "t", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"10", "*", "\[Tau]Xtest"}]}], "}"}], ",", 
            RowBox[{
            "Method", "->", "\"\<InterpolationPointsSubdivision\>\""}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]SMfin", "=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Rho]\[Nu]Total", "[", 
             RowBox[{
              RowBox[{"T\[Nu]etsol", "[", "tmaxsol", "]"}], ",", 
              RowBox[{"T\[Nu]\[Mu]tsol", "[", "tmaxsol", "]"}], ",", 
              RowBox[{"T\[Nu]\[Tau]tsol", "[", "tmaxsol", "]"}]}], "]"}], "+", 
            RowBox[{"\[Rho]e", "[", 
             RowBox[{"Ttsol", "[", "tmaxsol", "]"}], "]"}], "+", 
            RowBox[{"\[Rho]\[Gamma]", "[", 
             RowBox[{"Ttsol", "[", "tmaxsol", "]"}], "]"}]}], ")"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"\"\<Ratio \!\(\*SubscriptBox[\(r\), \(1\)]\): \>\"", ",", 
            FractionBox["\[Rho]InjEMv", "\[Rho]SMfin"]}], "}"}], "]"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"r1val", "=", 
         FractionBox["\[Rho]InjEMv", "\[Rho]SMfin"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Rho]\[Nu]\[Rho]EMratio", "[", "t_", "]"}], "=", 
         FractionBox[
          RowBox[{"\[Rho]\[Nu]Total", "[", 
           RowBox[{
            RowBox[{"T\[Nu]etsol", "[", "t", "]"}], ",", 
            RowBox[{"T\[Nu]\[Mu]tsol", "[", "t", "]"}], ",", 
            RowBox[{"T\[Nu]\[Tau]tsol", "[", "t", "]"}]}], "]"}], 
          RowBox[{
           RowBox[{"\[Rho]e", "[", 
            RowBox[{"Ttsol", "[", "t", "]"}], "]"}], "+", 
           RowBox[{"\[Rho]\[Gamma]", "[", 
            RowBox[{"Ttsol", "[", "t", "]"}], "]"}]}]]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Neffval", "=", 
         RowBox[{
          FractionBox["8", "7"], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["11", "4"], ")"}], 
           FractionBox["4", "3"]], 
          RowBox[{"\[Rho]\[Nu]\[Rho]EMratio", "[", "tmaxsol", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "-", "\[Xi]EMtest"}], ",", "Neffval", ",", "r1val", 
          ",", 
          RowBox[{"\[Rho]\[Nu]\[Rho]EMratio", "[", "t", "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     RowBox[{"nXiniv", "=", 
      RowBox[{"1000", "*", 
       FractionBox[
        RowBox[{"Zeta", "[", "3", "]"}], 
        SuperscriptBox["Pi", "2"]], 
       SuperscriptBox["TiniEM", "3"]}]}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"mXtest", "=", "1."}], ";", "\[IndentingNewLine]", 
   RowBox[{"\[Tau]Xtest", "=", "0.5"}], ";", "\[IndentingNewLine]", 
   RowBox[{"parsconfig", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nXiniv", ",", "mXtest", ",", "\[Tau]Xtest", ",", 
        RowBox[{"1", "-", "r2critical"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nXiniv", ",", "mXtest", ",", "\[Tau]Xtest", ",", "0.59"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nXiniv", ",", "mXtest", ",", "100", ",", 
        RowBox[{"1", "-", "r2critical"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nXiniv", ",", "mXtest", ",", "100", ",", "0.59"}], "}"}]}], 
     "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"r2sim", "[", "i", "]"}], ",", 
         RowBox[{"Neffsim", "[", "i", "]"}], ",", 
         RowBox[{"r1sim", "[", "i", "]"}], ",", 
         RowBox[{"\[Rho]ratios", "[", 
          RowBox[{"i", ",", "t_"}], "]"}]}], "}"}], "=", 
       RowBox[{"BlockTest", "@@", 
        RowBox[{"parsconfig", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "parsconfig", "]"}], ",", "1"}], "}"}]}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"LogLinearPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            FractionBox["8", "7"], 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["11", "4"], ")"}], 
             FractionBox["4", "3"]], 
            RowBox[{"\[Rho]ratios", "[", 
             RowBox[{"#", ",", "t"}], "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "4"}], "]"}]}], ",", 
         RowBox[{"{", "3.035", "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "tIniEMsol", ",", "tmaxsol"}], "}"}], ",", 
      RowBox[{"ImageSize", "->", "Large"}], ",", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Blue", ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", 
           RowBox[{"Darker", "@", "Red"}], ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Gray", ",", 
           RowBox[{"Dashing", "[", "0.02", "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "->", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"#", ",", "15"}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<\[Tau] = \>\"", ",", 
                RowBox[{
                 RowBox[{"parsconfig", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                "\"\< s, \!\(\*SubscriptBox[\(r\), \(2\)]\) = \>\"", ",", 
                RowBox[{"1", "-", 
                 RowBox[{
                  RowBox[{"parsconfig", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "parsconfig", "]"}], ",", "1"}], 
              "}"}]}], "]"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0.2", ",", "0.2"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"FrameStyle", "->", 
       RowBox[{"Directive", "[", 
        RowBox[{"Thick", ",", "Black", ",", "22"}], "]"}]}], ",", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<t [s]\>\"", ",", " ", 
         "\"\<(8/7)(11/4\!\(\*SuperscriptBox[\()\), \
\(4/3\)]\)\!\(\*SubscriptBox[\(\[Rho]\), \(\[Nu]\)]\)/\!\(\*SubscriptBox[\(\
\[Rho]\), \(EM\)]\)\>\""}], "}"}]}], ",", 
      RowBox[{"LabelStyle", "->", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Black"}], "}"}]}]}], "]"}]}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.933608177576045*^9, 3.93360864348318*^9}, {
   3.933608701645813*^9, 3.9336087044551744`*^9}, {3.933608758883313*^9, 
   3.933608763707908*^9}, {3.933608799079853*^9, 3.9336088322795143`*^9}, {
   3.933608915057454*^9, 3.933609022202362*^9}, {3.9336091051858664`*^9, 
   3.933609105263709*^9}, {3.933609173617441*^9, 3.933609187080184*^9}, 
   3.9336093544429936`*^9, {3.933609731466628*^9, 3.9336097525434494`*^9}, {
   3.9336100024880667`*^9, 3.93361000289832*^9}, {3.933610095785862*^9, 
   3.933610127728483*^9}, {3.933610460521964*^9, 3.933610467218691*^9}, {
   3.933612740373564*^9, 3.9336127437596655`*^9}, {3.935207669221507*^9, 
   3.93520769493645*^9}, {3.9352077708739204`*^9, 3.935207784202837*^9}, {
   3.935207879021919*^9, 3.935207935223584*^9}, {3.935208066295163*^9, 
   3.9352082566236057`*^9}, {3.9352082971634903`*^9, 3.9352083436212687`*^9}, 
   3.9352083903978767`*^9, {3.9352084239466467`*^9, 3.9352086476370926`*^9}, {
   3.9352086798494997`*^9, 3.935208680156332*^9}, {3.935208743050353*^9, 
   3.935208819964508*^9}, {3.935208855062645*^9, 3.935209395479998*^9}, {
   3.9352119703456154`*^9, 3.9352120806897745`*^9}, {3.935214873736843*^9, 
   3.935214875520438*^9}, {3.9352149089529176`*^9, 3.935215051932119*^9}, {
   3.9352232016596437`*^9, 3.9352232205193996`*^9}, {3.935223259352727*^9, 
   3.935223287523471*^9}, {3.9352233428133802`*^9, 3.935223343509314*^9}, {
   3.935223383734391*^9, 3.9352233978324285`*^9}, {3.9352234289606*^9, 
   3.935223499928006*^9}, {3.935226234660928*^9, 3.9352262370902405`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"3752fe6b-aaca-4683-917c-190f2d53b0a5"],

Cell[CellGroupData[{

Cell["SBBN", "Subsubsection",
 CellChangeTimes->{{3.9336143724218655`*^9, 
  3.9336143730999775`*^9}},ExpressionUUID->"3ceee76b-cd9b-440d-9ef5-\
6564733354ef"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nXtSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"tTSBBN", "[", "T_", "]"}], ",", 
         RowBox[{"TtSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"aRatiotSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"aRatioTSBBN", "[", "T_", "]"}], ",", 
         RowBox[{"\[Eta]BtSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"\[Eta]BTSBBN", "[", "T_", "]"}], ",", 
         RowBox[{"HtSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"HTSBBN", "[", "T_", "]"}], ",", 
         RowBox[{"T\[Nu]etSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"T\[Nu]eTSBBN", "[", "T_", "]"}], ",", 
         RowBox[{"T\[Nu]\[Mu]tSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"T\[Nu]\[Mu]TSBBN", "[", "T_", "]"}], ",", 
         RowBox[{"T\[Nu]\[Tau]tSBBN", "[", "t_", "]"}], ",", 
         RowBox[{"T\[Nu]\[Tau]tSBBN", "[", "T_", "]"}]}], "}"}], ",", 
       "null"}], "}"}], "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
       RowBox[{"0.", ",", "0.", ",", "1.", ",", "0.", ",", "tmaxsol"}], "]"}],
       "]"}]}], ";"}], "//", "AbsoluteTiming"}], "*)"}]], "Input",
 CellChangeTimes->{{3.933614543172147*^9, 3.9336145739242983`*^9}, {
  3.9336149524898977`*^9, 3.933614956209485*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"f9d571c5-2f95-48dc-9bdb-61d70a4a04e9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Subsection",
 CellChangeTimes->{{3.807444248521979*^9, 3.807444251462034*^9}, {
   3.817188858904803*^9, 3.8171888608355055`*^9}, {3.927688673481043*^9, 
   3.927688674204985*^9}, 
   3.927690122765417*^9},ExpressionUUID->"4ad61dd2-2a21-44fb-a659-\
a319d2ad57ec"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nXtSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"tTSBBN", "[", "T_", "]"}], ",", 
          RowBox[{"TtSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"aRatiotSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"aRatioTSBBN", "[", "T_", "]"}], ",", 
          RowBox[{"\[Eta]BtSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"\[Eta]BTSBBN", "[", "T_", "]"}], ",", 
          RowBox[{"HtSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"HTSBBN", "[", "T_", "]"}], ",", 
          RowBox[{"T\[Nu]etSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"T\[Nu]eTSBBN", "[", "T_", "]"}], ",", 
          RowBox[{"T\[Nu]\[Mu]tSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"T\[Nu]\[Mu]TSBBN", "[", "T_", "]"}], ",", 
          RowBox[{"T\[Nu]\[Tau]tSBBN", "[", "t_", "]"}], ",", 
          RowBox[{"T\[Nu]\[Tau]tSBBN", "[", "T_", "]"}]}], "}"}], ",", 
        "null"}], "}"}], "=", 
      RowBox[{"Quiet", "[", 
       RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
        RowBox[{"0.", ",", "0.", ",", "1.", ",", "0.", ",", "tmaxsol"}], 
        "]"}], "]"}]}], ";"}], "//", 
    RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nXtTest", "[", "t_", "]"}], ",", 
           RowBox[{"tTTest", "[", "T_", "]"}], ",", 
           RowBox[{"TtTest", "[", "t_", "]"}], ",", 
           RowBox[{"aRatiotTest", "[", "t_", "]"}], ",", 
           RowBox[{"aRatioTTest", "[", "T_", "]"}], ",", 
           RowBox[{"\[Eta]BtTest", "[", "t_", "]"}], ",", 
           RowBox[{"\[Eta]BTTest", "[", "T_", "]"}], ",", 
           RowBox[{"Httest", "[", "t_", "]"}], ",", 
           RowBox[{"HTtest", "[", "T_", "]"}], ",", 
           RowBox[{"T\[Nu]ettest", "[", "t_", "]"}], ",", 
           RowBox[{"T\[Nu]eTtest", "[", "T_", "]"}], ",", 
           RowBox[{"T\[Nu]\[Mu]ttest", "[", "t_", "]"}], ",", 
           RowBox[{"T\[Nu]\[Mu]Ttest", "[", "T_", "]"}], ",", 
           RowBox[{"T\[Nu]\[Tau]ttest", "[", "t_", "]"}], ",", 
           RowBox[{"T\[Nu]\[Tau]ttest", "[", "T_", "]"}]}], "}"}], ",", 
         "null1"}], "}"}], "=", 
       RowBox[{"DynamicsTimeScaleFactorNumberDens", "[", 
        RowBox[{"0.01", ",", "0.5", ",", "1.", ",", "0.3", ",", "tmaxsol"}], 
        "]"}]}], ";"}]}]}], "//", 
   RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Time", "-", 
       RowBox[{
       "temperature", " ", "relation", " ", "and", " ", "jacobian"}]}], " ", 
      "|", 
      RowBox[{"dt", "/", "dT"}], "|", " ", 
      RowBox[{
       RowBox[{"in", " ", "SBBN"}], " ", "-", " ", "exact"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"LogLogPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Eta]BTTest", "[", "T", "]"}], ",", 
        RowBox[{"\[Eta]BTSBBN", "[", "T", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", 
        RowBox[{"0.05", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]]}], ",", 
        RowBox[{"27", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "3."}]]}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
   "*)"}]], "Input",
 CellChangeTimes->{{3.807444254976202*^9, 3.807444255245042*^9}, 
   3.807444291161053*^9, {3.810892827411088*^9, 3.810892827619725*^9}, {
   3.810901383131218*^9, 3.810901383182088*^9}, {3.811416699552768*^9, 
   3.8114166997174397`*^9}, {3.8114328602166233`*^9, 
   3.8114328603153644`*^9}, {3.811432964481303*^9, 3.811432966122569*^9}, {
   3.811433073772268*^9, 3.811433073872187*^9}, {3.811434847237502*^9, 
   3.8114348473242693`*^9}, {3.8172007751017513`*^9, 3.817200797287805*^9}, {
   3.824205225638858*^9, 3.824205226213442*^9}, {3.927686587073937*^9, 
   3.9276865872906017`*^9}, {3.927686832985501*^9, 3.9276868341606903`*^9}, {
   3.927686940362454*^9, 3.927687043438884*^9}, {3.927688994836161*^9, 
   3.927688994926646*^9}, {3.927689520263167*^9, 3.9276895203947587`*^9}, {
   3.927689688107468*^9, 3.9276896959661026`*^9}, {3.927690318028008*^9, 
   3.927690318469088*^9}, {3.927690432391154*^9, 3.9276904865160475`*^9}, {
   3.9276913877836*^9, 3.927691397201263*^9}, {3.927691707204171*^9, 
   3.927691814362573*^9}, {3.927692247922801*^9, 3.927692293539537*^9}, {
   3.9276964554583006`*^9, 3.927696457200404*^9}, {3.927709279514779*^9, 
   3.927709283221935*^9}, {3.927712535690199*^9, 3.9277125376328106`*^9}, {
   3.933406979851267*^9, 3.9334069852987967`*^9}, {3.9334073048158774`*^9, 
   3.933407315242303*^9}, {3.9336143297277355`*^9, 3.93361434897103*^9}, {
   3.9336144090475845`*^9, 3.9336144985787306`*^9}, {3.933614958203577*^9, 
   3.9336149610352316`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"575f6d7d-ee0e-4832-95f7-4250a6c2457c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1142.1, 642.9},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"90a99223-5bdf-4846-be27-ef7d2b3619b3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 162, 3, 81, "Chapter",ExpressionUUID->"4099c155-d500-7c44-b155-6bc728d0629d"],
Cell[CellGroupData[{
Cell[767, 29, 575, 16, 80, "Section",ExpressionUUID->"e4fc562b-fb8e-48f7-9dbd-fb20e16b1089"],
Cell[CellGroupData[{
Cell[1367, 49, 162, 3, 63, "Subsection",ExpressionUUID->"8ecb60c3-f59b-4781-8d22-8dc75bc4227e"],
Cell[1532, 54, 15967, 384, 1436, "Input",ExpressionUUID->"f8009fb0-2861-42ec-a94c-b26344d86a86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17536, 443, 195, 3, 63, "Subsection",ExpressionUUID->"5cb03c10-2a0e-48be-bc90-d059b716580d"],
Cell[17734, 448, 19033, 487, 1193, "Input",ExpressionUUID->"4f07f68f-9a53-46bc-afe8-1546aaa87c73"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36816, 941, 239, 4, 79, "Section",ExpressionUUID->"9ea63664-29d0-4e9d-9bef-7ae8a13a563b"],
Cell[CellGroupData[{
Cell[37080, 949, 276, 5, 63, "Subsection",ExpressionUUID->"96ba0111-5c8b-4059-853b-f143e056ef7d"],
Cell[37359, 956, 6854, 168, 330, "Input",ExpressionUUID->"493a7e1e-ce1a-4b92-a960-64cc829709cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44250, 1129, 160, 3, 63, "Subsection",ExpressionUUID->"42f21b45-286d-4885-b6d6-0ca34ca9ca24"],
Cell[44413, 1134, 15785, 384, 1186, "Input",ExpressionUUID->"63011ab2-9163-49ce-be2e-9cf8004dbec3"],
Cell[60201, 1520, 12881, 298, 797, "Input",ExpressionUUID->"3752fe6b-aaca-4683-917c-190f2d53b0a5"],
Cell[CellGroupData[{
Cell[73107, 1822, 159, 3, 52, "Subsubsection",ExpressionUUID->"3ceee76b-cd9b-440d-9ef5-6564733354ef"],
Cell[73269, 1827, 1447, 31, 79, "Input",ExpressionUUID->"f9d571c5-2f95-48dc-9bdb-61d70a4a04e9"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74765, 1864, 278, 5, 63, "Subsection",ExpressionUUID->"4ad61dd2-2a21-44fb-a659-a319d2ad57ec"],
Cell[75046, 1871, 4953, 103, 219, "Input",ExpressionUUID->"575f6d7d-ee0e-4832-95f7-4250a6c2457c"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

